<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Farm - Jogo de Fazendinha</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #98FB98 100%);
            min-height: 100vh;
        }
        
        .farm-title {
            font-family: 'Fredoka One', cursive;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .canteiro {
            width: 90px;
            height: 90px;
            background: radial-gradient(circle at 30% 30%, #A0522D, #8B4513, #654321);
            border: 3px solid #5D4037;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 
                inset 0 2px 4px rgba(160, 82, 45, 0.6),
                inset 0 -2px 4px rgba(0, 0, 0, 0.4),
                0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .canteiro::before {
            content: '';
            position: absolute;
            top: 6px;
            left: 6px;
            right: 6px;
            bottom: 6px;
            background: 
                radial-gradient(circle at 20% 20%, rgba(160, 82, 45, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 30%, rgba(139, 69, 19, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 40% 80%, rgba(101, 67, 33, 0.3) 0%, transparent 45%);
            border-radius: 6px;
            z-index: 1;
        }
        
        .canteiro > * {
            z-index: 2;
            position: relative;
        }
        
        .canteiro:hover {
            transform: scale(1.08);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2), 0 4px 16px rgba(0,0,0,0.2);
        }
        
        .canteiro.fertilized {
            background: linear-gradient(145deg, #4A2C17, #2F1B0C);
            box-shadow: inset 0 4px 8px rgba(139, 69, 19, 0.8), 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .canteiro.fertilized::before {
            background: repeating-linear-gradient(
                90deg,
                rgba(74, 44, 23, 0.9),
                rgba(74, 44, 23, 0.9) 3px,
                rgba(47, 27, 12, 0.7) 3px,
                rgba(47, 27, 12, 0.7) 6px
            );
        }
        
        .canteiro.planted {
            background: linear-gradient(145deg, #228B22, #006400);
            border-color: #004d00;
        }
        
        .canteiro.planted::before {
            background: repeating-linear-gradient(
                90deg,
                rgba(34, 139, 34, 0.8),
                rgba(34, 139, 34, 0.8) 3px,
                rgba(0, 100, 0, 0.6) 3px,
                rgba(0, 100, 0, 0.6) 6px
            );
        }
        
        .canteiro.watered {
            background: linear-gradient(145deg, #006400, #004d00);
            border-color: #003300;
            box-shadow: inset 0 4px 8px rgba(0, 100, 255, 0.6), 0 0 20px rgba(0, 150, 255, 0.4);
        }
        
        .canteiro.watered::before {
            background: repeating-linear-gradient(
                90deg,
                rgba(0, 100, 0, 0.8),
                rgba(0, 100, 0, 0.8) 3px,
                rgba(0, 77, 0, 0.6) 3px,
                rgba(0, 77, 0, 0.6) 6px
            );
        }
        
        .canteiro.ready {
            background: linear-gradient(145deg, #90EE90, #32CD32);
            border-color: #228B22;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        .canteiro.ready::before {
            background: repeating-linear-gradient(
                90deg,
                rgba(144, 238, 144, 0.3),
                rgba(144, 238, 144, 0.3) 3px,
                rgba(50, 205, 50, 0.2) 3px,
                rgba(50, 205, 50, 0.2) 6px
            );
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 5px #32CD32; }
            to { box-shadow: 0 0 15px #32CD32, 0 0 25px #32CD32; }
        }
        
        .seed-btn {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            border: 2px solid #4CAF50;
            background: linear-gradient(145deg, #66BB6A, #4CAF50);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            text-align: center;
        }
        
        .seed-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }
        
        .seed-btn:active {
            transform: translateY(0);
        }
        
        .resource-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .celeiro {
            background: #8B4513;
            border: 3px solid #654321;
            border-radius: 12px;
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .celeiro-item {
            background: rgba(255, 255, 255, 0.9);
            margin: 4px;
            padding: 8px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .celeiro-item:hover {
            background: rgba(76, 175, 80, 0.2);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .celeiro-item.non-sellable {
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .celeiro-item.non-sellable:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: none;
            box-shadow: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #ddd;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 4px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.1s ease;
        }
        
        .quitanda-slot {
            width: 50px;
            height: 50px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 20px;
            background: rgba(255, 255, 255, 0.5);
        }
        
        .quitanda-slot:hover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .quitanda-slot.filled {
            border: 2px solid #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .rain-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(100, 100, 100, 0.3);
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .rain-overlay.active {
            opacity: 1;
        }
        
        .rain-drop {
            position: absolute;
            width: 2px;
            height: 10px;
            background: linear-gradient(to bottom, transparent, #87CEEB);
            animation: fall linear infinite;
        }
        
        @keyframes fall {
            from {
                transform: translateY(-100vh);
            }
            to {
                transform: translateY(100vh);
            }
        }
        
        .sky-gray {
            background: linear-gradient(135deg, #708090 0%, #778899 100%) !important;
            transition: background 0.5s ease;
        }
        
        .flower-field {
            background: linear-gradient(135deg, #90EE90, #98FB98, #90EE90);
            border: 3px solid #228B22;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 16px rgba(34, 139, 34, 0.3);
            display: none;
        }
        
        .flower-field.spring {
            display: block;
            animation: bloom 1s ease-in-out;
        }
        
        @keyframes bloom {
            from { 
                opacity: 0; 
                transform: scale(0.8); 
            }
            to { 
                opacity: 1; 
                transform: scale(1); 
            }
        }
        
        .flower-slot {
            width: 120px;
            height: 100px;
            background: linear-gradient(145deg, #F0FFF0, #E6FFE6);
            border: 2px solid #32CD32;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .flower-slot:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(50, 205, 50, 0.4);
        }
        
        .flower-slot::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to top, #228B22, transparent);
            z-index: 1;
        }
        
        .flower-display {
            display: flex;
            gap: 2px;
            z-index: 2;
            position: relative;
        }
        
        .flower-icon {
            font-size: 24px;
            transition: all 0.3s ease;
        }
        
        .flower-icon.collected {
            opacity: 0.3;
            transform: scale(0.7);
        }
        
        .flower-name {
            font-size: 12px;
            font-weight: bold;
            color: #2E7D32;
            margin-top: 5px;
            z-index: 2;
            position: relative;
        }
        
        .flower-timer {
            font-size: 10px;
            color: #666;
            z-index: 2;
            position: relative;
        }
        
        .feeder-slot {
            width: 120px;
            height: 120px;
            background: linear-gradient(145deg, #D2B48C, #DEB887);
            border: 3px solid #8B7355;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(139, 115, 85, 0.3), 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .feeder-slot:hover {
            transform: translateY(-2px);
            box-shadow: inset 0 2px 4px rgba(139, 115, 85, 0.3), 0 6px 16px rgba(0, 0, 0, 0.3);
        }
        
        .feeder-slot.filled {
            background: linear-gradient(145deg, #F0E68C, #FFE4B5);
            border-color: #DAA520;
            animation: attract-birds 3s ease-in-out infinite;
        }
        
        @keyframes attract-birds {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .bird-visit {
            position: absolute;
            top: -30px;
            right: -20px;
            font-size: 24px;
            animation: bird-fly 2s ease-in-out;
            z-index: 10;
        }
        
        @keyframes bird-fly {
            0% { transform: translateX(50px) translateY(20px) rotate(0deg); opacity: 0; }
            20% { opacity: 1; }
            50% { transform: translateX(0px) translateY(0px) rotate(-10deg); }
            80% { transform: translateX(0px) translateY(0px) rotate(10deg); }
            100% { transform: translateX(-50px) translateY(20px) rotate(0deg); opacity: 0; }
        }
        
        .bee-station {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .bee-icon {
            font-size: 32px;
            animation: bee-hover 2s ease-in-out infinite;
        }
        
        @keyframes bee-hover {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .flower-slot-mini {
            width: 80px;
            height: 80px;
            background: linear-gradient(145deg, #F0FFF0, #E6FFE6);
            border: 2px solid #32CD32;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .flower-slot-mini:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(50, 205, 50, 0.4);
        }
        
        .flower-slot-mini.growing {
            background: linear-gradient(145deg, #FFFACD, #F0E68C);
            border-color: #DAA520;
        }
        
        .flower-slot-mini.bloomed {
            background: linear-gradient(145deg, #FFB6C1, #FFC0CB);
            border-color: #FF69B4;
            animation: bloom-glow 3s ease-in-out infinite;
        }
        
        @keyframes bloom-glow {
            0%, 100% { box-shadow: 0 0 5px #FF69B4; }
            50% { box-shadow: 0 0 15px #FF69B4, 0 0 25px #FF69B4; }
        }
        
        .honey-status {
            font-size: 12px;
            color: #666;
            text-align: center;
            min-height: 16px;
        }
        
        .honey-ready {
            color: #FF8C00;
            font-weight: bold;
            cursor: pointer;
            animation: honey-pulse 1s ease-in-out infinite;
        }
        
        @keyframes honey-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .dog-food-slot, .treasure-chest {
            width: 100px;
            height: 100px;
            background: linear-gradient(145deg, #D2B48C, #DEB887);
            border: 3px solid #8B7355;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .dog-food-slot:hover, .treasure-chest:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
        }
        
        .dog-food-slot.filled {
            background: linear-gradient(145deg, #F0E68C, #FFE4B5);
            border-color: #DAA520;
        }
        
        .treasure-chest.has-treasures {
            background: linear-gradient(145deg, #FFD700, #FFA500);
            border-color: #FF8C00;
            animation: treasure-glow 2s ease-in-out infinite;
        }
        
        @keyframes treasure-glow {
            0%, 100% { box-shadow: 0 0 5px #FFD700; }
            50% { box-shadow: 0 0 15px #FFD700, 0 0 25px #FFD700; }
        }
        
        .mocinha-hunting {
            animation: dog-wag 1s ease-in-out infinite;
        }
        
        @keyframes dog-wag {
            0%, 100% { transform: rotate(-2deg); }
            50% { transform: rotate(2deg); }
        }
        
        .mocinha-resting {
            opacity: 0.7;
        }
        
        .duke-working {
            animation: horse-gallop 0.8s ease-in-out infinite;
        }
        
        @keyframes horse-gallop {
            0%, 100% { transform: translateX(0px) rotate(0deg); }
            25% { transform: translateX(-3px) rotate(-2deg); }
            50% { transform: translateX(3px) rotate(0deg); }
            75% { transform: translateX(-2px) rotate(2deg); }
        }
        
        .duke-sick {
            opacity: 0.5;
            filter: grayscale(50%);
        }
        
        .order-card {
            background: linear-gradient(145deg, #FFF8DC, #F5F5DC);
            border: 2px solid #DAA520;
            border-radius: 12px;
            padding: 12px;
            transition: all 0.3s ease;
        }
        
        .order-card.delivering {
            background: linear-gradient(145deg, #E6F3FF, #CCE7FF);
            border-color: #4A90E2;
            animation: delivery-pulse 2s ease-in-out infinite;
        }
        
        @keyframes delivery-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .order-items {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            margin: 8px 0;
        }
        
        .order-item {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .order-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .order-btn {
            flex: 1;
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .order-btn.refuse {
            background: linear-gradient(145deg, #FF6B6B, #FF5252);
            color: white;
        }
        
        .order-btn.refuse:hover {
            background: linear-gradient(145deg, #FF5252, #FF4444);
            transform: translateY(-1px);
        }
        
        .order-btn.deliver {
            background: linear-gradient(145deg, #4CAF50, #45A049);
            color: white;
        }
        
        .order-btn.deliver:hover {
            background: linear-gradient(145deg, #45A049, #3E8E41);
            transform: translateY(-1px);
        }
        
        .order-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .delivery-timer {
            font-size: 11px;
            color: #666;
            text-align: center;
            margin-top: 4px;
        }
    </style>
</head>
<body class="p-4">
    <!-- Overlay de Chuva -->
    <div class="rain-overlay" id="rain-overlay"></div>
    
    <div class="max-w-7xl mx-auto">
        <!-- TÃ­tulo -->
        <h1 class="farm-title text-4xl text-center text-green-800 mb-6">ğŸŒ¾ Real Farm ğŸŒ¾</h1>
        
        <!-- Recursos do Jogador -->
        <div class="flex justify-center gap-6 mb-6">
            <div class="resource-card text-center">
                <div class="text-2xl">ğŸ’°</div>
                <div class="font-bold text-lg" id="coins">200</div>
                <div class="text-sm text-gray-600">Moedas</div>
            </div>
            <div class="resource-card text-center">
                <div class="text-2xl">ğŸ’§</div>
                <div class="font-bold text-lg" id="water">10</div>
                <div class="text-sm text-gray-600">Ãgua</div>
            </div>
            <div class="resource-card text-center">
                <div class="text-2xl">ğŸ‚</div>
                <div class="font-bold text-lg" id="fertilizer">50</div>
                <div class="text-sm text-gray-600">Folhas Secas</div>
            </div>
            <div class="resource-card text-center">
                <div class="text-2xl" id="season-emoji">ğŸŒ¸</div>
                <div class="font-bold text-lg" id="season-name">Primavera</div>
                <div class="text-sm text-gray-600" id="season-bonus">PlantaÃ§Ãµes +10%</div>
                <div class="text-xs text-gray-500" id="season-timer">59:59</div>
            </div>
        </div>
        
        <div class="flex gap-6">
            <!-- Sementes (Lateral Esquerda) -->
            <div class="w-80">
                <h2 class="text-2xl font-bold text-green-800 mb-4 text-center">ğŸŒ± Sementes</h2>
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <button class="seed-btn" onclick="selectSeed('abobora', 'ğŸƒ')">
                        ğŸƒ<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('alface', 'ğŸ¥¬')">
                        ğŸ¥¬<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('batata', 'ğŸ¥”')">
                        ğŸ¥”<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('brocolis', 'ğŸ¥¦')">
                        ğŸ¥¦<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('cafe', 'ğŸ”´')">
                        ğŸ”´<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('cenoura', 'ğŸ¥•')">
                        ğŸ¥•<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('milho', 'ğŸŒ½')">
                        ğŸŒ½<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('tomate', 'ğŸ…')">
                        ğŸ…<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('trigo', 'ğŸŒ¾')">
                        ğŸŒ¾<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('uva', 'ğŸ‡')">
                        ğŸ‡<br><span class="text-xs">10ğŸ’°</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('cacau', 'ğŸ«')" id="seed-cacau" style="display: none;">
                        ğŸ«<br><span class="text-xs">GrÃ¡tis</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('pitaia', 'ğŸ’–')" id="seed-pitaia" style="display: none;">
                        ğŸ’–<br><span class="text-xs">GrÃ¡tis</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('avocado', 'ğŸ¥‘')" id="seed-avocado" style="display: none;">
                        ğŸ¥‘<br><span class="text-xs">GrÃ¡tis</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('tulipa', 'ğŸŒ·')" id="seed-tulipa" style="display: none;">
                        ğŸŒ·<br><span class="text-xs">GrÃ¡tis</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('lirio', 'ğŸª·')" id="seed-lirio" style="display: none;">
                        ğŸª·<br><span class="text-xs">GrÃ¡tis</span>
                    </button>
                    <button class="seed-btn" onclick="selectSeed('sakura', 'ğŸŒ¸')" id="seed-sakura" style="display: none;">
                        ğŸŒ¸<br><span class="text-xs">GrÃ¡tis</span>
                    </button>
                </div>
                
                <!-- Celeiro -->
                <div class="resource-card mb-4">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸšï¸ Celeiro</h3>
                    <div class="celeiro p-3" id="celeiro">
                        <div class="text-center text-gray-500 text-sm">Celeiro vazio</div>
                    </div>
                </div>
                
                <!-- Mercadinho -->
                <div class="resource-card">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸª Mercadinho</h3>
                    <div class="p-3" id="mercadinho">
                        <button class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg mb-2 transition-colors" onclick="buyItem('well', 100)" id="item-well">
                            ğŸª£ PoÃ§o de Ãgua - 100ğŸ’°
                        </button>
                        <button class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg mb-2 transition-colors" onclick="buyItem('feeder', 150)" id="item-feeder">
                            ğŸ½ï¸ Comedouro - 150ğŸ’°
                        </button>
                        <button class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg mb-2 transition-colors" onclick="buyItem('beehive', 200)" id="item-beehive">
                            ğŸ Colmeia - 200ğŸ’°
                        </button>
                        <button class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg mb-2 transition-colors" onclick="buyItem('doghouse', 300)" id="item-doghouse">
                            ğŸ  Casinha da Mocinha - 300ğŸ’°
                        </button>
                        <button class="w-full bg-amber-600 hover:bg-amber-700 text-white font-bold py-2 px-4 rounded-lg mb-2 transition-colors" onclick="buyItem('stable', 400)" id="item-stable">
                            ğŸ‡ Baia do Duque - 400ğŸ’°
                        </button>
                        <div class="grid grid-cols-2 gap-2 mt-2" id="flower-seeds-market" style="display: none;">
                            <button class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-1 px-2 rounded text-xs transition-colors" onclick="buyFlowerSeed('tulipa', 'ğŸŒ·', 15)">
                                ğŸŒ· Tulipa - 15ğŸ’°
                            </button>
                            <button class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-1 px-2 rounded text-xs transition-colors" onclick="buyFlowerSeed('lirio', 'ğŸª·', 15)">
                                ğŸª· LÃ­rio - 15ğŸ’°
                            </button>
                            <button class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-1 px-2 rounded text-xs transition-colors" onclick="buyFlowerSeed('sakura', 'ğŸŒ¸', 15)">
                                ğŸŒ¸ Sakura - 15ğŸ’°
                            </button>
                        </div>
                        <div class="grid grid-cols-1 gap-2 mt-2" id="dog-food-market" style="display: none;">
                            <button class="bg-amber-600 hover:bg-amber-700 text-white font-bold py-1 px-2 rounded text-xs transition-colors" onclick="buyDogFood()">
                                ğŸ¦´ RaÃ§Ã£o para Cachorro - 25ğŸ’°
                            </button>
                        </div>
                        <div class="text-xs text-gray-600 text-center mt-2">Itens Ãºnicos - comprou, saiu!</div>
                    </div>
                </div>
                
                <!-- Comedouro -->
                <div class="resource-card mt-4" id="feeder-container" style="display: none;">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸ½ï¸ Comedouro</h3>
                    <div class="flex justify-center">
                        <div class="feeder-slot" id="feeder-slot" onclick="feedBirds()">
                            <div class="text-4xl mb-2">ğŸ½ï¸</div>
                            <div class="text-sm text-gray-600" id="feeder-status">Vazio</div>
                            <div class="text-xs text-gray-500 mt-1">Clique para colocar Ã¡gua ou banana</div>
                        </div>
                    </div>
                    <div class="text-xs text-center text-gray-500 mt-2">
                        PÃ¡ssaros visitam esporadicamente e trazem sementes especiais!
                    </div>
                </div>
                
                <!-- Colmeia -->
                <div class="resource-card mt-4" id="beehive-container" style="display: none;">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸ Colmeia</h3>
                    <div class="flex justify-center gap-4">
                        <div class="bee-station">
                            <div class="bee-icon">ğŸ</div>
                            <div class="flower-slot-mini" id="bee-slot-0" onclick="plantFlowerInBeehive(0)">
                                <div class="text-2xl">ğŸŒ±</div>
                                <div class="text-xs">Vazio</div>
                            </div>
                            <div class="honey-status" id="honey-status-0">Sem flor</div>
                        </div>
                        <div class="bee-station">
                            <div class="bee-icon">ğŸ</div>
                            <div class="flower-slot-mini" id="bee-slot-1" onclick="plantFlowerInBeehive(1)">
                                <div class="text-2xl">ğŸŒ±</div>
                                <div class="text-xs">Vazio</div>
                            </div>
                            <div class="honey-status" id="honey-status-1">Sem flor</div>
                        </div>
                        <div class="bee-station">
                            <div class="bee-icon">ğŸ</div>
                            <div class="flower-slot-mini" id="bee-slot-2" onclick="plantFlowerInBeehive(2)">
                                <div class="text-2xl">ğŸŒ±</div>
                                <div class="text-xs">Vazio</div>
                            </div>
                            <div class="honey-status" id="honey-status-2">Sem flor</div>
                        </div>
                    </div>
                    <div class="text-xs text-center text-gray-500 mt-2">
                        Plante flores especiais para as abelhas produzirem mel!
                    </div>
                </div>
                
                <!-- Casinha da Mocinha -->
                <div class="resource-card mt-4" id="doghouse-container" style="display: none;">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸ  Casinha da Mocinha</h3>
                    <div class="flex justify-center gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-4xl mb-2">ğŸ•</div>
                            <div class="text-sm font-bold">Mocinha</div>
                            <div class="text-xs text-gray-600" id="friendship-level">Amizade: 0/100</div>
                            <div class="w-20 h-2 bg-gray-200 rounded-full mt-1">
                                <div class="h-full bg-pink-500 rounded-full transition-all duration-300" id="friendship-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-center gap-4 mb-4">
                        <div class="dog-food-slot" id="dog-food-slot" onclick="feedMocinha()">
                            <div class="text-2xl">ğŸ½ï¸</div>
                            <div class="text-xs">Vazio</div>
                            <div class="text-xs text-gray-500 mt-1">Clique para dar raÃ§Ã£o</div>
                        </div>
                        <div class="treasure-chest" id="treasure-chest" onclick="openTreasureChest()">
                            <div class="text-2xl">ğŸ“¦</div>
                            <div class="text-xs">BaÃº</div>
                            <div class="text-xs text-gray-500 mt-1" id="treasure-count">0 tesouros</div>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500" id="mocinha-status">Mocinha estÃ¡ descansando</div>
                        <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded text-xs mt-2 transition-colors" onclick="giveBone()" id="bone-btn">
                            ğŸ¦´ Dar Osso (+20% chance de chave)
                        </button>
                    </div>
                </div>
                
                <!-- Baia do Duque -->
                <div class="resource-card mt-4" id="stable-container" style="display: none;">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸ‡ Baia do Duque</h3>
                    <div class="flex justify-center gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-4xl mb-2" id="duke-horse">ğŸ</div>
                            <div class="text-sm font-bold">Duque</div>
                            <div class="text-xs text-gray-600" id="duke-friendship-level">Amizade: 0/100</div>
                            <div class="w-20 h-2 bg-gray-200 rounded-full mt-1">
                                <div class="h-full bg-blue-500 rounded-full transition-all duration-300" id="duke-friendship-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-center gap-4 mb-4">
                        <div class="dog-food-slot" id="hay-slot" onclick="feedDuke()">
                            <div class="text-2xl">ğŸŒ¾</div>
                            <div class="text-xs">Vazio</div>
                            <div class="text-xs text-gray-500 mt-1">2 fenos necessÃ¡rios</div>
                        </div>
                        <div class="dog-food-slot" id="apple-slot" onclick="giveApple()">
                            <div class="text-2xl">ğŸ</div>
                            <div class="text-xs">Vazio</div>
                            <div class="text-xs text-gray-500 mt-1">Clique para dar maÃ§Ã£</div>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500" id="duke-status">Duque estÃ¡ descansando</div>
                        <div class="text-xs text-gray-400 mt-1" id="duke-work-timer"></div>
                        <button class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-3 rounded text-xs mt-2 transition-colors" onclick="startDelivery()" id="delivery-btn" style="display: none;">
                            ğŸ“¦ Fazer Entrega
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Fazenda (Centro) -->
            <div class="flex-1">
                <h2 class="text-2xl font-bold text-green-800 mb-4 text-center">ğŸšœ Fazenda</h2>
                <div class="flex justify-center mb-6">
                    <div class="grid grid-cols-4 gap-4 p-6 bg-green-200 rounded-2xl border-4 border-green-400">
                        <!-- Canteiros -->
                        <div class="canteiro" id="canteiro-0" onclick="clickCanteiro(0)"></div>
                        <div class="canteiro" id="canteiro-1" onclick="clickCanteiro(1)"></div>
                        <div class="canteiro" id="canteiro-2" onclick="clickCanteiro(2)"></div>
                        <div class="canteiro" id="canteiro-3" onclick="clickCanteiro(3)"></div>
                        <div class="canteiro" id="canteiro-4" onclick="clickCanteiro(4)"></div>
                        <div class="canteiro" id="canteiro-5" onclick="clickCanteiro(5)"></div>
                        <div class="canteiro" id="canteiro-6" onclick="clickCanteiro(6)"></div>
                        <div class="canteiro" id="canteiro-7" onclick="clickCanteiro(7)"></div>
                    </div>
                </div>
                
                <!-- PoÃ§o de Ãgua -->
                <div class="flex justify-center mb-6" id="well-container" style="display: none;">
                    <div class="resource-card">
                        <div class="text-center">
                            <button class="text-4xl hover:scale-110 transition-transform cursor-pointer bg-blue-100 rounded-full p-4" onclick="collectWater()">
                                ğŸª£
                            </button>
                            <div class="text-sm text-gray-600 mt-2">PoÃ§o de Ãgua</div>
                            <div class="text-xs text-gray-500">Clique para coletar 4 baldes</div>
                        </div>
                    </div>
                </div>
                
                <!-- Campo de Flores (Primavera) -->
                <div class="flex justify-center mb-6" id="flower-field-container">
                    <div class="flower-field" id="flower-field">
                        <h3 class="text-xl font-bold text-center text-green-800 mb-4">ğŸŒ¸ Campo de Flores</h3>
                        <div class="flex gap-4 justify-center">
                            <div class="flower-slot" id="flower-slot-0" onclick="collectFlower(0)">
                                <div class="flower-display" id="flower-display-0">
                                    <span class="flower-icon">ğŸŒ¹</span>
                                    <span class="flower-icon">ğŸŒ¹</span>
                                    <span class="flower-icon">ğŸŒ¹</span>
                                </div>
                                <div class="flower-name">Rosa</div>
                                <div class="flower-timer" id="flower-timer-0"></div>
                            </div>
                            <div class="flower-slot" id="flower-slot-1" onclick="collectFlower(1)">
                                <div class="flower-display" id="flower-display-1">
                                    <span class="flower-icon">ğŸŒ»</span>
                                    <span class="flower-icon">ğŸŒ»</span>
                                    <span class="flower-icon">ğŸŒ»</span>
                                </div>
                                <div class="flower-name">Girassol</div>
                                <div class="flower-timer" id="flower-timer-1"></div>
                            </div>
                            <div class="flower-slot" id="flower-slot-2" onclick="collectFlower(2)">
                                <div class="flower-display" id="flower-display-2">
                                    <span class="flower-icon">ğŸŒ¼</span>
                                    <span class="flower-icon">ğŸŒ¼</span>
                                    <span class="flower-icon">ğŸŒ¼</span>
                                </div>
                                <div class="flower-name">Margarida</div>
                                <div class="flower-timer" id="flower-timer-2"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Painel de Pedidos dos Clientes -->
                <div class="resource-card mb-4" id="orders-panel" style="display: none;">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸ“‹ Pedidos dos Clientes</h3>
                    <div class="space-y-3" id="orders-container">
                        <!-- Pedidos aparecerÃ£o aqui -->
                    </div>
                    <div class="text-xs text-center text-gray-500 mt-2">
                        MÃ¡ximo 3 pedidos por vez â€¢ Sem limite de tempo
                    </div>
                </div>

                <!-- Quitanda -->
                <div class="resource-card">
                    <h3 class="text-xl font-bold text-center text-green-800 mb-3">ğŸ¬ Quitanda</h3>
                    <div class="grid grid-cols-5 gap-2 mb-4" id="quitanda-slots">
                        <!-- 20 slots vazios -->
                    </div>
                    <button class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-colors" onclick="sellAll()">
                        ğŸ’° Vender Tudo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Estado do jogo
        let gameState = {
            coins: 200,
            water: 10,
            fertilizer: 50,
            selectedSeed: null,
            selectedSeedEmoji: null,
            canteiros: Array(8).fill().map(() => ({
                state: 'empty', // empty, fertilized, planted, watered, ready
                seedType: null,
                seedEmoji: null,
                timer: null,
                progress: 0
            })),
            celeiro: {},
            harvestedCount: 0,
            quitanda: {},
            hasWell: false,
            isRaining: false,
            rainTimer: null,
            marketItems: {
                well: true,
                feeder: true,
                beehive: true,
                doghouse: true,
                stable: true
            },
            currentSeason: 0, // 0=Primavera, 1=VerÃ£o, 2=Outono, 3=Inverno
            seasonTimeLeft: 3600, // 1 hora em segundos
            seasons: [
                { name: 'Primavera', emoji: 'ğŸŒ¸', bonus: 'PlantaÃ§Ãµes +10%' },
                { name: 'VerÃ£o', emoji: 'â˜€ï¸', bonus: 'Dupla colheita' },
                { name: 'Outono', emoji: 'ğŸ‚', bonus: 'Animais +15%' },
                { name: 'Inverno', emoji: 'â„ï¸', bonus: 'Fabricados +15%' }
            ],
            flowerField: {
                flowers: [
                    { type: 'rosa', emoji: 'ğŸŒ¹', available: 3, timers: [0, 0, 0] },
                    { type: 'girassol', emoji: 'ğŸŒ»', available: 3, timers: [0, 0, 0] },
                    { type: 'margarida', emoji: 'ğŸŒ¼', available: 3, timers: [0, 0, 0] }
                ],
                totalCollected: 0
            },
            feeder: {
                hasFeeder: false,
                isEmpty: true,
                foodType: null, // 'water' ou 'banana'
                birdVisitTimer: 0,
                availableSeeds: {
                    cacau: false,
                    pitaia: false,
                    avocado: false
                }
            },
            beehive: {
                hasBeehive: false,
                bees: [
                    { hasFlower: false, flowerType: null, flowerEmoji: null, isGrowing: false, isPollenating: false, honeyTimer: 0, honeyReady: false },
                    { hasFlower: false, flowerType: null, flowerEmoji: null, isGrowing: false, isPollenating: false, honeyTimer: 0, honeyReady: false },
                    { hasFlower: false, flowerType: null, flowerEmoji: null, isGrowing: false, isPollenating: false, honeyTimer: 0, honeyReady: false }
                ],
                availableFlowerSeeds: {
                    tulipa: false,
                    lirio: false,
                    sakura: false
                }
            },
            doghouse: {
                hasDoghouse: false,
                friendship: 0,
                isHunting: false,
                isResting: false,
                huntingTimer: 0,
                restingTimer: 0,
                hasFoodInSlot: false,
                treasures: {
                    bola: 0,
                    cd: 0,
                    sapato: 0,
                    chave: 0
                },
                bonusChance: false, // BÃ´nus de 20% para chave quando come osso
                dogFoodPurchased: 0 // Contador para dar osso a cada 2 raÃ§Ãµes
            },
            stable: {
                hasStable: false,
                friendship: 0,
                isWorking: false,
                isSick: false,
                workTimer: 0,
                sickTimer: 0,
                hasHayInSlot: false,
                hasAppleInSlot: false,
                hayCount: 0, // Contador de fenos no slot (precisa de 2)
                lastAppleTime: 0, // Timestamp da Ãºltima maÃ§Ã£ para evitar doenÃ§a
                sicknessPrevented: false // Flag para prevenir doenÃ§a com maÃ§Ã£
            },
            orders: {
                hasOrdersPanel: false,
                activeOrders: [], // MÃ¡ximo 3 pedidos
                nextOrderId: 1,
                orderGenerationTimer: 0
            }
        };

        // Atualizar display dos recursos
        function updateResources() {
            document.getElementById('coins').textContent = gameState.coins;
            document.getElementById('water').textContent = gameState.water;
            document.getElementById('fertilizer').textContent = gameState.fertilizer;
        }

        // Atualizar display da estaÃ§Ã£o
        function updateSeasonDisplay() {
            const season = gameState.seasons[gameState.currentSeason];
            document.getElementById('season-emoji').textContent = season.emoji;
            document.getElementById('season-name').textContent = season.name;
            document.getElementById('season-bonus').textContent = season.bonus;
            
            const minutes = Math.floor(gameState.seasonTimeLeft / 60);
            const seconds = gameState.seasonTimeLeft % 60;
            document.getElementById('season-timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Mostrar/esconder campo de flores na primavera
            const flowerField = document.getElementById('flower-field');
            if (gameState.currentSeason === 0) { // Primavera
                flowerField.classList.add('spring');
            } else {
                flowerField.classList.remove('spring');
            }
        }

        // Sistema de estaÃ§Ãµes
        function startSeasonTimer() {
            setInterval(() => {
                gameState.seasonTimeLeft--;
                
                if (gameState.seasonTimeLeft <= 0) {
                    // Mudar estaÃ§Ã£o
                    gameState.currentSeason = (gameState.currentSeason + 1) % 4;
                    gameState.seasonTimeLeft = 3600; // Reset para 1 hora
                    
                    const newSeason = gameState.seasons[gameState.currentSeason];
                    alert(`ğŸŒ A estaÃ§Ã£o mudou para ${newSeason.name}! ${newSeason.bonus}`);
                }
                
                updateSeasonDisplay();
            }, 1000);
        }

        // Selecionar semente
        function selectSeed(type, emoji) {
            // Sementes especiais sÃ£o grÃ¡tis
            const specialSeeds = ['cacau', 'pitaia', 'avocado'];
            const isFree = specialSeeds.includes(type);
            
            if (!isFree && gameState.coins < 10) {
                alert('ğŸ’° Moedas insuficientes! VocÃª precisa de 10 moedas.');
                return;
            }
            
            gameState.selectedSeed = type;
            gameState.selectedSeedEmoji = emoji;
            
            // Destacar semente selecionada
            document.querySelectorAll('.seed-btn').forEach(btn => {
                btn.style.border = '2px solid #4CAF50';
            });
            event.target.style.border = '3px solid #FF5722';
            
            const seedName = type.charAt(0).toUpperCase() + type.slice(1);
            const message = isFree ? 
                `ğŸŒ± Semente especial de ${seedName} selecionada! Clique em um canteiro para plantar.` :
                `ğŸŒ± Semente de ${seedName} selecionada! Clique em um canteiro para comeÃ§ar o plantio.`;
            alert(message);
        }

        // Clique no canteiro
        function clickCanteiro(index) {
            const canteiro = gameState.canteiros[index];
            const canteiroElement = document.getElementById(`canteiro-${index}`);
            
            switch(canteiro.state) {
                case 'empty':
                    if (gameState.fertilizer <= 0) {
                        alert('ğŸ‚ Folhas secas insuficientes!');
                        return;
                    }
                    // Adubar
                    gameState.fertilizer--;
                    canteiro.state = 'fertilized';
                    canteiroElement.className = 'canteiro fertilized';
                    canteiroElement.innerHTML = 'ğŸ‚';
                    updateResources();
                    break;
                    
                case 'fertilized':
                    if (!gameState.selectedSeed) {
                        alert('ğŸŒ± Selecione uma semente primeiro!');
                        return;
                    }
                    
                    // Sementes especiais sÃ£o grÃ¡tis
                    const specialSeeds = ['cacau', 'pitaia', 'avocado'];
                    const isFree = specialSeeds.includes(gameState.selectedSeed);
                    
                    if (!isFree && gameState.coins < 10) {
                        alert('ğŸ’° Moedas insuficientes!');
                        return;
                    }
                    
                    // Plantar
                    if (!isFree) {
                        gameState.coins -= 10;
                    }
                    canteiro.state = 'planted';
                    canteiro.seedType = gameState.selectedSeed;
                    canteiro.seedEmoji = gameState.selectedSeedEmoji;
                    canteiroElement.className = 'canteiro planted';
                    canteiroElement.innerHTML = 'ğŸŒ±';
                    updateResources();
                    break;
                    
                case 'planted':
                    if (gameState.water <= 0) {
                        alert('ğŸ’§ Ãgua insuficiente!');
                        return;
                    }
                    // Regar
                    gameState.water--;
                    canteiro.state = 'watered';
                    canteiroElement.className = 'canteiro watered';
                    canteiroElement.innerHTML = 'ğŸ’§';
                    updateResources();
                    startGrowth(index);
                    break;
                    
                case 'ready':
                    // Colher
                    harvest(index);
                    break;
            }
        }

        // Iniciar crescimento
        function startGrowth(index) {
            const canteiro = gameState.canteiros[index];
            const canteiroElement = document.getElementById(`canteiro-${index}`);
            
            canteiro.progress = 0;
            const progressBar = document.createElement('div');
            progressBar.className = 'progress-bar';
            progressBar.innerHTML = '<div class="progress-fill"></div>';
            
            const interval = setInterval(() => {
                canteiro.progress += 100/300; // 30 segundos = 300 dÃ©cimos
                const progressFill = canteiroElement.querySelector('.progress-fill');
                if (progressFill) {
                    progressFill.style.width = canteiro.progress + '%';
                }
                
                if (canteiro.progress >= 100) {
                    clearInterval(interval);
                    canteiro.state = 'ready';
                    canteiroElement.className = 'canteiro ready';
                    canteiroElement.innerHTML = canteiro.seedEmoji;
                }
            }, 100);
            
            canteiroElement.innerHTML = '';
            canteiroElement.appendChild(progressBar);
        }

        // Colher
        function harvest(index) {
            const canteiro = gameState.canteiros[index];
            const canteiroElement = document.getElementById(`canteiro-${index}`);
            
            // Adicionar ao celeiro
            if (!gameState.celeiro[canteiro.seedType]) {
                gameState.celeiro[canteiro.seedType] = {
                    count: 0,
                    emoji: canteiro.seedEmoji
                };
            }
            
            // VerÃ£o = dupla colheita
            const harvestAmount = gameState.currentSeason === 1 ? 2 : 1;
            gameState.celeiro[canteiro.seedType].count += harvestAmount;
            
            if (harvestAmount === 2) {
                alert(`â˜€ï¸ VerÃ£o! VocÃª colheu 2x ${canteiro.seedEmoji}!`);
            }
            
            // Resetar canteiro
            canteiro.state = 'empty';
            canteiro.seedType = null;
            canteiro.seedEmoji = null;
            canteiro.progress = 0;
            canteiroElement.className = 'canteiro';
            canteiroElement.innerHTML = '';
            
            gameState.harvestedCount++;
            
            // A cada 2 canteiros colhidos, adicionar minhoca
            if (gameState.harvestedCount % 2 === 0) {
                if (!gameState.celeiro['minhoca']) {
                    gameState.celeiro['minhoca'] = {
                        count: 0,
                        emoji: 'ğŸª±'
                    };
                }
                gameState.celeiro['minhoca'].count++;
                alert('ğŸª± Uma minhoca apareceu no seu celeiro!');
            }
            
            updateCeleiro();
        }

        // Atualizar celeiro
        function updateCeleiro() {
            const celeiroElement = document.getElementById('celeiro');
            
            if (Object.keys(gameState.celeiro).length === 0) {
                celeiroElement.innerHTML = '<div class="text-center text-gray-500 text-sm">Celeiro vazio</div>';
                return;
            }
            
            let html = '';
            for (const [type, data] of Object.entries(gameState.celeiro)) {
                if (data.count > 0) {
                    let displayName = type.charAt(0).toUpperCase() + type.slice(1);
                    let isNonSellable = false;
                    
                    if (type === 'minhoca') {
                        displayName = 'Minhoca (NÃ£o vendÃ¡vel)';
                        isNonSellable = true;
                    } else if (type === 'erva') {
                        displayName = 'Erva (NÃ£o vendÃ¡vel)';
                        isNonSellable = true;
                    } else if (['cacau', 'pitaia', 'avocado'].includes(type)) {
                        displayName = type.charAt(0).toUpperCase() + type.slice(1) + ' (NÃ£o vendÃ¡vel)';
                        isNonSellable = true;
                    } else if (['racao', 'osso'].includes(type)) {
                        displayName = type.charAt(0).toUpperCase() + type.slice(1) + ' (Para Mocinha)';
                        isNonSellable = true;
                    } else if (type === 'chave') {
                        displayName = 'Chave (NÃ£o vendÃ¡vel)';
                        isNonSellable = true;
                    }
                    
                    const clickHandler = isNonSellable ? '' : `onclick="moveFromCeleiro('${type}')"`;
                    const cssClass = isNonSellable ? 'celeiro-item non-sellable' : 'celeiro-item';
                    
                    html += `
                        <div class="${cssClass}" ${clickHandler}>
                            <span>${data.emoji} ${displayName}</span>
                            <span class="font-bold">${data.count}</span>
                        </div>
                    `;
                }
            }
            
            celeiroElement.innerHTML = html;
        }

        // Comprar item do mercadinho
        function buyItem(itemType, price) {
            if (gameState.coins < price) {
                alert('ğŸ’° Moedas insuficientes!');
                return;
            }
            
            if (!gameState.marketItems[itemType]) {
                alert('ğŸª Item jÃ¡ foi vendido!');
                return;
            }
            
            if (itemType === 'well') {
                if (gameState.hasWell) {
                    alert('ğŸª£ VocÃª jÃ¡ tem um poÃ§o!');
                    return;
                }
                gameState.coins -= price;
                gameState.marketItems[itemType] = false;
                gameState.hasWell = true;
                document.getElementById('well-container').style.display = 'flex';
                document.getElementById(`item-${itemType}`).style.display = 'none';
                alert('ğŸª£ PoÃ§o de Ã¡gua comprado! Agora vocÃª tem Ã¡gua infinita!');
                updateResources();
            } else if (itemType === 'feeder') {
                if (gameState.feeder.hasFeeder) {
                    alert('ğŸ½ï¸ VocÃª jÃ¡ tem um comedouro!');
                    return;
                }
                gameState.coins -= price;
                gameState.marketItems[itemType] = false;
                gameState.feeder.hasFeeder = true;
                document.getElementById('feeder-container').style.display = 'block';
                document.getElementById(`item-${itemType}`).style.display = 'none';
                alert('ğŸ½ï¸ Comedouro comprado! Coloque Ã¡gua ou banana para atrair pÃ¡ssaros!');
                updateResources();
                startBirdVisitTimer();
            } else if (itemType === 'beehive') {
                if (gameState.beehive.hasBeehive) {
                    alert('ğŸ VocÃª jÃ¡ tem uma colmeia!');
                    return;
                }
                gameState.coins -= price;
                gameState.marketItems[itemType] = false;
                gameState.beehive.hasBeehive = true;
                
                // Mostrar sementes das flores especiais no mercadinho
                document.getElementById('flower-seeds-market').style.display = 'grid';
                
                document.getElementById('beehive-container').style.display = 'block';
                document.getElementById(`item-${itemType}`).style.display = 'none';
                
                alert('ğŸ Colmeia comprada! Agora vocÃª pode comprar sementes de flores especiais no mercadinho!');
                updateResources();
                startBeehiveTimers();
            } else if (itemType === 'doghouse') {
                if (gameState.doghouse.hasDoghouse) {
                    alert('ğŸ  VocÃª jÃ¡ tem uma casinha!');
                    return;
                }
                gameState.coins -= price;
                gameState.marketItems[itemType] = false;
                gameState.doghouse.hasDoghouse = true;
                
                // Mostrar raÃ§Ã£o no mercadinho apÃ³s comprar a casinha
                document.getElementById('dog-food-market').style.display = 'block';
                
                document.getElementById('doghouse-container').style.display = 'block';
                document.getElementById(`item-${itemType}`).style.display = 'none';
                
                alert('ğŸ  Casinha da Mocinha comprada! Agora vocÃª pode comprar raÃ§Ã£o no mercadinho para alimentÃ¡-la!');
                updateResources();
                startDoghouseTimers();
            } else if (itemType === 'stable') {
                if (gameState.stable.hasStable) {
                    alert('ğŸ‡ VocÃª jÃ¡ tem uma baia!');
                    return;
                }
                gameState.coins -= price;
                gameState.marketItems[itemType] = false;
                gameState.stable.hasStable = true;
                
                // Ativar painel de pedidos
                gameState.orders.hasOrdersPanel = true;
                document.getElementById('orders-panel').style.display = 'block';
                
                document.getElementById('stable-container').style.display = 'block';
                document.getElementById(`item-${itemType}`).style.display = 'none';
                
                alert('ğŸ‡ Baia do Duque comprada! Use feno e maÃ§Ã£s do seu celeiro para cuidar dele! O painel de pedidos dos clientes foi ativado!');
                updateResources();
                startStableTimers();
                startOrdersSystem();
            }
        }

        // Coletar Ã¡gua do poÃ§o
        function collectWater() {
            if (!gameState.hasWell) return;
            gameState.water += 4;
            updateResources();
            
            // AnimaÃ§Ã£o visual
            const wellBtn = document.querySelector('#well-container button');
            wellBtn.style.transform = 'scale(1.2)';
            setTimeout(() => {
                wellBtn.style.transform = 'scale(1)';
            }, 200);
        }

        // Inicializar quitanda
        function initQuitanda() {
            const quitandaSlots = document.getElementById('quitanda-slots');
            quitandaSlots.innerHTML = '';
            
            for (let i = 0; i < 20; i++) {
                const slot = document.createElement('div');
                slot.className = 'quitanda-slot';
                slot.id = `quitanda-slot-${i}`;
                slot.onclick = () => moveToQuitanda(i);
                quitandaSlots.appendChild(slot);
            }
        }

        // Mover item especÃ­fico do celeiro para quitanda
        function moveFromCeleiro(type) {
            if (type === 'minhoca') {
                alert('ğŸª± Minhocas nÃ£o podem ser vendidas!');
                return;
            }
            if (type === 'erva') {
                alert('ğŸŒ¿ Ervas nÃ£o podem ser vendidas!');
                return;
            }
            if (['cacau', 'pitaia', 'avocado'].includes(type)) {
                alert('ğŸ« Frutos especiais nÃ£o podem ser vendidos!');
                return;
            }
            if (['racao', 'osso'].includes(type)) {
                alert('ğŸ¦´ RaÃ§Ã£o e ossos sÃ£o para a Mocinha!');
                return;
            }
            if (type === 'chave') {
                alert('ğŸ—ï¸ Chaves nÃ£o podem ser vendidas!');
                return;
            }
            
            if (!gameState.celeiro[type] || gameState.celeiro[type].count <= 0) {
                return;
            }
            
            // Mover item do celeiro para quitanda
            gameState.celeiro[type].count--;
            if (gameState.celeiro[type].count === 0) {
                delete gameState.celeiro[type];
            }
            
            if (!gameState.quitanda[type]) {
                gameState.quitanda[type] = 0;
            }
            gameState.quitanda[type]++;
            
            updateQuitanda();
            updateCeleiro();
        }

        // Mover item da quitanda de volta para celeiro
        function moveToQuitanda(slotIndex) {
            const slot = document.getElementById(`quitanda-slot-${slotIndex}`);
            
            if (slot.dataset.type) {
                // Slot ocupado, mover de volta para celeiro
                const type = slot.dataset.type;
                const emoji = slot.dataset.emoji;
                
                if (!gameState.celeiro[type]) {
                    gameState.celeiro[type] = { count: 0, emoji: emoji };
                }
                gameState.celeiro[type].count++;
                gameState.quitanda[type]--;
                
                if (gameState.quitanda[type] <= 0) {
                    delete gameState.quitanda[type];
                }
                
                updateQuitanda();
                updateCeleiro();
            }
        }

        // Obter preÃ§o do item
        function getItemPrice(type) {
            const basePrices = {
                'abobora': 25, 'alface': 20, 'batata': 18, 'brocolis': 22,
                'cafe': 30, 'cenoura': 15, 'milho': 20, 'tomate': 25,
                'trigo': 18, 'uva': 35, 'minhoca': 50, 'barro': 10,
                'mel': 80, 'rosa': 15, 'girassol': 18, 'margarida': 12,
                'bola': 40, 'cd': 35, 'sapato': 30
            };
            
            let price = basePrices[type] || 20;
            
            // Aplicar bÃ´nus de estaÃ§Ã£o
            const plantProducts = ['abobora', 'alface', 'batata', 'brocolis', 'cafe', 'cenoura', 'milho', 'tomate', 'trigo', 'uva'];
            const animalProducts = ['minhoca']; // Produtos de animais
            const manufacturedProducts = ['barro']; // Produtos fabricados
            
            if (gameState.currentSeason === 0 && plantProducts.includes(type)) {
                // Primavera: PlantaÃ§Ãµes +10%
                price = Math.floor(price * 1.1);
            } else if (gameState.currentSeason === 2 && animalProducts.includes(type)) {
                // Outono: Animais +15%
                price = Math.floor(price * 1.15);
            } else if (gameState.currentSeason === 3 && manufacturedProducts.includes(type)) {
                // Inverno: Fabricados +15%
                price = Math.floor(price * 1.15);
            }
            
            return price;
        }

        // Atualizar quitanda
        function updateQuitanda() {
            const slots = document.querySelectorAll('.quitanda-slot');
            
            // Limpar todos os slots
            slots.forEach(slot => {
                slot.className = 'quitanda-slot';
                slot.innerHTML = '';
                slot.removeAttribute('data-type');
                slot.removeAttribute('data-emoji');
            });
            
            // Preencher slots com itens da quitanda
            let slotIndex = 0;
            for (const [type, count] of Object.entries(gameState.quitanda)) {
                if (count > 0 && slotIndex < 20) {
                    const slot = slots[slotIndex];
                    const emoji = getItemEmoji(type);
                    const price = getItemPrice(type);
                    
                    slot.className = 'quitanda-slot filled';
                    slot.innerHTML = `${emoji}<div class="text-xs">${count}x ${price}ğŸ’°</div>`;
                    slot.dataset.type = type;
                    slot.dataset.emoji = emoji;
                    slotIndex++;
                }
            }
        }
        
        // Obter emoji do item
        function getItemEmoji(type) {
            const emojis = {
                'abobora': 'ğŸƒ', 'alface': 'ğŸ¥¬', 'batata': 'ğŸ¥”', 'brocolis': 'ğŸ¥¦',
                'cafe': 'ğŸ”´', 'cenoura': 'ğŸ¥•', 'milho': 'ğŸŒ½', 'tomate': 'ğŸ…',
                'trigo': 'ğŸŒ¾', 'uva': 'ğŸ‡', 'barro': 'ğŸŸ¤', 'rosa': 'ğŸŒ¹',
                'girassol': 'ğŸŒ»', 'margarida': 'ğŸŒ¼', 'erva': 'ğŸŒ¿',
                'cacau': 'ğŸ«', 'pitaia': 'ğŸ’–', 'avocado': 'ğŸ¥‘',
                'tulipa': 'ğŸŒ·', 'lirio': 'ğŸª·', 'sakura': 'ğŸŒ¸', 'mel': 'ğŸ¯',
                'bola': 'âš½', 'cd': 'ğŸ’¿', 'sapato': 'ğŸ‘Ÿ', 'chave': 'ğŸ—ï¸',
                'racao': 'ğŸ¦´', 'osso': 'ğŸ¦´'
            };
            return emojis[type] || 'ğŸŒ±';
        }

        // Vender tudo
        function sellAll() {
            let totalEarnings = 0;
            let itemsSold = 0;
            
            for (const [type, count] of Object.entries(gameState.quitanda)) {
                if (count > 0) {
                    const price = getItemPrice(type);
                    totalEarnings += price * count;
                    itemsSold += count;
                }
            }
            
            if (itemsSold === 0) {
                alert('ğŸ¬ Quitanda vazia! Coloque alguns produtos para vender.');
                return;
            }
            
            gameState.quitanda = {};
            gameState.coins += totalEarnings;
            updateResources();
            updateQuitanda();
            alert(`ğŸ’° Vendeu ${itemsSold} itens por ${totalEarnings} moedas!`);
        }

        // Sistema de chuva
        function startRain() {
            if (gameState.isRaining) return;
            
            gameState.isRaining = true;
            document.body.classList.add('sky-gray');
            
            const rainOverlay = document.getElementById('rain-overlay');
            rainOverlay.classList.add('active');
            
            // Criar gotas de chuva
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    createRainDrop();
                }, i * 50);
            }
            
            // Regar plantaÃ§Ãµes automaticamente
            gameState.canteiros.forEach((canteiro, index) => {
                if (canteiro.state === 'planted') {
                    canteiro.state = 'watered';
                    const canteiroElement = document.getElementById(`canteiro-${index}`);
                    canteiroElement.className = 'canteiro watered';
                    canteiroElement.innerHTML = 'ğŸ’§';
                    startGrowth(index);
                }
            });
            
            // Adicionar barro ao celeiro
            if (!gameState.celeiro['barro']) {
                gameState.celeiro['barro'] = { count: 0, emoji: 'ğŸŸ¤' };
            }
            gameState.celeiro['barro'].count++;
            updateCeleiro();
            
            // Parar chuva apÃ³s 10 segundos
            setTimeout(() => {
                stopRain();
            }, 10000);
        }

        function createRainDrop() {
            const drop = document.createElement('div');
            drop.className = 'rain-drop';
            drop.style.left = Math.random() * 100 + '%';
            drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
            
            document.getElementById('rain-overlay').appendChild(drop);
            
            setTimeout(() => {
                if (drop.parentNode) {
                    drop.parentNode.removeChild(drop);
                }
            }, 1000);
        }

        function stopRain() {
            gameState.isRaining = false;
            document.body.classList.remove('sky-gray');
            document.getElementById('rain-overlay').classList.remove('active');
            
            // Limpar gotas restantes
            setTimeout(() => {
                document.getElementById('rain-overlay').innerHTML = '';
            }, 1000);
            
            alert('ğŸŒ§ï¸ A chuva parou! Suas plantas foram regadas e vocÃª ganhou 1 barro!');
        }

        // Iniciar timer de chuva (15 minutos = 900000ms)
        function startRainTimer() {
            setInterval(() => {
                if (!gameState.isRaining) {
                    startRain();
                }
            }, 900000); // 15 minutos
        }

        // Sistema de Campo de Flores
        function collectFlower(slotIndex) {
            if (gameState.currentSeason !== 0) {
                alert('ğŸŒ¸ O campo de flores sÃ³ aparece na primavera!');
                return;
            }
            
            const flower = gameState.flowerField.flowers[slotIndex];
            
            if (flower.available <= 0) {
                alert('ğŸŒ¸ Todas as flores deste tipo foram coletadas! Aguarde elas florirem novamente.');
                return;
            }
            
            // Encontrar primeira flor disponÃ­vel
            let flowerIndex = -1;
            for (let i = 0; i < 3; i++) {
                if (flower.timers[i] === 0) {
                    flowerIndex = i;
                    break;
                }
            }
            
            if (flowerIndex === -1) return;
            
            // Coletar flor
            flower.available--;
            flower.timers[flowerIndex] = 300; // 5 minutos em segundos
            gameState.flowerField.totalCollected++;
            
            // Adicionar flor ao celeiro
            if (!gameState.celeiro[flower.type]) {
                gameState.celeiro[flower.type] = {
                    count: 0,
                    emoji: flower.emoji
                };
            }
            gameState.celeiro[flower.type].count++;
            
            // A cada 4 flores coletadas, adicionar erva
            if (gameState.flowerField.totalCollected % 4 === 0) {
                if (!gameState.celeiro['erva']) {
                    gameState.celeiro['erva'] = {
                        count: 0,
                        emoji: 'ğŸŒ¿'
                    };
                }
                gameState.celeiro['erva'].count++;
                alert('ğŸŒ¿ Uma erva especial apareceu no seu celeiro!');
            }
            
            updateFlowerDisplay();
            updateCeleiro();
        }
        
        function updateFlowerDisplay() {
            gameState.flowerField.flowers.forEach((flower, slotIndex) => {
                const display = document.getElementById(`flower-display-${slotIndex}`);
                const timer = document.getElementById(`flower-timer-${slotIndex}`);
                const icons = display.querySelectorAll('.flower-icon');
                
                // Atualizar Ã­cones das flores
                icons.forEach((icon, iconIndex) => {
                    if (flower.timers[iconIndex] > 0) {
                        icon.classList.add('collected');
                    } else {
                        icon.classList.remove('collected');
                    }
                });
                
                // Mostrar timer da prÃ³xima flor a florescer
                const nextTimer = Math.max(...flower.timers);
                if (nextTimer > 0) {
                    const minutes = Math.floor(nextTimer / 60);
                    const seconds = nextTimer % 60;
                    timer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    timer.textContent = '';
                }
            });
        }
        
        function startFlowerTimers() {
            setInterval(() => {
                if (gameState.currentSeason !== 0) return; // SÃ³ na primavera
                
                let updated = false;
                gameState.flowerField.flowers.forEach(flower => {
                    flower.timers.forEach((timer, index) => {
                        if (timer > 0) {
                            flower.timers[index]--;
                            if (flower.timers[index] === 0) {
                                flower.available++;
                                updated = true;
                            }
                        }
                    });
                });
                
                if (updated) {
                    updateFlowerDisplay();
                }
            }, 1000);
        }

        // Sistema do Comedouro
        function feedBirds() {
            if (!gameState.feeder.hasFeeder) {
                alert('ğŸ½ï¸ VocÃª precisa comprar um comedouro primeiro!');
                return;
            }
            
            if (!gameState.feeder.isEmpty) {
                alert('ğŸ½ï¸ O comedouro jÃ¡ tem comida! Aguarde os pÃ¡ssaros comerem.');
                return;
            }
            
            // Alternar entre Ã¡gua e banana
            const foods = [
                { type: 'water', emoji: 'ğŸ’§', name: 'Ãgua' },
                { type: 'banana', emoji: 'ğŸŒ', name: 'Banana' }
            ];
            
            const randomFood = foods[Math.floor(Math.random() * foods.length)];
            
            gameState.feeder.isEmpty = false;
            gameState.feeder.foodType = randomFood.type;
            
            const feederSlot = document.getElementById('feeder-slot');
            const feederStatus = document.getElementById('feeder-status');
            
            feederSlot.classList.add('filled');
            feederSlot.innerHTML = `
                <div class="text-4xl mb-2">${randomFood.emoji}</div>
                <div class="text-sm text-gray-600">${randomFood.name}</div>
                <div class="text-xs text-gray-500 mt-1">Aguardando pÃ¡ssaros...</div>
            `;
            
            alert(`ğŸ½ï¸ VocÃª colocou ${randomFood.name} no comedouro! Os pÃ¡ssaros virÃ£o em breve.`);
        }
        
        function birdVisit() {
            if (gameState.feeder.isEmpty || !gameState.feeder.hasFeeder) return;
            
            const feederSlot = document.getElementById('feeder-slot');
            
            // Criar pÃ¡ssaro visitante
            const bird = document.createElement('div');
            bird.className = 'bird-visit';
            bird.textContent = 'ğŸ¦';
            feederSlot.appendChild(bird);
            
            // Remover pÃ¡ssaro apÃ³s animaÃ§Ã£o
            setTimeout(() => {
                if (bird.parentNode) {
                    bird.parentNode.removeChild(bird);
                }
            }, 2000);
            
            // Esvaziar comedouro
            gameState.feeder.isEmpty = true;
            gameState.feeder.foodType = null;
            
            feederSlot.classList.remove('filled');
            feederSlot.innerHTML = `
                <div class="text-4xl mb-2">ğŸ½ï¸</div>
                <div class="text-sm text-gray-600">Vazio</div>
                <div class="text-xs text-gray-500 mt-1">Clique para colocar Ã¡gua ou banana</div>
            `;
            
            // Dar semente especial
            const specialSeeds = ['cacau', 'pitaia', 'avocado'];
            const randomSeed = specialSeeds[Math.floor(Math.random() * specialSeeds.length)];
            
            gameState.feeder.availableSeeds[randomSeed] = true;
            document.getElementById(`seed-${randomSeed}`).style.display = 'block';
            
            const seedNames = { cacau: 'Cacau', pitaia: 'Pitaia', avocado: 'Avocado' };
            alert(`ğŸ¦ Um pÃ¡ssaro visitou o comedouro e trouxe uma semente de ${seedNames[randomSeed]}! Agora vocÃª pode plantÃ¡-la.`);
        }
        
        function startBirdVisitTimer() {
            setInterval(() => {
                if (!gameState.feeder.isEmpty && gameState.feeder.hasFeeder) {
                    // Chance de 30% a cada 30 segundos
                    if (Math.random() < 0.3) {
                        birdVisit();
                    }
                }
            }, 30000); // 30 segundos
        }

        // Sistema da Colmeia
        function plantFlowerInBeehive(beeIndex) {
            if (!gameState.beehive.hasBeehive) {
                alert('ğŸ VocÃª precisa comprar uma colmeia primeiro!');
                return;
            }
            
            const bee = gameState.beehive.bees[beeIndex];
            
            if (bee.hasFlower) {
                if (bee.honeyReady) {
                    // Coletar mel
                    collectHoney(beeIndex);
                } else {
                    alert('ğŸŒ¸ Esta abelha jÃ¡ tem uma flor! Aguarde o mel ficar pronto.');
                }
                return;
            }
            
            // Verificar se tem semente de flor selecionada
            const flowerSeeds = ['tulipa', 'lirio', 'sakura'];
            if (!gameState.selectedSeed || !flowerSeeds.includes(gameState.selectedSeed)) {
                alert('ğŸŒ· Selecione uma semente de flor especial primeiro! (Tulipa, LÃ­rio ou Sakura)');
                return;
            }
            
            // Plantar flor
            bee.hasFlower = true;
            bee.flowerType = gameState.selectedSeed;
            bee.flowerEmoji = gameState.selectedSeedEmoji;
            bee.isGrowing = true;
            
            const slot = document.getElementById(`bee-slot-${beeIndex}`);
            const status = document.getElementById(`honey-status-${beeIndex}`);
            
            slot.classList.add('growing');
            slot.innerHTML = `<div class="text-2xl">ğŸŒ±</div><div class="text-xs">Crescendo...</div>`;
            status.textContent = 'Flor crescendo...';
            
            // Crescimento da flor (10 segundos)
            setTimeout(() => {
                if (bee.isGrowing) {
                    bee.isGrowing = false;
                    bee.isPollenating = true;
                    bee.honeyTimer = 900; // 15 minutos em segundos
                    
                    slot.classList.remove('growing');
                    slot.classList.add('bloomed');
                    slot.innerHTML = `<div class="text-2xl">${bee.flowerEmoji}</div><div class="text-xs">Floresceu!</div>`;
                    status.textContent = 'Abelha polinizando...';
                    
                    alert(`ğŸŒ¸ A ${bee.flowerType} floresceu! A abelha comeÃ§ou a polinizar.`);
                }
            }, 10000); // 10 segundos
            
            alert(`ğŸŒ± VocÃª plantou uma ${gameState.selectedSeed}! Aguarde 10 segundos para ela florescer.`);
        }
        
        function collectHoney(beeIndex) {
            const bee = gameState.beehive.bees[beeIndex];
            
            if (!bee.honeyReady) {
                alert('ğŸ¯ O mel ainda nÃ£o estÃ¡ pronto!');
                return;
            }
            
            // Adicionar mel ao celeiro
            if (!gameState.celeiro['mel']) {
                gameState.celeiro['mel'] = {
                    count: 0,
                    emoji: 'ğŸ¯'
                };
            }
            gameState.celeiro['mel'].count++;
            
            // Resetar abelha
            bee.hasFlower = false;
            bee.flowerType = null;
            bee.flowerEmoji = null;
            bee.isGrowing = false;
            bee.isPollenating = false;
            bee.honeyTimer = 0;
            bee.honeyReady = false;
            
            const slot = document.getElementById(`bee-slot-${beeIndex}`);
            const status = document.getElementById(`honey-status-${beeIndex}`);
            
            slot.className = 'flower-slot-mini';
            slot.innerHTML = `<div class="text-2xl">ğŸŒ±</div><div class="text-xs">Vazio</div>`;
            status.textContent = 'Sem flor';
            status.classList.remove('honey-ready');
            
            updateCeleiro();
            alert('ğŸ¯ Mel coletado! A abelha estÃ¡ pronta para uma nova flor.');
        }
        
        function updateBeehiveDisplay() {
            if (!gameState.beehive.hasBeehive) return;
            
            gameState.beehive.bees.forEach((bee, index) => {
                const status = document.getElementById(`honey-status-${index}`);
                
                if (bee.isPollenating && bee.honeyTimer > 0) {
                    const minutes = Math.floor(bee.honeyTimer / 60);
                    const seconds = bee.honeyTimer % 60;
                    status.textContent = `Mel em ${minutes}:${seconds.toString().padStart(2, '0')}`;
                } else if (bee.honeyReady) {
                    status.textContent = 'ğŸ¯ Mel pronto! Clique para coletar';
                    status.classList.add('honey-ready');
                }
            });
        }
        
        function startBeehiveTimers() {
            setInterval(() => {
                if (!gameState.beehive.hasBeehive) return;
                
                let updated = false;
                gameState.beehive.bees.forEach(bee => {
                    if (bee.isPollenating && bee.honeyTimer > 0) {
                        bee.honeyTimer--;
                        if (bee.honeyTimer === 0) {
                            bee.honeyReady = true;
                            bee.isPollenating = false;
                            updated = true;
                        }
                    }
                });
                
                if (updated) {
                    updateBeehiveDisplay();
                }
            }, 1000);
            
            // Atualizar display a cada segundo
            setInterval(() => {
                updateBeehiveDisplay();
            }, 1000);
        }

        // Comprar semente de flor especial
        function buyFlowerSeed(seedType, emoji, price) {
            if (gameState.coins < price) {
                alert('ğŸ’° Moedas insuficientes!');
                return;
            }
            
            gameState.coins -= price;
            updateResources();
            
            // Selecionar automaticamente a semente
            selectSeed(seedType, emoji);
            
            alert(`ğŸŒ¸ Semente de ${seedType} comprada e selecionada! Plante na colmeia para as abelhas produzirem mel.`);
        }
        
        // Comprar raÃ§Ã£o para cachorro
        function buyDogFood() {
            if (gameState.coins < 25) {
                alert('ğŸ’° Moedas insuficientes!');
                return;
            }
            
            gameState.coins -= 25;
            gameState.doghouse.dogFoodPurchased++;
            
            // Adicionar raÃ§Ã£o ao celeiro
            if (!gameState.celeiro['racao']) {
                gameState.celeiro['racao'] = { count: 0, emoji: 'ğŸ¦´' };
            }
            gameState.celeiro['racao'].count++;
            
            // A cada 2 raÃ§Ãµes, ganhar 1 osso
            if (gameState.doghouse.dogFoodPurchased % 2 === 0) {
                if (!gameState.celeiro['osso']) {
                    gameState.celeiro['osso'] = { count: 0, emoji: 'ğŸ¦´' };
                }
                gameState.celeiro['osso'].count++;
                alert('ğŸ¦´ VocÃª ganhou um osso grÃ¡tis! Use para aumentar a amizade com a Mocinha.');
            }
            
            updateResources();
            updateCeleiro();
            alert('ğŸ¦´ RaÃ§Ã£o comprada! Use para alimentar a Mocinha.');
        }
        
        // Alimentar Mocinha
        function feedMocinha() {
            if (!gameState.doghouse.hasDoghouse) {
                alert('ğŸ  VocÃª precisa comprar a casinha primeiro!');
                return;
            }
            
            if (gameState.doghouse.isHunting) {
                alert('ğŸ• Mocinha estÃ¡ caÃ§ando tesouros! Aguarde ela voltar.');
                return;
            }
            
            if (gameState.doghouse.isResting) {
                alert('ğŸ• Mocinha estÃ¡ descansando! Aguarde ela acordar.');
                return;
            }
            
            if (gameState.doghouse.hasFoodInSlot) {
                alert('ğŸ½ï¸ Mocinha jÃ¡ tem raÃ§Ã£o! Aguarde ela comer.');
                return;
            }
            
            if (!gameState.celeiro['racao'] || gameState.celeiro['racao'].count <= 0) {
                alert('ğŸ¦´ VocÃª nÃ£o tem raÃ§Ã£o! Compre no mercadinho.');
                return;
            }
            
            // Usar raÃ§Ã£o
            gameState.celeiro['racao'].count--;
            if (gameState.celeiro['racao'].count === 0) {
                delete gameState.celeiro['racao'];
            }
            
            gameState.doghouse.hasFoodInSlot = true;
            
            const foodSlot = document.getElementById('dog-food-slot');
            foodSlot.classList.add('filled');
            foodSlot.innerHTML = `<div class="text-2xl">ğŸ¦´</div><div class="text-xs">RaÃ§Ã£o</div><div class="text-xs text-gray-500 mt-1">Mocinha vai comer</div>`;
            
            // Mocinha come apÃ³s 3 segundos
            setTimeout(() => {
                eatFood();
            }, 3000);
            
            updateCeleiro();
        }
        
        // Mocinha come a raÃ§Ã£o
        function eatFood() {
            gameState.doghouse.hasFoodInSlot = false;
            
            const foodSlot = document.getElementById('dog-food-slot');
            foodSlot.classList.remove('filled');
            foodSlot.innerHTML = `<div class="text-2xl">ğŸ½ï¸</div><div class="text-xs">Vazio</div><div class="text-xs text-gray-500 mt-1">Clique para dar raÃ§Ã£o</div>`;
            
            // Verificar se pode caÃ§ar tesouros (amizade >= 100)
            if (gameState.doghouse.friendship >= 100) {
                startHunting();
            } else {
                alert('ğŸ• Mocinha comeu, mas ainda nÃ£o tem amizade suficiente para caÃ§ar tesouros. DÃª ossos para aumentar a amizade!');
            }
        }
        
        // Dar osso para Mocinha
        function giveBone() {
            if (!gameState.doghouse.hasDoghouse) {
                alert('ğŸ  VocÃª precisa comprar a casinha primeiro!');
                return;
            }
            
            if (!gameState.celeiro['osso'] || gameState.celeiro['osso'].count <= 0) {
                alert('ğŸ¦´ VocÃª nÃ£o tem ossos! Compre 2 raÃ§Ãµes para ganhar 1 osso.');
                return;
            }
            
            // Usar osso
            gameState.celeiro['osso'].count--;
            if (gameState.celeiro['osso'].count === 0) {
                delete gameState.celeiro['osso'];
            }
            
            // Aumentar amizade
            gameState.doghouse.friendship = Math.min(100, gameState.doghouse.friendship + 10);
            gameState.doghouse.bonusChance = true; // Ativar bÃ´nus de 20% para chave
            
            updateDoghouseDisplay();
            updateCeleiro();
            
            alert(`ğŸ¦´ Mocinha adorou o osso! Amizade: ${gameState.doghouse.friendship}/100. BÃ´nus de 20% para encontrar chaves ativado!`);
        }
        
        // Iniciar caÃ§a aos tesouros
        function startHunting() {
            gameState.doghouse.isHunting = true;
            gameState.doghouse.huntingTimer = 1200; // 20 minutos em segundos
            
            const mocinha = document.querySelector('#doghouse-container .text-4xl');
            mocinha.classList.add('mocinha-hunting');
            
            document.getElementById('mocinha-status').textContent = 'Mocinha estÃ¡ caÃ§ando tesouros...';
            
            alert('ğŸ• Mocinha saiu para caÃ§ar tesouros! Ela voltarÃ¡ em 20 minutos.');
        }
        
        // Mocinha volta da caÃ§a
        function returnFromHunt() {
            gameState.doghouse.isHunting = false;
            gameState.doghouse.huntingTimer = 0;
            
            const mocinha = document.querySelector('#doghouse-container .text-4xl');
            mocinha.classList.remove('mocinha-hunting');
            
            // Encontrar tesouro aleatÃ³rio
            const treasures = ['bola', 'cd', 'sapato', 'chave'];
            let foundTreasure = treasures[Math.floor(Math.random() * treasures.length)];
            
            // Aplicar bÃ´nus de 20% para chave se comeu osso
            if (gameState.doghouse.bonusChance && Math.random() < 0.2) {
                foundTreasure = 'chave';
            }
            gameState.doghouse.bonusChance = false; // Resetar bÃ´nus
            
            // Adicionar tesouro
            gameState.doghouse.treasures[foundTreasure]++;
            
            // Iniciar descanso
            gameState.doghouse.isResting = true;
            gameState.doghouse.restingTimer = 300; // 5 minutos em segundos
            
            const mocinha2 = document.querySelector('#doghouse-container .text-4xl');
            mocinha2.classList.add('mocinha-resting');
            
            document.getElementById('mocinha-status').textContent = 'Mocinha estÃ¡ descansando...';
            
            updateDoghouseDisplay();
            
            const treasureNames = { bola: 'Bola', cd: 'CD', sapato: 'Sapato', chave: 'Chave' };
            alert(`ğŸ• Mocinha voltou e encontrou: ${getItemEmoji(foundTreasure)} ${treasureNames[foundTreasure]}! Ela estÃ¡ descansando por 5 minutos.`);
        }
        
        // Mocinha termina o descanso
        function finishResting() {
            gameState.doghouse.isResting = false;
            gameState.doghouse.restingTimer = 0;
            
            const mocinha = document.querySelector('#doghouse-container .text-4xl');
            mocinha.classList.remove('mocinha-resting');
            
            document.getElementById('mocinha-status').textContent = 'Mocinha estÃ¡ pronta para comer novamente!';
        }
        
        // Abrir baÃº de tesouros
        function openTreasureChest() {
            if (!gameState.doghouse.hasDoghouse) {
                alert('ğŸ  VocÃª precisa comprar a casinha primeiro!');
                return;
            }
            
            const totalTreasures = Object.values(gameState.doghouse.treasures).reduce((sum, count) => sum + count, 0);
            
            if (totalTreasures === 0) {
                alert('ğŸ“¦ O baÃº estÃ¡ vazio! Alimente a Mocinha para ela caÃ§ar tesouros.');
                return;
            }
            
            // Mover tesouros para o celeiro
            for (const [treasure, count] of Object.entries(gameState.doghouse.treasures)) {
                if (count > 0) {
                    if (!gameState.celeiro[treasure]) {
                        gameState.celeiro[treasure] = { count: 0, emoji: getItemEmoji(treasure) };
                    }
                    gameState.celeiro[treasure].count += count;
                    gameState.doghouse.treasures[treasure] = 0;
                }
            }
            
            updateDoghouseDisplay();
            updateCeleiro();
            
            alert(`ğŸ“¦ Tesouros coletados do baÃº! Total: ${totalTreasures} itens movidos para o celeiro.`);
        }
        
        // Atualizar display da casinha
        function updateDoghouseDisplay() {
            if (!gameState.doghouse.hasDoghouse) return;
            
            // Atualizar nÃ­vel de amizade
            document.getElementById('friendship-level').textContent = `Amizade: ${gameState.doghouse.friendship}/100`;
            document.getElementById('friendship-bar').style.width = `${gameState.doghouse.friendship}%`;
            
            // Atualizar contador de tesouros
            const totalTreasures = Object.values(gameState.doghouse.treasures).reduce((sum, count) => sum + count, 0);
            document.getElementById('treasure-count').textContent = `${totalTreasures} tesouros`;
            
            // Atualizar aparÃªncia do baÃº
            const chest = document.getElementById('treasure-chest');
            if (totalTreasures > 0) {
                chest.classList.add('has-treasures');
            } else {
                chest.classList.remove('has-treasures');
            }
            
            // Atualizar status dos timers
            if (gameState.doghouse.isHunting && gameState.doghouse.huntingTimer > 0) {
                const minutes = Math.floor(gameState.doghouse.huntingTimer / 60);
                const seconds = gameState.doghouse.huntingTimer % 60;
                document.getElementById('mocinha-status').textContent = `CaÃ§ando tesouros... ${minutes}:${seconds.toString().padStart(2, '0')}`;
            } else if (gameState.doghouse.isResting && gameState.doghouse.restingTimer > 0) {
                const minutes = Math.floor(gameState.doghouse.restingTimer / 60);
                const seconds = gameState.doghouse.restingTimer % 60;
                document.getElementById('mocinha-status').textContent = `Descansando... ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // Mostrar/esconder botÃ£o de osso baseado na disponibilidade
            const boneBtn = document.getElementById('bone-btn');
            if (gameState.celeiro['osso'] && gameState.celeiro['osso'].count > 0) {
                boneBtn.style.display = 'inline-block';
            } else {
                boneBtn.style.display = 'none';
            }
        }
        
        // Iniciar timers da casinha
        function startDoghouseTimers() {
            setInterval(() => {
                if (!gameState.doghouse.hasDoghouse) return;
                
                // Timer de caÃ§a
                if (gameState.doghouse.isHunting && gameState.doghouse.huntingTimer > 0) {
                    gameState.doghouse.huntingTimer--;
                    if (gameState.doghouse.huntingTimer === 0) {
                        returnFromHunt();
                    }
                }
                
                // Timer de descanso
                if (gameState.doghouse.isResting && gameState.doghouse.restingTimer > 0) {
                    gameState.doghouse.restingTimer--;
                    if (gameState.doghouse.restingTimer === 0) {
                        finishResting();
                    }
                }
                
                updateDoghouseDisplay();
            }, 1000);
        }

        // Sistema da Baia do Duque
        function feedDuke() {
            if (!gameState.stable.hasStable) {
                alert('ğŸ‡ VocÃª precisa comprar a baia primeiro!');
                return;
            }
            
            if (gameState.stable.isSick) {
                alert('ğŸ Duque estÃ¡ doente! Aguarde ele sarar ou dÃª uma maÃ§Ã£ para curÃ¡-lo.');
                return;
            }
            
            if (gameState.stable.isWorking) {
                alert('ğŸ Duque estÃ¡ trabalhando! Aguarde ele terminar.');
                return;
            }
            
            if (gameState.stable.hasHayInSlot && gameState.stable.hayCount >= 2) {
                alert('ğŸŒ¾ Duque jÃ¡ tem feno suficiente! Aguarde ele comer.');
                return;
            }
            
            // Verificar se tem trigo no celeiro (feno)
            if (!gameState.celeiro['trigo'] || gameState.celeiro['trigo'].count <= 0) {
                alert('ğŸŒ¾ VocÃª nÃ£o tem trigo (feno)! Plante e colha trigo primeiro.');
                return;
            }
            
            // Usar trigo como feno
            gameState.celeiro['trigo'].count--;
            if (gameState.celeiro['trigo'].count === 0) {
                delete gameState.celeiro['trigo'];
            }
            
            gameState.stable.hayCount++;
            
            const haySlot = document.getElementById('hay-slot');
            
            if (gameState.stable.hayCount === 1) {
                gameState.stable.hasHayInSlot = true;
                haySlot.classList.add('filled');
                haySlot.innerHTML = `<div class="text-2xl">ğŸŒ¾</div><div class="text-xs">1/2 fenos</div><div class="text-xs text-gray-500 mt-1">Precisa mais 1</div>`;
            } else if (gameState.stable.hayCount >= 2) {
                haySlot.innerHTML = `<div class="text-2xl">ğŸŒ¾ğŸŒ¾</div><div class="text-xs">2/2 fenos</div><div class="text-xs text-gray-500 mt-1">Duque vai comer</div>`;
                
                // Duque come apÃ³s 3 segundos
                setTimeout(() => {
                    eatHay();
                }, 3000);
            }
            
            updateCeleiro();
        }
        
        function eatHay() {
            gameState.stable.hasHayInSlot = false;
            gameState.stable.hayCount = 0;
            
            const haySlot = document.getElementById('hay-slot');
            haySlot.classList.remove('filled');
            haySlot.innerHTML = `<div class="text-2xl">ğŸŒ¾</div><div class="text-xs">Vazio</div><div class="text-xs text-gray-500 mt-1">2 fenos necessÃ¡rios</div>`;
            
            // Verificar se pode trabalhar (amizade >= 100)
            if (gameState.stable.friendship >= 100) {
                startWork();
            } else {
                alert('ğŸ Duque comeu, mas ainda nÃ£o tem amizade suficiente para trabalhar. DÃª maÃ§Ã£s para aumentar a amizade!');
            }
            
            // Chance de ficar doente se nÃ£o comeu maÃ§Ã£ recentemente
            const timeSinceApple = Date.now() - gameState.stable.lastAppleTime;
            if (timeSinceApple > 300000 && !gameState.stable.sicknessPrevented && Math.random() < 0.3) { // 5 minutos e 30% de chance
                makeDukeSick();
            }
        }
        
        function giveApple() {
            if (!gameState.stable.hasStable) {
                alert('ğŸ‡ VocÃª precisa comprar a baia primeiro!');
                return;
            }
            
            if (gameState.stable.hasAppleInSlot) {
                alert('ğŸ Duque jÃ¡ tem uma maÃ§Ã£! Aguarde ele comer.');
                return;
            }
            
            // Verificar se tem maÃ§Ã£ no celeiro (usar abÃ³bora como maÃ§Ã£)
            if (!gameState.celeiro['abobora'] || gameState.celeiro['abobora'].count <= 0) {
                alert('ğŸ VocÃª nÃ£o tem maÃ§Ã£s! Use abÃ³boras como maÃ§Ã£s.');
                return;
            }
            
            // Usar abÃ³bora como maÃ§Ã£
            gameState.celeiro['abobora'].count--;
            if (gameState.celeiro['abobora'].count === 0) {
                delete gameState.celeiro['abobora'];
            }
            
            gameState.stable.hasAppleInSlot = true;
            gameState.stable.lastAppleTime = Date.now();
            gameState.stable.sicknessPrevented = true;
            
            const appleSlot = document.getElementById('apple-slot');
            appleSlot.classList.add('filled');
            appleSlot.innerHTML = `<div class="text-2xl">ğŸ</div><div class="text-xs">MaÃ§Ã£</div><div class="text-xs text-gray-500 mt-1">Duque vai comer</div>`;
            
            // Duque come apÃ³s 2 segundos
            setTimeout(() => {
                eatApple();
            }, 2000);
            
            updateCeleiro();
        }
        
        function eatApple() {
            gameState.stable.hasAppleInSlot = false;
            
            // Aumentar amizade
            gameState.stable.friendship = Math.min(100, gameState.stable.friendship + 10);
            
            // Curar se estiver doente
            if (gameState.stable.isSick) {
                gameState.stable.isSick = false;
                gameState.stable.sickTimer = 0;
                
                const dukeHorse = document.getElementById('duke-horse');
                dukeHorse.classList.remove('duke-sick');
                
                alert('ğŸ A maÃ§Ã£ curou o Duque! Ele nÃ£o estÃ¡ mais doente.');
            }
            
            const appleSlot = document.getElementById('apple-slot');
            appleSlot.classList.remove('filled');
            appleSlot.innerHTML = `<div class="text-2xl">ğŸ</div><div class="text-xs">Vazio</div><div class="text-xs text-gray-500 mt-1">Clique para dar maÃ§Ã£</div>`;
            
            updateStableDisplay();
            
            alert(`ğŸ Duque adorou a maÃ§Ã£! Amizade: ${gameState.stable.friendship}/100. Risco de doenÃ§a reduzido!`);
        }
        
        function startWork() {
            gameState.stable.isWorking = true;
            gameState.stable.workTimer = 1800; // 30 minutos em segundos
            gameState.stable.sicknessPrevented = false; // Reset da prevenÃ§Ã£o
            
            const dukeHorse = document.getElementById('duke-horse');
            dukeHorse.classList.add('duke-working');
            
            document.getElementById('duke-status').textContent = 'Duque estÃ¡ trabalhando nas entregas...';
            document.getElementById('delivery-btn').style.display = 'inline-block';
            
            alert('ğŸ Duque comeÃ§ou a trabalhar! Ele pode fazer entregas pelos prÃ³ximos 30 minutos.');
        }
        
        function finishWork() {
            gameState.stable.isWorking = false;
            gameState.stable.workTimer = 0;
            
            const dukeHorse = document.getElementById('duke-horse');
            dukeHorse.classList.remove('duke-working');
            
            document.getElementById('duke-status').textContent = 'Duque terminou o trabalho e estÃ¡ descansando';
            document.getElementById('delivery-btn').style.display = 'none';
            
            alert('ğŸ Duque terminou o trabalho! Alimente-o novamente para trabalhar mais.');
        }
        
        function makeDukeSick() {
            gameState.stable.isSick = true;
            gameState.stable.sickTimer = 1200; // 20 minutos em segundos
            gameState.stable.isWorking = false;
            gameState.stable.workTimer = 0;
            
            const dukeHorse = document.getElementById('duke-horse');
            dukeHorse.classList.remove('duke-working');
            dukeHorse.classList.add('duke-sick');
            
            document.getElementById('duke-status').textContent = 'Duque estÃ¡ doente!';
            document.getElementById('delivery-btn').style.display = 'none';
            
            alert('ğŸ¤’ Duque ficou doente! Ele nÃ£o pode trabalhar por 20 minutos. DÃª uma maÃ§Ã£ para curÃ¡-lo mais rÃ¡pido.');
        }
        
        function recoverFromSickness() {
            gameState.stable.isSick = false;
            gameState.stable.sickTimer = 0;
            
            const dukeHorse = document.getElementById('duke-horse');
            dukeHorse.classList.remove('duke-sick');
            
            document.getElementById('duke-status').textContent = 'Duque se recuperou da doenÃ§a!';
            
            alert('ğŸ Duque se recuperou sozinho! Agora ele pode trabalhar novamente.');
        }
        
        function startDelivery() {
            if (!gameState.stable.isWorking) {
                alert('ğŸ Duque precisa estar trabalhando para fazer entregas!');
                return;
            }
            
            // Simular entrega e ganhar moedas
            const earnings = Math.floor(Math.random() * 50) + 30; // 30-80 moedas
            gameState.coins += earnings;
            updateResources();
            
            alert(`ğŸ“¦ Duque fez uma entrega e ganhou ${earnings} moedas!`);
        }
        
        function updateStableDisplay() {
            if (!gameState.stable.hasStable) return;
            
            // Atualizar nÃ­vel de amizade
            document.getElementById('duke-friendship-level').textContent = `Amizade: ${gameState.stable.friendship}/100`;
            document.getElementById('duke-friendship-bar').style.width = `${gameState.stable.friendship}%`;
            
            // Atualizar status dos timers
            if (gameState.stable.isWorking && gameState.stable.workTimer > 0) {
                const minutes = Math.floor(gameState.stable.workTimer / 60);
                const seconds = gameState.stable.workTimer % 60;
                document.getElementById('duke-work-timer').textContent = `Trabalhando: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            } else if (gameState.stable.isSick && gameState.stable.sickTimer > 0) {
                const minutes = Math.floor(gameState.stable.sickTimer / 60);
                const seconds = gameState.stable.sickTimer % 60;
                document.getElementById('duke-work-timer').textContent = `Doente: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            } else {
                document.getElementById('duke-work-timer').textContent = '';
            }
        }
        
        function startStableTimers() {
            setInterval(() => {
                if (!gameState.stable.hasStable) return;
                
                // Timer de trabalho
                if (gameState.stable.isWorking && gameState.stable.workTimer > 0) {
                    gameState.stable.workTimer--;
                    if (gameState.stable.workTimer === 0) {
                        finishWork();
                    }
                }
                
                // Timer de doenÃ§a
                if (gameState.stable.isSick && gameState.stable.sickTimer > 0) {
                    gameState.stable.sickTimer--;
                    if (gameState.stable.sickTimer === 0) {
                        recoverFromSickness();
                    }
                }
                
                updateStableDisplay();
            }, 1000);
        }

        // Sistema de Pedidos dos Clientes
        function generateOrder() {
            if (!gameState.orders.hasOrdersPanel) return;
            if (gameState.orders.activeOrders.length >= 3) return;
            
            // Lista de produtos disponÃ­veis para pedidos
            const availableProducts = [
                { type: 'abobora', emoji: 'ğŸƒ', name: 'AbÃ³bora', price: 40 },
                { type: 'alface', emoji: 'ğŸ¥¬', name: 'Alface', price: 35 },
                { type: 'batata', emoji: 'ğŸ¥”', name: 'Batata', price: 30 },
                { type: 'brocolis', emoji: 'ğŸ¥¦', name: 'BrÃ³colis', price: 38 },
                { type: 'cafe', emoji: 'ğŸ”´', name: 'CafÃ©', price: 45 },
                { type: 'cenoura', emoji: 'ğŸ¥•', name: 'Cenoura', price: 28 },
                { type: 'milho', emoji: 'ğŸŒ½', name: 'Milho', price: 35 },
                { type: 'tomate', emoji: 'ğŸ…', name: 'Tomate', price: 40 },
                { type: 'trigo', emoji: 'ğŸŒ¾', name: 'Trigo', price: 32 },
                { type: 'uva', emoji: 'ğŸ‡', name: 'Uva', price: 50 },
                { type: 'mel', emoji: 'ğŸ¯', name: 'Mel', price: 120 },
                { type: 'rosa', emoji: 'ğŸŒ¹', name: 'Rosa', price: 25 },
                { type: 'girassol', emoji: 'ğŸŒ»', name: 'Girassol', price: 30 },
                { type: 'margarida', emoji: 'ğŸŒ¼', name: 'Margarida', price: 20 }
            ];
            
            // Gerar pedido aleatÃ³rio
            const numItems = Math.floor(Math.random() * 3) + 1; // 1-3 itens
            const orderItems = [];
            
            for (let i = 0; i < numItems; i++) {
                const product = availableProducts[Math.floor(Math.random() * availableProducts.length)];
                const quantity = Math.floor(Math.random() * 3) + 1; // 1-3 quantidade
                
                // Verificar se jÃ¡ existe este produto no pedido
                const existingItem = orderItems.find(item => item.type === product.type);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    orderItems.push({
                        type: product.type,
                        emoji: product.emoji,
                        name: product.name,
                        quantity: quantity,
                        price: product.price
                    });
                }
            }
            
            // Calcular valor total do pedido
            const totalValue = orderItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Criar pedido
            const order = {
                id: gameState.orders.nextOrderId++,
                items: orderItems,
                totalValue: totalValue,
                isDelivering: false,
                deliveryTimer: 0
            };
            
            gameState.orders.activeOrders.push(order);
            updateOrdersDisplay();
            
            alert(`ğŸ“‹ Novo pedido recebido! Valor: ${totalValue} moedas`);
        }
        
        function updateOrdersDisplay() {
            if (!gameState.orders.hasOrdersPanel) return;
            
            const container = document.getElementById('orders-container');
            
            if (gameState.orders.activeOrders.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 text-sm">Nenhum pedido no momento</div>';
                return;
            }
            
            let html = '';
            gameState.orders.activeOrders.forEach(order => {
                const itemsHtml = order.items.map(item => 
                    `<div class="order-item">${item.emoji} ${item.quantity}x ${item.name}</div>`
                ).join('');
                
                const buttonsHtml = order.isDelivering ? 
                    `<div class="delivery-timer">Entregando... ${order.deliveryTimer}s</div>` :
                    `<div class="order-buttons">
                        <button class="order-btn refuse" onclick="refuseOrder(${order.id})">âŒ Recusar</button>
                        <button class="order-btn deliver" onclick="deliverOrder(${order.id})">ğŸ“¦ Entregar</button>
                    </div>`;
                
                const cardClass = order.isDelivering ? 'order-card delivering' : 'order-card';
                
                html += `
                    <div class="${cardClass}">
                        <div class="flex justify-between items-center mb-2">
                            <div class="font-bold text-sm">Pedido #${order.id}</div>
                            <div class="text-sm font-bold text-green-600">${order.totalValue}ğŸ’°</div>
                        </div>
                        <div class="order-items">${itemsHtml}</div>
                        ${buttonsHtml}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function refuseOrder(orderId) {
            const orderIndex = gameState.orders.activeOrders.findIndex(order => order.id === orderId);
            if (orderIndex === -1) return;
            
            gameState.orders.activeOrders.splice(orderIndex, 1);
            updateOrdersDisplay();
            
            alert('âŒ Pedido recusado!');
        }
        
        function deliverOrder(orderId) {
            const order = gameState.orders.activeOrders.find(order => order.id === orderId);
            if (!order) return;
            
            // Verificar se tem todos os itens no celeiro
            for (const item of order.items) {
                if (!gameState.celeiro[item.type] || gameState.celeiro[item.type].count < item.quantity) {
                    alert(`âŒ VocÃª nÃ£o tem ${item.quantity}x ${item.name} no celeiro!`);
                    return;
                }
            }
            
            // Remover itens do celeiro
            for (const item of order.items) {
                gameState.celeiro[item.type].count -= item.quantity;
                if (gameState.celeiro[item.type].count === 0) {
                    delete gameState.celeiro[item.type];
                }
            }
            
            // Iniciar entrega
            order.isDelivering = true;
            order.deliveryTimer = 20; // 20 segundos
            
            updateCeleiro();
            updateOrdersDisplay();
            
            alert(`ğŸ“¦ Entrega iniciada! Duque levarÃ¡ 20 segundos para entregar o pedido.`);
        }
        
        function completeDelivery(orderId) {
            const orderIndex = gameState.orders.activeOrders.findIndex(order => order.id === orderId);
            if (orderIndex === -1) return;
            
            const order = gameState.orders.activeOrders[orderIndex];
            
            // Adicionar moedas
            gameState.coins += order.totalValue;
            
            // Remover pedido
            gameState.orders.activeOrders.splice(orderIndex, 1);
            
            updateResources();
            updateOrdersDisplay();
            
            alert(`âœ… Pedido #${order.id} entregue com sucesso! VocÃª ganhou ${order.totalValue} moedas!`);
        }
        
        function startOrdersSystem() {
            if (!gameState.orders.hasOrdersPanel) return;
            
            // Gerar primeiro pedido apÃ³s 30 segundos
            setTimeout(() => {
                generateOrder();
            }, 30000);
            
            // Timer principal do sistema de pedidos
            setInterval(() => {
                if (!gameState.orders.hasOrdersPanel) return;
                
                // Atualizar timers de entrega
                let deliveryUpdated = false;
                gameState.orders.activeOrders.forEach(order => {
                    if (order.isDelivering && order.deliveryTimer > 0) {
                        order.deliveryTimer--;
                        deliveryUpdated = true;
                        
                        if (order.deliveryTimer === 0) {
                            completeDelivery(order.id);
                        }
                    }
                });
                
                if (deliveryUpdated) {
                    updateOrdersDisplay();
                }
                
                // Gerar novos pedidos (chance de 10% a cada minuto se tiver menos de 3)
                gameState.orders.orderGenerationTimer++;
                if (gameState.orders.orderGenerationTimer >= 60) { // 1 minuto
                    gameState.orders.orderGenerationTimer = 0;
                    if (gameState.orders.activeOrders.length < 3 && Math.random() < 0.1) {
                        generateOrder();
                    }
                }
            }, 1000);
            
            // Gerar pedidos periodicamente (a cada 2-5 minutos)
            setInterval(() => {
                if (gameState.orders.hasOrdersPanel && gameState.orders.activeOrders.length < 3) {
                    if (Math.random() < 0.7) { // 70% de chance
                        generateOrder();
                    }
                }
            }, Math.random() * 180000 + 120000); // 2-5 minutos
        }

        // Inicializar jogo
        updateResources();
        updateCeleiro();
        initQuitanda();
        updateSeasonDisplay();
        startSeasonTimer();
        startRainTimer();
        startFlowerTimers();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96edd30472ee0097',t:'MTc1NTE0Njk1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
