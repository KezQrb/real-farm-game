<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Farm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #87CEEB, #98FB98);
            min-height: 100vh;
            transition: all 0.5s ease;
        }

        .night {
            background: linear-gradient(to bottom, #191970, #2F4F4F);
            color: white;
        }

        .raining {
            background: linear-gradient(to bottom, #708090, #778899);
        }

        .game-header {
            background: rgba(139, 69, 19, 0.9);
            color: white;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .game-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }

        .info-item {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .main-container {
            display: flex;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .farm-area {
            flex: 2;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .plots-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .plot {
            width: 120px;
            height: 120px;
            background: #8B4513;
            border: 3px solid #654321;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .plot:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .plot.fertilized {
            background: #654321;
            border-color: #8B4513;
        }

        .plot.watered {
            background: #4A4A4A;
            border-color: #2F4F4F;
        }

        .plot.growing {
            background: #228B22;
            border-color: #006400;
        }

        .plot-content {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .plot-status {
            font-size: 0.8rem;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .progress-bar {
            width: 80%;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #32CD32;
            width: 0%;
            transition: width 0.3s ease;
        }

        /* √Årea para sistemas da fazenda */
        .animals-area {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 450px;
            max-width: 450px;
            min-width: 450px;
            margin: 0 auto;
        }

        .animals-area h3 {
            color: #2F4F4F;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #32CD32;
            padding-bottom: 5px;
            text-align: center;
        }

        .animals-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .animals-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .animals-actions button {
            background: #32CD32;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .animals-actions button:hover {
            background: #228B22;
        }

        .sidebar {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .panel {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .panel h3 {
            color: #2F4F4F;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #32CD32;
            padding-bottom: 5px;
        }

        .seeds-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .seed-item {
            background: #F0F8FF;
            border: 2px solid #32CD32;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .seed-item:hover {
            background: #E6FFE6;
            transform: translateY(-2px);
        }

        .seed-item.selected {
            background: #90EE90;
            border-color: #228B22;
        }

        .seed-emoji {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 5px;
        }

        .seed-name {
            font-size: 0.9rem;
            font-weight: bold;
            color: #2F4F4F;
        }

        .actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .action-btn {
            background: #32CD32;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #228B22;
            transform: translateY(-2px);
        }

        .action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .well {
            background: #4682B4;
            border: 4px solid #2F4F4F;
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .well:hover {
            transform: scale(1.1);
        }

        .weather-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .weather-indicator.active {
            opacity: 1;
        }

        .rain-drops {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        .rain-drop {
            position: absolute;
            background: #87CEEB;
            width: 2px;
            height: 20px;
            border-radius: 1px;
            animation: fall linear infinite;
        }

        @keyframes fall {
            from {
                transform: translateY(-100vh);
            }
            to {
                transform: translateY(100vh);
            }
        }

        /* Efeitos das esta√ß√µes */
        .season-spring .plot.planted::after {
            content: '‚ú®‚≠ê‚ú®';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            animation: twinkle 2s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; transform: translateX(-50%) scale(1); }
            50% { opacity: 0.7; transform: translateX(-50%) scale(1.2); }
        }

        .season-autumn {
            position: relative;
        }

        .season-autumn::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="50" font-size="20">üçÇ</text></svg>') repeat;
            animation: windEffect 3s infinite linear;
            pointer-events: none;
            z-index: 1000;
            opacity: 0.7;
        }

        @keyframes windEffect {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(100vw); }
        }

        .season-winter .plot {
            background: #E6F3FF;
            border-color: #B0E0E6;
        }

        .season-winter .plot.planted {
            opacity: 0.5;
            pointer-events: none;
        }

        .snow-drop {
            position: absolute;
            background: white;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            animation: fall linear infinite;
        }

        .mine-rock {
            width: 80px;
            height: 80px;
            background: #696969;
            border: 3px solid #2F4F4F;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 2.5rem;
            position: relative;
            margin: 0 auto;
        }

        .mine-rock:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .mine-rock.mining {
            animation: rockShake 0.3s ease-in-out;
        }

        @keyframes rockShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .mining-sparks {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            opacity: 0;
            animation: sparks 0.5s ease-out;
            pointer-events: none;
        }

        @keyframes sparks {
            0% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(0.5);
            }
            100% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(1.5);
            }
        }

        /* Anima√ß√µes do lago */
        @keyframes wave {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(100px); }
        }

        @keyframes fishSwim {
            0% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(20px) translateY(-10px); }
            50% { transform: translateX(0) translateY(-20px); }
            75% { transform: translateX(-20px) translateY(-10px); }
            100% { transform: translateX(0) translateY(0); }
        }

        @keyframes fishSwim2 {
            0% { transform: translateX(0) translateY(0) scaleX(1); }
            33% { transform: translateX(-30px) translateY(15px) scaleX(-1); }
            66% { transform: translateX(30px) translateY(-15px) scaleX(1); }
            100% { transform: translateX(0) translateY(0) scaleX(1); }
        }

        @keyframes fishSwim3 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            25% { transform: translateX(25px) translateY(20px) rotate(15deg); }
            50% { transform: translateX(-10px) translateY(-25px) rotate(-10deg); }
            75% { transform: translateX(-25px) translateY(10px) rotate(5deg); }
            100% { transform: translateX(0) translateY(0) rotate(0deg); }
        }

        .fish {
            position: absolute;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            user-select: none;
        }

        .fish:hover {
            transform: scale(1.2);
            filter: brightness(1.2);
        }

        .fish.swimming1 {
            animation: fishSwim 4s ease-in-out infinite;
        }

        .fish.swimming2 {
            animation: fishSwim2 5s ease-in-out infinite;
        }

        .fish.swimming3 {
            animation: fishSwim3 6s ease-in-out infinite;
        }

        .fish.caught {
            animation: fishCaught 0.5s ease-out forwards;
        }

        @keyframes fishCaught {
            0% { 
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
            50% { 
                transform: scale(1.5) rotate(180deg);
                opacity: 0.8;
            }
            100% { 
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        .order-item {
            background: #F0F8FF;
            border: 2px solid #4682B4;
            border-radius: 8px;
            padding: 8px;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .order-item.ready {
            border-color: #32CD32;
            background: #F0FFF0;
        }

        .order-item.delivering {
            border-color: #FFD700;
            background: #FFFACD;
            animation: pulse 1s infinite;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-weight: bold;
            color: #2F4F4F;
            font-size: 0.8rem;
        }

        .order-items {
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            margin-bottom: 6px;
        }

        .order-item-detail {
            background: rgba(255,255,255,0.7);
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.7rem;
            border: 1px solid #ddd;
        }

        .order-actions {
            display: flex;
            gap: 5px;
            justify-content: center;
        }

        .order-btn {
            background: #32CD32;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .order-btn:hover {
            background: #228B22;
        }

        .order-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .fishing-ripple {
            position: absolute;
            border: 2px solid rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: ripple 1s ease-out;
            pointer-events: none;
        }

        @keyframes ripple {
            0% {
                width: 0;
                height: 0;
                opacity: 1;
            }
            100% {
                width: 100px;
                height: 100px;
                opacity: 0;
            }
        }



        .grass-tile {
            width: 30px;
            height: 30px;
            background: #32CD32;
            border: 2px solid #228B22;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .grass-tile:hover {
            transform: scale(1.1);
            background: #90EE90;
        }

        .grass-tile.empty {
            background: #8B4513;
            border-color: #654321;
            cursor: not-allowed;
        }

        .grass-tile.regenerating {
            background: #DAA520;
            border-color: #B8860B;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .cow-item {
            background: #F0F8FF;
            border: 2px solid #8B4513;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .cow-item:hover {
            background: #E6FFE6;
            transform: translateY(-2px);
        }

        .cow-item.fed {
            background: #90EE90;
            border-color: #228B22;
        }

        .cow-item.ready-to-milk {
            background: #FFD700;
            border-color: #FFA500;
            animation: pulse 1s infinite;
        }

        .cow-item.sick {
            background: #FF6B6B;
            border-color: #FF4757;
            animation: sickPulse 1.5s infinite;
        }

        @keyframes sickPulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                background: #FF6B6B;
            }
            50% { 
                opacity: 0.7; 
                transform: scale(0.95);
                background: #FF4757;
            }
        }

        .cow-emoji {
            font-size: 2rem;
            display: block;
            margin-bottom: 5px;
        }

        .cow-status {
            font-size: 0.8rem;
            font-weight: bold;
            color: #2F4F4F;
        }

        .cow-timer {
            font-size: 0.7rem;
            color: #666;
            margin-top: 3px;
        }

        .product-item {
            background: #F0F8FF;
            border: 2px solid #32CD32;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .product-item:hover {
            background: #E6FFE6;
            transform: translateY(-2px);
        }

        .product-emoji {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .product-count {
            font-size: 0.9rem;
            font-weight: bold;
            color: #2F4F4F;
        }

        .product-price {
            font-size: 0.8rem;
            color: #666;
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .plots-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .plot {
                width: 100px;
                height: 100px;
            }

            .animals-area {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="game-header">
        <h1 class="game-title">üöú Real Farm üå± - <span id="season-display">üå∏ Primavera</span></h1>
        <div class="game-info">
            <div class="info-item">üí∞ <span id="money">200</span> moedas</div>
            <div class="info-item">üíß <span id="water">0</span> baldes</div>
            <div class="info-item">üåø <span id="fertilizer">0</span> adubos</div>
            <button onclick="manualSave()" style="background: #32CD32; color: white; border: none; padding: 8px 15px; border-radius: 20px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; margin-left: 10px;" onmouseover="this.style.background='#228B22'" onmouseout="this.style.background='#32CD32'">üíæ Salvar</button>
        </div>
    </div>



    <div class="main-container">
        <div class="farm-area">
            <div>
                <h2 style="color: white; text-align: center; margin-bottom: 20px;">üåæ Canteiros da Fazenda</h2>
                <div class="plots-grid" id="plots-grid">
                    <!-- Canteiros ser√£o gerados pelo JavaScript -->
                </div>
            </div>

            <div class="panel" id="well-panel" style="display: none;">
                <h3>üíß Po√ßo de √Ågua</h3>
                <div class="well" id="well" onclick="collectWater()">
                    <span style="color: white; font-size: 2rem;">ü™£</span>
                </div>
                <p style="text-align: center; color: #2F4F4F;">Clique para coletar 4 √°guas</p>
            </div>

            <div class="animals-area" id="chickens-area" style="display: none;">
                <h3>üêî Galinheiro</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üêî Galinhas: <span id="chicken-count">0</span>/4 | üê£ Pintinhos: <span id="chick-count">0</span></div>
                    <div>ü•ö Ovos dispon√≠veis: <span id="available-eggs">0</span> | üçó Frangos: <span id="raw-chicken-count">0</span></div>
                </div>
                <div id="chickens-container" class="animals-container">
                    <!-- Galinhas ser√£o geradas pelo JavaScript -->
                </div>
                <div class="animals-actions">
                    <button onclick="feedAllChickens()">Alimentar Todas</button>
                    <button onclick="collectAllEggs()">Coletar Todos</button>
                    <button onclick="breedChickens()" id="breed-btn">üê£ Gerar Pintinho</button>
                    <button onclick="sacrificeChicken()" id="sacrifice-btn">üçó Sacrificar Galinha</button>
                </div>
            </div>



            <div class="animals-area" id="pigs-area" style="display: none;">
                <h3>üê∑ Chiqueiro</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üê∑ Porcos: <span id="pig-count">0</span></div>
                    <div>ü•© Carne dispon√≠vel: <span id="available-meat">0</span></div>
                </div>
                <div id="pigs-container" class="animals-container">
                    <!-- Porcos ser√£o geradas pelo JavaScript -->
                </div>
                <div class="animals-actions">
                    <button onclick="feedAllPigs()">Alimentar Todos</button>
                    <button onclick="collectAllMeat()">Coletar Toda</button>
                </div>
            </div>



            <div class="animals-area" id="sheep-area" style="display: none;">
                <h3>üêë Curral das Ovelhas</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üêë Ovelhas: <span id="sheep-count">0</span></div>
                    <div>üß∂ L√£ dispon√≠vel: <span id="available-wool">0</span></div>
                </div>
                <div id="sheep-container" class="animals-container">
                    <!-- Ovelhas ser√£o geradas pelo JavaScript -->
                </div>
                <div class="animals-actions">
                    <button onclick="feedAllSheep()">Alimentar Todas</button>
                    <button onclick="collectAllWool()">Coletar Toda L√£</button>
                </div>
            </div>

            <div class="animals-area" id="bonfire-area" style="display: none;">
                <h3>üî• Fogueira de Aquecimento</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>ü™® Lenha dispon√≠vel: <span id="firewood-for-bonfire">0</span></div>
                    <div>ü™® Carv√£o dispon√≠vel: <span id="coal-for-bonfire">0</span></div>
                    <div>üî• Status: <span id="bonfire-status">Apagada</span></div>
                </div>
                <div style="text-align: center; margin-bottom: 15px; position: relative;">
                    <div id="bonfire-display" onclick="lightBonfire()" style="font-size: 4rem; cursor: pointer; transition: transform 0.3s ease;">
                        ü™µ
                    </div>
                    <div id="bonfire-flames" style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 2rem; opacity: 0; transition: opacity 0.5s ease;">üî•</div>
                    <div id="bonfire-timer" style="color: #2F4F4F; font-size: 0.9rem; margin-top: 5px;"></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F; text-align: center;">
                    <strong>Receita da Fogueira:</strong><br>
                    ü™® 4 lenhas + ü™® 3 carv√µes = üî• Aquece animais por 1 hora<br>
                    <em>‚ùÑÔ∏è Necess√°ria no inverno para TODOS os animais produzirem</em>
                </div>
                <div class="animals-actions">
                    <button onclick="lightBonfire()" id="light-bonfire-btn">üî• Acender Fogueira</button>
                </div>
            </div>



            <div class="animals-area" id="pasture-area" style="display: none;">
                <h3>üêÑ Pasto das Vacas</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üêÑ Vacas: <span id="cow-count">0</span></div>
                    <div>ü•õ Leite dispon√≠vel: <span id="available-milk">0</span></div>
                </div>
                <div id="cows-container" class="animals-container">
                    <!-- Vacas ser√£o geradas pelo JavaScript -->
                </div>
                <div class="animals-actions">
                    <button onclick="feedAllCows()">Alimentar Todas</button>
                    <button onclick="milkAllCows()">Ordenhar Todas</button>
                </div>
            </div>



            <div class="animals-area" id="horse-stable" style="display: none;">
                <h3>üê¥ Baia do Duque</h3>
                <div style="margin-bottom: 10px; text-align: center; font-size: 0.85rem;">
                    <div>üê¥ Cavalo: Duque</div>
                    <div>‚ù§Ô∏è Amizade: <span id="horse-friendship">0</span>/100</div>
                    <div>üü® Feno: <span id="hay-for-horse">0</span> | üçé Ma√ß√£s: <span id="apples-count">0</span></div>
                </div>
                <div style="text-align: center; margin-bottom: 10px; position: relative;">
                    <div id="horse-display" onclick="interactWithHorse()" style="font-size: 3rem; cursor: pointer; transition: transform 0.3s ease;">
                        üê¥
                    </div>
                    <div id="horse-hearts" style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); font-size: 1.2rem; opacity: 0; transition: opacity 0.5s ease;"></div>
                    <div id="horse-status" style="color: #2F4F4F; font-size: 0.8rem; margin-top: 3px;">Com fome (precisa de 1 feno/dia)</div>
                </div>
                <div class="animals-actions" style="gap: 5px;">
                    <button onclick="giveHayToHorse()" style="font-size: 0.8rem; padding: 6px 8px;">üü® Dar Feno</button>
                    <button onclick="giveAppleToHorse()" style="font-size: 0.8rem; padding: 6px 8px;">üçé Dar Ma√ß√£</button>
                    <button onclick="rideHorse()" id="ride-btn" style="display: none; font-size: 0.8rem; padding: 6px 8px;">üèá Montar</button>
                </div>
            </div>



            <div class="animals-area" id="grass-field-area" style="display: none;">
                <h3>üåø Campo de Grama</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üåø Gramas coletadas: <span id="grass-collected">0</span>/4</div>
                    <div>üå∏ Flores no invent√°rio: <span id="flower-inventory">0</span></div>
                </div>
                <div id="grass-grid" style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 5px; margin-bottom: 15px;">
                    <!-- Campo de grama ser√° gerado pelo JavaScript -->
                </div>
                <p style="text-align: center; color: #2F4F4F; font-size: 0.9rem;">Clique na grama para coletar. A cada 4 gramas = 1 flor!</p>
            </div>

            <div class="animals-area" id="dog-area" style="display: none;">
                <h3>üêï Mocinha - Pet da Fazenda</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üêï Cachorra: Mocinha</div>
                    <div>ü¶¥ Ra√ß√£o de cachorro: <span id="dog-food-count">0</span></div>
                    <div>ü¶¥ Ossos (petiscos): <span id="dog-bones-count">0</span></div>
                    <div>‚ù§Ô∏è Amizade: <span id="dog-friendship">0</span>/100</div>
                    <div>üíé Tesouros encontrados hoje: <span id="treasures-found-today">0</span>/1</div>
                </div>
                <div style="text-align: center; margin-bottom: 15px; position: relative;">
                    <div id="dog-display" onclick="interactWithDog()" style="font-size: 4rem; cursor: pointer; transition: transform 0.3s ease;">
                        üêï
                    </div>
                    <div id="dog-hearts" style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 1.5rem; opacity: 0; transition: opacity 0.5s ease;"></div>
                    <div id="dog-status" style="color: #2F4F4F; font-size: 0.9rem; margin-top: 5px;">Com fome</div>
                </div>
                <div class="animals-actions">
                    <button onclick="feedDog()">ü¶¥ Alimentar Mocinha</button>
                    <button onclick="giveBoneTreat()">ü¶¥ Dar Petisco (+10 amizade)</button>
                    <button onclick="collectTreasure()" id="collect-treasure-btn" style="display: none;">üíé Coletar Tesouro</button>
                </div>
            </div>



            <div class="animals-area" id="beehive-area" style="display: none;">
                <h3>üêù Colmeia</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üçØ Mel dispon√≠vel: <span id="honey-available">0</span></div>
                    <div>üìÖ Pr√≥xima produ√ß√£o: <span id="honey-timer">20 min</span></div>
                </div>
                <div style="text-align: center; margin-bottom: 10px; position: relative;">
                    <div style="display: flex; justify-content: center; align-items: center; gap: 5px; margin-bottom: 5px;">
                        <div style="font-size: 1rem;">üêù</div>
                        <div onclick="collectHoney()" style="font-size: 2.5rem; cursor: pointer; transition: transform 0.3s ease;" id="beehive-display">
                            üçØ
                        </div>
                        <div style="font-size: 1rem;">üêù</div>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 8px; font-size: 1.2rem;">
                        üå∏ üå∫ üåª
                    </div>
                    <p style="color: #2F4F4F; font-size: 0.8rem; margin-top: 5px;">Colmeia (2 potes a cada 20 min)</p>
                </div>
                <div class="animals-actions">
                    <button onclick="collectHoney()" id="collect-honey-btn">üçØ Coletar Mel</button>
                </div>
            </div>

            <div class="animals-area" id="greenhouse-area" style="display: none;">
                <h3>üè† Estufa (Inverno)</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>‚ùÑÔ∏è Canteiros protegidos: 12</div>
                    <div>üå°Ô∏è Temperatura controlada para plantio no inverno</div>
                </div>
                <div class="plots-grid" id="greenhouse-grid" style="grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 600px; margin: 0 auto;">
                    <!-- Canteiros da estufa ser√£o gerados pelo JavaScript -->
                </div>
            </div>

            <div class="animals-area" id="order-panel" style="display: none;">
                <h3>üìã Painel de Pedidos</h3>
                <div style="margin-bottom: 10px; text-align: center; font-size: 0.85rem;">
                    <div>üì¶ Ativos: <span id="active-orders">0</span>/3 | ‚úÖ Entregues: <span id="completed-orders">0</span> | üê¥ <span id="horse-delivery-status">Dispon√≠vel</span></div>
                </div>
                <div id="orders-container" style="display: grid; grid-template-columns: 1fr; gap: 8px; margin-bottom: 10px; max-height: 300px; overflow-y: auto;">
                    <!-- Pedidos ser√£o gerados aqui -->
                </div>
                <div class="animals-actions">
                    <button onclick="generateNewOrder()" id="generate-order-btn" style="font-size: 0.8rem; padding: 6px 8px;">üìã Gerar 3 Pedidos</button>
                </div>
            </div>



            <div class="animals-area" id="tree-area" style="display: none;">
                <h3>üå≥ Bosque</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>ü™µ Troncos coletados: <span id="logs-count">0</span></div>
                    <div>ü™ì Machado: <span id="axe-status">N√£o possui</span> (<span id="axe-uses">0</span>/50 usos)</div>
                    <div>üçé Ma√ß√£s: <span id="apples-collected">0</span> | üçå Bananas: <span id="bananas-collected">0</span> | üçä Laranjas: <span id="oranges-collected">0</span></div>
                    <div>üåø Galhos: <span id="branches-collected">0</span></div>
                </div>
                <div style="text-align: center; margin-bottom: 15px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                    <div>
                        <div class="tree" id="tree" onclick="collectLogs()" style="font-size: 3rem; cursor: pointer; transition: transform 0.3s ease;">
                            üå≥
                        </div>
                        <p style="color: #2F4F4F; font-size: 0.8rem;">√Årvore (1 tronco/batida, galho a cada 3)</p>
                        <div id="tree-timer" style="font-size: 0.7rem; color: #666;"></div>
                    </div>
                    <div>
                        <div class="tree" id="apple-tree" onclick="collectApples()" style="font-size: 3rem; cursor: pointer; transition: transform 0.3s ease;">
                            üçé
                        </div>
                        <p style="color: #2F4F4F; font-size: 0.8rem;">Macieira (5 ma√ß√£s/dia)</p>
                        <div id="apple-timer" style="font-size: 0.7rem; color: #666;"></div>
                    </div>
                    <div>
                        <div class="tree" id="banana-tree" onclick="collectBananas()" style="font-size: 3rem; cursor: pointer; transition: transform 0.3s ease;">
                            üçå
                        </div>
                        <p style="color: #2F4F4F; font-size: 0.8rem;">Bananeira (4 bananas/dia)</p>
                        <div id="banana-timer" style="font-size: 0.7rem; color: #666;"></div>
                    </div>
                    <div>
                        <div class="tree" id="orange-tree" onclick="collectOranges()" style="font-size: 3rem; cursor: pointer; transition: transform 0.3s ease;">
                            üçä
                        </div>
                        <p style="color: #2F4F4F; font-size: 0.8rem;">Laranjeira (4 laranjas/dia)</p>
                        <div id="orange-timer" style="font-size: 0.7rem; color: #666;"></div>
                    </div>
                </div>
            </div>





            <div class="animals-area" id="fishing-lake" style="display: none;">
                <h3>üé£ Lago dos Peixes</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>üêü Peixes dispon√≠veis hoje: <span id="fish-available">4</span>/4</div>
                    <div>üé£ Vara de pesca: <span id="fishing-rod-status">N√£o possui</span> (<span id="rod-uses">0</span>/50 usos)</div>
                    <div>üêü Peixes pescados: <span id="fish-caught-today">0</span></div>
                    <div>ü¶™ Total pescado: <span id="total-fish-caught">0</span> (pr√≥xima p√©rola: <span id="next-pearl">6</span>)</div>
                </div>
                <div style="text-align: center; margin-bottom: 15px; position: relative;">
                    <div id="fishing-lake-container" style="background: linear-gradient(to bottom, #87CEEB, #4682B4); border-radius: 20px; width: 300px; height: 200px; margin: 0 auto; position: relative; overflow: hidden; cursor: crosshair; border: 3px solid #2F4F4F;">
                        <div style="position: absolute; top: 10px; left: 10px; font-size: 1.5rem; opacity: 0.3;">üåä</div>
                        <div style="position: absolute; top: 10px; right: 10px; font-size: 1.5rem; opacity: 0.3;">üåä</div>
                        <div style="position: absolute; bottom: 10px; left: 10px; font-size: 1.5rem; opacity: 0.3;">üåä</div>
                        <div style="position: absolute; bottom: 10px; right: 10px; font-size: 1.5rem; opacity: 0.3;">üåä</div>
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2rem; opacity: 0.2;">üåä</div>
                        
                        <!-- Peixes ser√£o adicionados aqui pelo JavaScript -->
                        <div id="fish-container"></div>
                        
                        <!-- Efeito de ondas -->
                        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 20\"><path d=\"M0,10 Q25,0 50,10 T100,10 V20 H0 Z\" fill=\"rgba(255,255,255,0.1)\"/></svg>') repeat-x; animation: wave 3s linear infinite; pointer-events: none;"></div>
                    </div>
                    <p style="color: #2F4F4F; font-size: 0.8rem; margin-top: 5px;">Clique nos peixes para pesc√°-los! (Precisa de vara de pesca)</p>
                    <div id="fishing-status" style="font-size: 0.9rem; color: #2F4F4F; margin-top: 5px;"></div>
                </div>
                <div class="animals-actions">
                    <button onclick="spawnFish()" id="spawn-fish-btn" style="display: none;">üêü Repovoar Lago</button>
                </div>
            </div>

            <div class="animals-area" id="mine-area" style="display: none;">
                <h3>‚õèÔ∏è Mina</h3>
                <div style="margin-bottom: 15px; text-align: center;">
                    <div>‚õèÔ∏è Picareta: <span id="pickaxe-status">N√£o possui</span> (<span id="pickaxe-uses">0</span>/54 usos)</div>
                    <div>ü™® Carv√£o coletado: <span id="coal-count">0</span></div>
                    <div>üíé <span id="ruby-count">0</span> Rubis | üíö <span id="emerald-count">0</span> Esmeraldas | üíô <span id="sapphire-count">0</span> Safiras</div>
                </div>
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; max-width: 300px; margin: 0 auto;">
                        <div style="text-align: center;">
                            <div class="mine-rock" id="rock-1" onclick="mineRock(0)">
                                ü™®
                            </div>
                            <p style="color: #2F4F4F; font-size: 0.8rem; margin-top: 5px;">Rocha 1</p>
                            <div id="rock-1-hits" style="font-size: 0.7rem; color: #666;">0/3 batidas</div>
                        </div>
                        <div style="text-align: center;">
                            <div class="mine-rock" id="rock-2" onclick="mineRock(1)">
                                ü™®
                            </div>
                            <p style="color: #2F4F4F; font-size: 0.8rem; margin-top: 5px;">Rocha 2</p>
                            <div id="rock-2-hits" style="font-size: 0.7rem; color: #666;">0/3 batidas</div>
                        </div>
                        <div style="text-align: center;">
                            <div class="mine-rock" id="rock-3" onclick="mineRock(2)">
                                ü™®
                            </div>
                            <p style="color: #2F4F4F; font-size: 0.8rem; margin-top: 5px;">Rocha 3</p>
                            <div id="rock-3-hits" style="font-size: 0.7rem; color: #666;">0/3 batidas</div>
                        </div>
                    </div>
                    <p style="color: #2F4F4F; font-size: 0.8rem; margin-top: 10px;">A cada 3 batidas voc√™ ganha carv√£o ou uma pedra preciosa!</p>
                    <div id="mining-status" style="font-size: 0.9rem; color: #2F4F4F; margin-top: 5px;"></div>
                </div>
            </div>

            <div class="panel">
                <h3>ü•¨ Quitanda</h3>
                <div style="margin-bottom: 10px;">
                    <h4 style="color: #2F4F4F; margin-bottom: 8px; font-size: 1rem;">Produtos da Fazenda:</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px;">
                        <div class="product-item" onclick="sellProduct('milk')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">ü•õ</div>
                            <div class="product-count" id="milk-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">15m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('eggs')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">ü•ö</div>
                            <div class="product-count" id="eggs-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">12m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('coffee')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">‚òï</div>
                            <div class="product-count" id="coffee-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">25m</div>
                        </div>

                        <div class="product-item" onclick="sellProduct('flour')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçö</div>
                            <div class="product-count" id="flour-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">20m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('honey')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçØ</div>
                            <div class="product-count" id="honey-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">35m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('meat')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">ü•©</div>
                            <div class="product-count" id="meat-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">50m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('juice')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üç∑</div>
                            <div class="product-count" id="juice-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">40m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('cheese')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üßÄ</div>
                            <div class="product-count" id="cheese-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">60m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('yarn')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üßµ</div>
                            <div class="product-count" id="yarn-count-display" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">45m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('bread')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçû</div>
                            <div class="product-count" id="bread-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">35m</div>
                        </div>

                        <div class="product-item" onclick="sellProduct('rawChicken')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçó</div>
                            <div class="product-count" id="raw-chicken-market" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">80m</div>
                        </div>
                        <div class="product-item" onclick="sellProduct('fish')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üêü</div>
                            <div class="product-count" id="fish-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">30m</div>
                        </div>
                    </div>
                </div>
                <div style="margin-bottom: 10px;">
                    <h4 style="color: #2F4F4F; margin-bottom: 8px; font-size: 1rem;">Frutas e Vegetais:</h4>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px;">
                        <div class="product-item" onclick="sellFruit('banana')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçå</div>
                            <div class="product-count" id="banana-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">8m</div>
                        </div>
                        <div class="product-item" onclick="sellFruit('apple')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçé</div>
                            <div class="product-count" id="apple-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">10m</div>
                        </div>
                        <div class="product-item" onclick="sellFruit('orange')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçä</div>
                            <div class="product-count" id="orange-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">9m</div>
                        </div>
                        <div class="product-item" onclick="sellInventoryItem(0)" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;" id="potato-emoji">ü•î</div>
                            <div class="product-count" id="potato-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;" id="potato-price">25m</div>
                        </div>
                        <div class="product-item" onclick="sellInventoryItem(1)" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;" id="tomato-emoji">üçÖ</div>
                            <div class="product-count" id="tomato-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;" id="tomato-price">30m</div>
                        </div>
                        <div class="product-item" onclick="sellInventoryItem(2)" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;" id="carrot-emoji">ü•ï</div>
                            <div class="product-count" id="carrot-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;" id="carrot-price">20m</div>
                        </div>
                        <div class="product-item" onclick="sellInventoryItem(6)" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;" id="pumpkin-emoji">üéÉ</div>
                            <div class="product-count" id="pumpkin-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;" id="pumpkin-price">40m</div>
                        </div>
                        <div class="product-item" onclick="sellInventoryItem(7)" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;" id="broccoli-emoji">ü•¶</div>
                            <div class="product-count" id="broccoli-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;" id="broccoli-price">25m</div>
                        </div>
                        <div class="product-item" onclick="sellInventoryItem(8)" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;" id="lettuce-emoji">ü•¨</div>
                            <div class="product-count" id="lettuce-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;" id="lettuce-price">20m</div>
                        </div>
                    </div>
                </div>
                <div style="margin-bottom: 10px;">
                    <h4 style="color: #2F4F4F; margin-bottom: 8px; font-size: 1rem;">Tesouros da Mocinha:</h4>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px;">
                        <div class="product-item" onclick="sellTreasure('cd')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üíø</div>
                            <div class="product-count" id="cd-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">80m</div>
                        </div>
                        <div class="product-item" onclick="sellTreasure('bottle')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üçº</div>
                            <div class="product-count" id="bottle-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">60m</div>
                        </div>
                        <div class="product-item" onclick="sellTreasure('shoe')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üëü</div>
                            <div class="product-count" id="shoe-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">70m</div>
                        </div>
                        <div class="product-item" onclick="sellTreasure('ball')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">‚öΩ</div>
                            <div class="product-count" id="ball-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">90m</div>
                        </div>
                    </div>
                </div>
                <div style="margin-bottom: 10px;">
                    <h4 style="color: #2F4F4F; margin-bottom: 8px; font-size: 1rem;">Pedras Preciosas da Mina:</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px;">
                        <div class="product-item" onclick="sellGem('ruby')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üíé</div>
                            <div class="product-count" id="ruby-market-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">150m</div>
                        </div>
                        <div class="product-item" onclick="sellGem('emerald')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üíö</div>
                            <div class="product-count" id="emerald-market-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">200m</div>
                        </div>
                        <div class="product-item" onclick="sellGem('sapphire')" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">üíô</div>
                            <div class="product-count" id="sapphire-market-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">180m</div>
                        </div>
                    </div>
                </div>
                <div style="margin-bottom: 10px;">
                    <h4 style="color: #2F4F4F; margin-bottom: 8px; font-size: 1rem;">P√©rolas do Lago:</h4>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 5px;">
                        <div class="product-item" onclick="sellPearl()" style="padding: 5px;">
                            <div class="product-emoji" style="font-size: 1.2rem;">ü¶™</div>
                            <div class="product-count" id="pearl-count" style="font-size: 0.8rem;">0</div>
                            <div class="product-price" style="font-size: 0.7rem;">250m</div>
                        </div>
                    </div>
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="sellAllProducts()" style="padding: 8px; font-size: 0.9rem;">Vender Todos</button>
                </div>
            </div>


        </div>

        <div class="sidebar">
            <div class="panel">
                <h3>üë©‚Äçüåæ Eu</h3>
                <div style="text-align: center; margin-bottom: 10px;">
                    <div id="avatar-display" style="font-size: 2.5rem; margin-bottom: 8px;">üë©‚Äçüåæ</div>
                    <div style="margin-bottom: 8px;">
                        <div style="background: #ddd; border-radius: 8px; height: 15px; overflow: hidden;">
                            <div id="energy-bar" style="background: linear-gradient(90deg, #32CD32, #FFD700, #FF6347); height: 100%; width: 100%; transition: width 0.3s ease;"></div>
                        </div>
                        <div style="font-size: 0.8rem; color: #2F4F4F; margin-top: 3px;">
                            Energia: <span id="energy-display">100</span>%
                        </div>
                    </div>
                    <div id="avatar-status" style="font-size: 0.8rem; color: #2F4F4F; margin-bottom: 8px;">Energizada e pronta!</div>
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="restAvatar()" id="rest-btn" style="padding: 8px; font-size: 0.9rem;">üí§ Descansar (5 min)</button>
                    <button class="action-btn" onclick="showFoodMenu()" id="eat-btn" style="padding: 8px; font-size: 0.9rem;">üçΩÔ∏è Comer</button>
                </div>

            </div>



            <div class="panel">
                <h3>üå± Sementes & Celeiro</h3>
                <div class="seeds-grid" id="seeds-grid" style="grid-template-columns: repeat(2, 1fr); gap: 8px;">
                    <!-- Sementes ser√£o geradas pelo JavaScript -->
                </div>
                <div style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #32CD32;">
                    <h4 style="color: #2F4F4F; margin-bottom: 8px; font-size: 1rem;">Celeiro:</h4>
                    <div id="inventory-display" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; font-size: 0.8rem;">
                        <!-- Celeiro ser√° atualizado pelo JavaScript -->
                    </div>
                    <div id="hay-display" style="margin-top: 10px; text-align: center; padding: 8px; background: #FFF8DC; border-radius: 8px; border: 2px solid #DAA520;">
                        <div style="font-size: 1.2rem; margin-bottom: 3px;">üü®</div>
                        <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Feno: <span id="hay-celeiro">0</span></div>
                    </div>
                    <div id="feed-display" style="margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div style="text-align: center; padding: 8px; background: #FFE4E1; border-radius: 8px; border: 2px solid #FF6347;">
                            <div style="font-size: 1.2rem; margin-bottom: 3px;">üêî</div>
                            <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Ra√ß√£o Galinha: <span id="chicken-feed-celeiro">0</span></div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: #F0E68C; border-radius: 8px; border: 2px solid #DAA520;">
                            <div style="font-size: 1.2rem; margin-bottom: 3px;">üê∑</div>
                            <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Ra√ß√£o Porco: <span id="pig-feed-celeiro">0</span></div>
                        </div>
                    </div>
                    <div id="food-display" style="margin-top: 10px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                        <div style="text-align: center; padding: 8px; background: #E6FFE6; border-radius: 8px; border: 2px solid #32CD32;">
                            <div style="font-size: 1.2rem; margin-bottom: 3px;">ü•ó</div>
                            <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Saladas: <span id="salad-celeiro">0</span></div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: #FFF8DC; border-radius: 8px; border: 2px solid #DAA520;">
                            <div style="font-size: 1.2rem; margin-bottom: 3px;">üç≤</div>
                            <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Ensopados: <span id="stew-celeiro">0</span></div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: #FFE4E1; border-radius: 8px; border: 2px solid #FF6347;">
                            <div style="font-size: 1.2rem; margin-bottom: 3px;">ü•©</div>
                            <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Bifes: <span id="steak-celeiro">0</span></div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: #E0F6FF; border-radius: 8px; border: 2px solid #4682B4;">
                            <div style="font-size: 1.2rem; margin-bottom: 3px;">üêü</div>
                            <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Peixes Assados: <span id="baked-fish-celeiro">0</span></div>
                        </div>
                    </div>
                    <div id="vaccine-display" style="margin-top: 10px; text-align: center; padding: 8px; background: #FFE4E1; border-radius: 8px; border: 2px solid #FF6347;">
                        <div style="font-size: 1.2rem; margin-bottom: 3px;">üíâ</div>
                        <div style="font-size: 0.8rem; color: #2F4F4F; font-weight: bold;">Vacinas: <span id="vaccines-celeiro">0</span></div>
                    </div>
                    <div id="coal-display" style="margin-top: 10px; text-align: center; padding: 8px; background: #2F2F2F; border-radius: 8px; border: 2px solid #696969;">
                        <div style="font-size: 1.2rem; margin-bottom: 3px;">ü™®</div>
                        <div style="font-size: 0.8rem; color: white; font-weight: bold;">Carv√£o: <span id="coal-celeiro">0</span></div>
                    </div>
                </div>
            </div>



            <div class="panel">
                <h3>üè™ Mercadinho</h3>
                <div class="actions" style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                    <!-- Ordem reorganizada conforme solicitado -->
                    <button class="action-btn" onclick="buyWell()" id="buy-well-btn">Comprar Po√ßo (50 moedas)</button>
                    <button class="action-btn" onclick="buyBosque()" id="buy-bosque-btn">Comprar Bosque (300 moedas)</button>
                    <button class="action-btn" onclick="buyAxe()" id="buy-axe-btn">Comprar Machado (40 moedas)</button>
                    <button class="action-btn" onclick="buyGrassField()" id="buy-grass-btn">Comprar Campo de Grama (150 moedas)</button>
                    <button class="action-btn" onclick="buyPasture()" id="buy-pasture-btn">Comprar Pasto (200 moedas)</button>
                    <button class="action-btn" onclick="buyCow()" id="buy-cow-btn" style="display: none;">Comprar Vaca Leiteira (80 moedas)</button>
                    <button class="action-btn" onclick="buyDryer()" id="buy-dryer-btn">Comprar Secador de Grama (80 moedas)</button>
                    <button class="action-btn" onclick="buyCompost()" id="buy-compost-btn">Comprar Composteira (100 moedas)</button>
                    <button class="action-btn" onclick="buyMixer()" id="buy-mixer-btn">Comprar Misturador (120 moedas)</button>
                    <button class="action-btn" onclick="buyChickenCoop()" id="buy-chicken-coop-btn">Comprar Galinheiro (150 moedas)</button>
                    <button class="action-btn" onclick="buyChicken()" id="buy-chicken-btn" style="display: none;">Comprar Galinha (60 moedas)</button>
                    <button class="action-btn" onclick="buyPigPen()" id="buy-pig-pen-btn">Comprar Chiqueiro (120 moedas)</button>
                    <button class="action-btn" onclick="buyPig()" id="buy-pig-btn" style="display: none;">Comprar Porco (100 moedas)</button>
                    <button class="action-btn" onclick="buyStove()" id="buy-stove-btn">Comprar Fog√£o a Lenha (150 moedas)</button>
                    <button class="action-btn" onclick="buyPlots()" id="buy-plots-btn">Comprar +8 Canteiros (200 moedas)</button>
                    <button class="action-btn" onclick="buySheepPen()" id="buy-sheep-pen-btn">Comprar Curral de Ovelhas (180 moedas)</button>
                    <button class="action-btn" onclick="buySheep()" id="buy-sheep-btn" style="display: none;">Comprar Ovelha (70 moedas)</button>
                    
                    <!-- Restante em ordem aleat√≥ria -->
                    <button class="action-btn" onclick="buyCheeseMaker()" id="buy-cheese-btn">Comprar Queijaria (90 moedas)</button>
                    <button class="action-btn" onclick="buyRoaster()" id="buy-roaster-btn">Comprar Torradeira (60 moedas)</button>
                    <button class="action-btn" onclick="buySpinningMachine()" id="buy-spinning-btn">Comprar M√°quina de Fiar (70 moedas)</button>
                    <button class="action-btn" onclick="buyMill()" id="buy-mill-btn">Comprar Moinho (85 moedas)</button>
                    <button class="action-btn" onclick="buyBeehive()" id="buy-beehive-btn">Comprar Colmeia (120 moedas)</button>
                    <button class="action-btn" onclick="buyJuiceMaker()" id="buy-juice-btn">Comprar M√°quina de Suco (75 moedas)</button>
                    <button class="action-btn" onclick="buyGreenhouse()" id="buy-greenhouse-btn">Comprar Estufa (800 moedas)</button>
                    <button class="action-btn" onclick="buyFishingLake()" id="buy-fishing-lake-btn">Comprar Lago dos Peixes (250 moedas)</button>
                    <button class="action-btn" onclick="buyFishingRod()" id="buy-fishing-rod-btn" style="display: none;">Comprar Vara de Pesca (60 moedas)</button>
                    <button class="action-btn" onclick="buyDogFood()" id="buy-dog-food-btn">Comprar Ra√ß√£o de Cachorro (15 moedas)</button>
                    <button class="action-btn" onclick="buyVaccine()" id="buy-vaccine-btn">Comprar Vacina Animal (25 moedas)</button>
                    <button class="action-btn" onclick="buyDog()" id="buy-dog-btn">Comprar Mocinha (500 moedas)</button>
                    <button class="action-btn" onclick="buyHorse()" id="buy-horse-btn">Comprar Duque (1000 moedas)</button>
                    <button class="action-btn" onclick="buyOrderPanel()" id="buy-order-panel-btn" style="display: none;">Comprar Painel de Pedidos (500 moedas)</button>
                    <button class="action-btn" onclick="buyPickaxe()" id="buy-pickaxe-btn">Comprar Picareta (80 moedas)</button>
                    <button class="action-btn" onclick="buyMine()" id="buy-mine-btn" style="display: none;">Comprar Mina (400 moedas)</button>
                    <button class="action-btn" onclick="buyHorseWinterClothing()" id="buy-horse-clothing-btn" style="display: none;">Comprar Roupa de Frio para Duque (150 moedas)</button>
                </div>
            </div>



            <div class="panel" id="compost-panel" style="display: none;">
                <h3>üóëÔ∏è Composteira</h3>
                <div style="margin-bottom: 15px;">
                    <div>üå∏ Flores: <span id="flowers">0</span></div>
                    <div>üåø Galhos: <span id="branches">0</span></div>
                    <div>üí© Esterco: <span id="manure">0</span></div>
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="makeCompost()">Fazer Adubo (1üå∏ + 1üåø + 2üí©)</button>
                </div>
                <div id="compost-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>





            <div class="panel" id="drying-panel" style="display: none;">
                <h3>‚òÄÔ∏è Secador de Grama</h3>
                <div style="margin-bottom: 15px;">
                    <div>üåø Gramas frescas: <span id="fresh-grass">0</span></div>
                    <div>üåæ Gramas secas: <span id="dried-grass">0</span></div>
                    <div>üü® Feno: <span id="hay-count">0</span></div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="grass-amount">Quantidade para secar (4-8):</label>
                    <input type="number" id="grass-amount" min="4" max="8" value="4" style="width: 60px; margin-left: 10px;">
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="startDrying()">Secar Grama</button>
                    <button class="action-btn" onclick="makeHay()">Fazer Feno (4 gramas secas)</button>
                </div>
                <div id="drying-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="mixer-panel" style="display: none;">
                <h3>ü•£ Misturador de Ra√ß√£o</h3>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receitas (10 segundos cada):</strong><br>
                    üêî Galinha: 2 milhos + 1 trigo = 4 por√ß√µes<br>
                    üê∑ Porco: 1 tomate + 1 batata + 1 milho + 1 alface = 4 por√ß√µes<br><br>
                    <em>üì¶ Todas as ra√ß√µes s√£o armazenadas no Celeiro</em>
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="makeChickenFeed()">Fazer Ra√ß√£o de Galinha</button>
                    <button class="action-btn" onclick="makePigFeed()">Fazer Ra√ß√£o de Porco</button>
                </div>
                <div id="mixer-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>



            <div class="panel" id="cheese-panel" style="display: none;">
                <h3>üßÄ Queijaria</h3>
                <div style="margin-bottom: 15px;">
                    <div>ü•õ Leite dispon√≠vel: <span id="milk-for-cheese">0</span></div>
                    <div>üßÄ Queijos prontos: <span id="cheese-ready">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receita:</strong><br>
                    üßÄ Queijo: 2 leites = 1 queijo (5 minutos)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="makeCheese()">Fazer Queijo</button>
                </div>
                <div id="cheese-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="wood-panel" style="display: none;">
                <h3>ü™® Cortar Lenha</h3>
                <div style="margin-bottom: 15px;">
                    <div>ü™µ Troncos: <span id="logs-inventory">0</span></div>
                    <div>ü™® Lenha: <span id="firewood-count">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Processo:</strong><br>
                    ü™® Lenha: 1 tronco = 4 lenhas (10 segundos)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="refineWood()">Cortar Lenha</button>
                </div>
                <div id="wood-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="roaster-panel" style="display: none;">
                <h3>‚òï Torradeira de Caf√©</h3>
                <div style="margin-bottom: 15px;">
                    <div>üî¥ Gr√£os de caf√©: <span id="coffee-beans">0</span></div>
                    <div>‚òï Caf√© torrado: <span id="coffee-roasted">0</span></div>
                    <div>ü™® Lenha dispon√≠vel: <span id="firewood-for-roaster">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receita:</strong><br>
                    ‚òï Caf√© torrado: 4 gr√£os + 3 lenhas = 2 pacotes (1 minuto)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="roastCoffee()">Torrar Caf√©</button>
                </div>
                <div id="roaster-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="spinning-panel" style="display: none;">
                <h3>üßµ M√°quina de Fiar</h3>
                <div style="margin-bottom: 15px;">
                    <div>üß∂ L√£ dispon√≠vel: <span id="wool-for-spinning">0</span></div>
                    <div>üßµ Novelos prontos: <span id="yarn-count">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receita:</strong><br>
                    üßµ Novelo: 4 l√£s = 2 novelos (30 segundos)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="spinWool()">Fiar L√£</button>
                </div>
                <div id="spinning-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="mill-panel" style="display: none;">
                <h3>üè≠ Moinho de Trigo</h3>
                <div style="margin-bottom: 15px;">
                    <div>üåæ Trigo dispon√≠vel: <span id="wheat-for-mill">0</span></div>
                    <div>üçö Farinha pronta: <span id="flour-ready">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receita:</strong><br>
                    üçö Farinha: 4 trigos = 2 pacotes (1 minuto)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="millWheat()">Moer Trigo</button>
                </div>
                <div id="mill-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="juice-panel" style="display: none;">
                <h3>üçá M√°quina de Suco</h3>
                <div style="margin-bottom: 15px;">
                    <div>üçá Uvas dispon√≠veis: <span id="grapes-for-juice">0</span></div>
                    <div>üç∑ Suco pronto: <span id="juice-ready">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receita:</strong><br>
                    üç∑ Suco de Uva: 4 uvas = 2 garrafas (20 segundos)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="makeGrapeJuice()">Fazer Suco</button>
                </div>
                <div id="juice-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>

            <div class="panel" id="stove-panel" style="display: none;">
                <h3>üî• Fog√£o e Forno a Lenha</h3>
                <div style="margin-bottom: 15px;">
                    <div>ü™® Lenha dispon√≠vel: <span id="firewood-for-stove">0</span></div>
                    <div>üçû P√£es prontos: <span id="bread-ready">0</span></div>
                </div>
                <div style="margin-bottom: 15px; font-size: 0.9rem; color: #2F4F4F;">
                    <strong>Receitas do Fog√£o (2 lenhas):</strong><br>
                    ü•ó Salada: 1 ovo + 1 br√≥colis + 1 alface = +50% energia (30s)<br>
                    üç≤ Ensopado: 1 tomate + 1 batata + 1 ab√≥bora = +65% energia (30s)<br>
                    ü•© Bife: 1 carne su√≠na = +100% energia (30s)<br><br>
                    <strong>Receitas do Forno (3 lenhas):</strong><br>
                    üçû P√£o: 1 ovo + 1 leite + 1 farinha = 1 p√£o (3 min)<br>
                    üêü Peixe Assado: 1 peixe = +80% energia (30s)
                </div>
                <div class="actions">
                    <button class="action-btn" onclick="cookSalad()">ü•ó Cozinhar Salada</button>
                    <button class="action-btn" onclick="cookStew()">üç≤ Cozinhar Ensopado</button>
                    <button class="action-btn" onclick="cookSteak()">ü•© Cozinhar Bife</button>
                    <button class="action-btn" onclick="bakeBread()">üçû Assar P√£o</button>
                    <button class="action-btn" onclick="bakeFish()">üêü Assar Peixe</button>
                </div>
                <div id="stove-status" style="margin-top: 10px; text-align: center; color: #2F4F4F;"></div>
            </div>


        </div>
    </div>

    <div class="weather-indicator" id="weather-indicator"></div>
    <div class="rain-drops" id="rain-drops"></div>

    <script>
        // Estado do jogo
        let gameState = {
            money: 200,
            water: 10,
            selectedSeed: null,
            selectedPlot: null,
            inventory: {},
            isRaining: false,
            currentSeason: 0,
            fertilizer: 50,
            energy: 100,
            rainTimer: 900, // 15 minutos para pr√≥xima chuva (900 segundos)
            updateTimer: 600, // 10 minutos para updates (600 segundos)
            hasCompost: false,
            hasWell: false,
            hasGrassField: false,
            hasDryer: false,
            hasPasture: false,
            hasSheepPen: false,
            hasMixer: false,
            hasChickenCoop: false,
            hasPigPen: false,
            hasCheeseMaker: false,
            hasAxe: false,
            hasWoodCutter: false,
            axeUses: 0,
            logs: 0,
            firewood: 0,
            isRefiningWood: false,
            woodTimer: null,
            hasRoaster: false,
            isRoasting: false,
            roastingTimer: null,
            hasSpinningMachine: false,
            isSpinning: false,
            spinningTimer: null,
            yarnCount: 0,
            hasMill: false,
            isMilling: false,
            millingTimer: null,
            hasBeehive: false,
            honeyAvailable: 0,
            canCollectHoney: false,
            hasJuiceMaker: false,
            isMakingJuice: false,
            juiceTimer: null,
            hasStove: false,
            isCooking: false,
            cookingTimer: null,
            isBaking: false,
            bakingTimer: null,
            breadReady: 0,
            hasGreenhouse: false,
            greenhousePlots: Array(12).fill(null).map(() => ({
                fertilized: false,
                planted: false,
                watered: false,
                seedType: null,
                growthProgress: 0,
                readyToHarvest: false,
                growthTimer: null
            })),
            hasFishingLake: false,
            hasFishingRod: false,
            fishingRodUses: 0,
            fishAvailable: 4,
            fishCaught: 0,
            isFishing: false,
            fishingTimer: null,
            totalFishCaught: 0, // Total de peixes pescados para contar p√©rolas
            pearls: 0, // P√©rolas para vender
            hasBosque: false,
            branchesCollected: 0,
            logsCollectedCount: 0,
            horse: {
                fed: false,
                friendship: 0,
                canRide: false,
                fedToday: false,
                hasWinterClothing: false
            },
            apples: 0,
            canCollectApples: true,
            bananas: 0,
            canCollectBananas: true,
            oranges: 0,
            canCollectOranges: true,
            canCollectLogs: true,
            hasDog: false,
            hasHorse: false,
            dog: {
                fed: false,
                fedToday: false,
                hasFoundTreasure: false,
                treasureReady: false,
                currentTreasure: null,
                treasureTimer: null,
                friendship: 0
            },
            dogFood: 0,
            dogBones: 0,
            treasures: {
                cd: 0,
                bottle: 0,
                shoe: 0,
                ball: 0
            },
            treasuresFoundToday: 0,
            hasOrderPanel: false,
            orders: [],
            completedOrders: 0,
            orderTimer: null,
            bonfire: {
                lit: false,
                timeLeft: 0,
                timer: null
            },
            hasMine: false,
            hasPickaxe: false,
            pickaxeUses: 0,
            coal: 0,
            gems: {
                ruby: 0,
                emerald: 0,
                sapphire: 0
            },
            rocks: [
                { hits: 0, maxHits: 3, lastResetTime: 0, canMine: true },
                { hits: 0, maxHits: 3, lastResetTime: 0, canMine: true },
                { hits: 0, maxHits: 3, lastResetTime: 0, canMine: true }
            ],
            cows: [],
            chickens: [],
            chicks: [],
            pigs: [],
            sheep: [],
            feed: { chicken: 0, pig: 0 }, // Armazenado no celeiro
            breedingTimer: null,
            isMakingChickenFeed: false,
            chickenFeedTimer: null,
            isMakingPigFeed: false,
            pigFeedTimer: null,
            cheeseReady: 0,
            isMakingCheese: false,
            cheeseTimer: null,
            compostMaterials: { flowers: 0, branches: 0, manure: 0 },
            isComposting: false,
            compostTimer: null,
            grassCollected: 0,
            freshGrass: 0,
            driedGrass: 0,
            hay: 0,
            isDrying: false,
            dryingTimer: null,
            grassField: Array(24).fill(null).map(() => ({
                hasGrass: true,
                regenerating: false,
                regenerationTimer: null
            })),
            products: {
                milk: 0,
                eggs: 0,
                coffee: 0,
                wool: 0,
                flour: 0,
                honey: 0,
                meat: 0,
                juice: 0,
                cheese: 0,
                yarn: 0,
                bread: 0,
                rawChicken: 0,
                fish: 0
            },
            vaccines: 0, // Vacinas armazenadas no celeiro
            lastSickAnimal: null, // Controla qual animal ficou doente por √∫ltimo
            food: {
                salad: 0,
                stew: 0
            },
            plots: Array(8).fill(null).map(() => ({
                fertilized: false,
                planted: false,
                watered: false,
                seedType: null,
                growthProgress: 0,
                readyToHarvest: false,
                growthTimer: null
            })),
            maxPlots: 8,
            isResting: false,
            lastUpdateTime: Date.now() // Para controlar intervalos de 10 minutos
        };

        // Dados das sementes
        const seeds = [
            { name: 'Batata', emoji: 'ü•î', price: 10, sellPrice: 25 },
            { name: 'Tomate', emoji: 'üçÖ', price: 10, sellPrice: 30 },
            { name: 'Cenoura', emoji: 'ü•ï', price: 10, sellPrice: 20 },
            { name: 'Milho', emoji: 'üåΩ', price: 10, sellPrice: 35 },
            { name: 'Trigo', emoji: 'üåæ', price: 10, sellPrice: 15 },
            { name: 'Caf√©', emoji: 'üî¥', price: 10, sellPrice: 50 },
            { name: 'Ab√≥bora', emoji: 'üéÉ', price: 10, sellPrice: 40 },
            { name: 'Br√≥colis', emoji: 'ü•¶', price: 10, sellPrice: 25 },
            { name: 'Alface', emoji: 'ü•¨', price: 10, sellPrice: 20 },
            { name: 'Uva', emoji: 'üçá', price: 10, sellPrice: 45 }
        ];

        const seasons = ['üå∏ Primavera', '‚òÄÔ∏è Ver√£o', 'üçÇ Outono', '‚ùÑÔ∏è Inverno'];

        // Pre√ßos dos produtos
        const productPrices = {
            milk: 15,
            eggs: 12,
            coffee: 25,
            wool: 30,
            flour: 20,
            honey: 35,
            meat: 50,
            juice: 40,
            cheese: 60,
            yarn: 45,
            bread: 35,
            rawChicken: 80,
            fish: 30
        };

        // Sistema de salvamento autom√°tico
        function saveGame() {
            try {
                const saveData = JSON.stringify(gameState);
                localStorage.setItem('realFarmSave', saveData);
                console.log('Jogo salvo automaticamente!');
            } catch (error) {
                console.error('Erro ao salvar o jogo:', error);
            }
        }

        // Salvamento manual pelo jogador
        function manualSave() {
            try {
                const saveData = JSON.stringify(gameState);
                localStorage.setItem('realFarmSave', saveData);
                
                // Feedback visual para o jogador
                const saveButton = event.target;
                const originalText = saveButton.innerHTML;
                saveButton.innerHTML = '‚úÖ Salvo!';
                saveButton.style.background = '#228B22';
                
                setTimeout(() => {
                    saveButton.innerHTML = originalText;
                    saveButton.style.background = '#32CD32';
                }, 2000);
                
                alert('üíæ Jogo salvo com sucesso!');
            } catch (error) {
                console.error('Erro ao salvar o jogo:', error);
                alert('‚ùå Erro ao salvar o jogo. Tente novamente.');
            }
        }

        // Carregar jogo salvo
        function loadGame() {
            try {
                const saveData = localStorage.getItem('realFarmSave');
                if (saveData) {
                    const loadedState = JSON.parse(saveData);
                    
                    // Mesclar dados salvos com estado atual (para compatibilidade)
                    Object.keys(loadedState).forEach(key => {
                        if (gameState.hasOwnProperty(key)) {
                            gameState[key] = loadedState[key];
                        }
                    });
                    
                    console.log('Jogo carregado com sucesso!');
                    return true;
                }
            } catch (error) {
                console.error('Erro ao carregar o jogo:', error);
            }
            return false;
        }

        // Inicializar o jogo
        function initGame() {
            // Tentar carregar jogo salvo primeiro
            const gameLoaded = loadGame();
            
            createPlots();
            createSeedsGrid();
            spawnFish(); // Criar peixes no lago
            
            // Se carregou um jogo salvo, recriar elementos dos animais
            if (gameLoaded) {
                // Recriar vacas
                gameState.cows.forEach((cow, index) => {
                    createCowElement(index);
                    updateCowDisplay(index);
                });
                
                // Recriar galinhas
                gameState.chickens.forEach((chicken, index) => {
                    createChickenElement(index);
                    updateChickenDisplay(index);
                });
                
                // Recriar pintinhos
                gameState.chicks.forEach((chick, index) => {
                    createChickElement(index);
                });
                
                // Recriar porcos
                gameState.pigs.forEach((pig, index) => {
                    createPigElement(index);
                    updatePigDisplay(index);
                });
                
                // Recriar ovelhas
                gameState.sheep.forEach((sheep, index) => {
                    createSheepElement(index);
                    updateSheepDisplay(index);
                });
                
                // Mostrar √°reas compradas
                if (gameState.hasWell) document.getElementById('well-panel').style.display = 'block';
                if (gameState.hasCompost) document.getElementById('compost-panel').style.display = 'block';
                if (gameState.hasGrassField) {
                    document.getElementById('grass-field-area').style.display = 'block';
                    createGrassField();
                }
                if (gameState.hasDryer) document.getElementById('drying-panel').style.display = 'block';
                if (gameState.hasPasture) document.getElementById('pasture-area').style.display = 'block';
                if (gameState.hasSheepPen) document.getElementById('sheep-area').style.display = 'block';
                if (gameState.hasMixer) {
                    document.getElementById('mixer-panel').style.display = 'block';
                }
                if (gameState.hasChickenCoop) {
                    document.getElementById('chickens-area').style.display = 'block';
                    document.getElementById('buy-chicken-coop-btn').style.display = 'none';
                    document.getElementById('buy-chicken-btn').style.display = 'block';
                }
                if (gameState.hasPigPen) {
                    document.getElementById('pigs-area').style.display = 'block';
                    document.getElementById('buy-pig-pen-btn').style.display = 'none';
                    document.getElementById('buy-pig-btn').style.display = 'block';
                }
                if (gameState.hasCheeseMaker) document.getElementById('cheese-panel').style.display = 'block';
                if (gameState.hasWoodCutter) document.getElementById('wood-panel').style.display = 'block';
                if (gameState.hasRoaster) document.getElementById('roaster-panel').style.display = 'block';
                if (gameState.hasSpinningMachine) document.getElementById('spinning-panel').style.display = 'block';
                if (gameState.hasMill) document.getElementById('mill-panel').style.display = 'block';
                if (gameState.hasBeehive) document.getElementById('beehive-area').style.display = 'block';
                if (gameState.hasJuiceMaker) document.getElementById('juice-panel').style.display = 'block';
                if (gameState.hasStove) document.getElementById('stove-panel').style.display = 'block';
                if (gameState.hasBosque) document.getElementById('tree-area').style.display = 'block';
                if (gameState.hasGreenhouse) {
                    createGreenhousePlots();
                    // Visibilidade ser√° controlada por updateSeasonalVisibility()
                }
                if (gameState.hasFishingLake) {
                    document.getElementById('fishing-lake').style.display = 'block';
                    document.getElementById('buy-fishing-lake-btn').style.display = 'none';
                    document.getElementById('buy-fishing-rod-btn').style.display = gameState.hasFishingRod ? 'none' : 'block';
                }
                if (gameState.hasDog) document.getElementById('dog-area').style.display = 'block';
                if (gameState.hasHorse) {
                    document.getElementById('horse-stable').style.display = 'block';
                    document.getElementById('buy-order-panel-btn').style.display = 'block';
                }
                if (gameState.hasOrderPanel) {
                    document.getElementById('order-panel').style.display = 'block';
                    // Recriar pedidos ativos
                    gameState.orders.forEach(order => {
                        createOrderElement(order);
                        startOrderTimer(order.id);
                    });
                }
                if (gameState.hasMine) {
                    document.getElementById('mine-area').style.display = 'block';
                    updateMineDisplay();
                }
                if (gameState.hasPickaxe) {
                    document.getElementById('buy-pickaxe-btn').style.display = 'none';
                    document.getElementById('buy-mine-btn').style.display = gameState.hasMine ? 'none' : 'block';
                }
                
                // Aplicar classe da esta√ß√£o atual
                document.body.classList.add(`season-${gameState.currentSeason}`);
                document.getElementById('season-display').textContent = seasons[gameState.currentSeason];
                
                // Aplicar classe noturna se necess√°rio
                if (gameState.isNight) {
                    document.body.classList.add('night');
                    document.getElementById('day-night').textContent = 'Noite';
                } else {
                    document.getElementById('day-night').textContent = 'Dia';
                }
                
                alert('üéÆ Jogo carregado com sucesso! Bem-vindo de volta √† sua fazenda!');
            }
            
            updateDisplay();
            updateSeasonalVisibility(); // Aplicar visibilidade inicial
            startGameTimer();
            startWeatherSystem();
            startSeasonCycle();
        }

        // Criar canteiros
        function createPlots() {
            const plotsGrid = document.getElementById('plots-grid');
            plotsGrid.innerHTML = '';
            
            // Calcular colunas baseado no n√∫mero de canteiros
            const columns = Math.min(8, Math.ceil(Math.sqrt(gameState.maxPlots)));
            plotsGrid.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
            
            for (let i = 0; i < gameState.maxPlots; i++) {
                const plot = document.createElement('div');
                plot.className = 'plot';
                plot.onclick = () => selectPlot(i);
                plot.innerHTML = `
                    <div class="plot-content" id="plot-content-${i}">üå±</div>
                    <div class="plot-status" id="plot-status-${i}">Vazio</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-${i}"></div>
                    </div>
                `;
                plotsGrid.appendChild(plot);
            }
        }

        // Criar canteiros da estufa
        function createGreenhousePlots() {
            const greenhouseGrid = document.getElementById('greenhouse-grid');
            greenhouseGrid.innerHTML = '';
            
            for (let i = 0; i < 12; i++) {
                const plot = document.createElement('div');
                plot.className = 'plot';
                plot.style.width = '80px';
                plot.style.height = '80px';
                plot.onclick = () => selectGreenhousePlot(i);
                plot.innerHTML = `
                    <div class="plot-content" id="greenhouse-content-${i}">üå±</div>
                    <div class="plot-status" id="greenhouse-status-${i}">Vazio</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="greenhouse-progress-${i}"></div>
                    </div>
                `;
                greenhouseGrid.appendChild(plot);
            }
        }

        // Criar grid de sementes
        function createSeedsGrid() {
            const seedsGrid = document.getElementById('seeds-grid');
            seedsGrid.innerHTML = '';
            
            seeds.forEach((seed, index) => {
                const seedItem = document.createElement('div');
                seedItem.className = 'seed-item';
                seedItem.onclick = () => selectSeed(index);
                seedItem.innerHTML = `
                    <span class="seed-emoji">${seed.emoji}</span>
                    <div class="seed-name">${seed.name}</div>
                    <div style="font-size: 0.7rem; color: #666;">10 moedas</div>
                `;
                seedsGrid.appendChild(seedItem);
            });
        }

        // Selecionar semente (agora ilimitada)
        function selectSeed(index) {
            gameState.selectedSeed = index;
            
            // Destacar semente selecionada
            document.querySelectorAll('.seed-item').forEach((item, i) => {
                item.classList.toggle('selected', i === index);
            });
            
            alert(`${seeds[index].name} selecionada! Clique nos canteiros para plantar (10 moedas por semente).`);
            updateDisplay();
            showTutorial('select-seed');
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Selecionar canteiro e executar a√ß√£o
        function selectPlot(index) {
            
            gameState.selectedPlot = index;
            document.querySelectorAll('.plot').forEach((plot, i) => {
                plot.style.border = i === index ? '3px solid #FFD700' : '3px solid #654321';
            });
            
            const plot = gameState.plots[index];
            
            // Executar a√ß√£o apropriada baseada no estado do canteiro
            if (plot.readyToHarvest) {
                harvestPlot();
            } else if (plot.planted && !plot.watered) {
                waterPlot();
            } else if (plot.fertilized && !plot.planted) {
                plantSeed();
            } else if (!plot.fertilized) {
                fertilizePlot();
            }
        }

        // Comprar po√ßo
        function buyWell() {
            if (gameState.hasWell) {
                alert('Voc√™ j√° tem um po√ßo!');
                return;
            }
            
            if (gameState.money < 50) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 50;
            gameState.hasWell = true;
            document.getElementById('well-panel').style.display = 'block';
            document.getElementById('buy-well-btn').style.display = 'none';
            updateDisplay();
            alert('Po√ßo comprado! Agora voc√™ pode coletar √°gua.');
            showTutorial('welcome');
        }

        // Comprar composteira
        function buyCompost() {
            if (gameState.hasCompost) {
                alert('Voc√™ j√° tem uma composteira!');
                return;
            }
            
            if (gameState.money < 100) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 100;
            gameState.hasCompost = true;
            document.getElementById('compost-panel').style.display = 'block';
            document.getElementById('buy-compost-btn').style.display = 'none';
            updateDisplay();
            alert('Composteira comprada! Agora voc√™ pode fazer adubo.');
            showTutorial('buy-compost');
        }

        // Comprar campo de grama
        function buyGrassField() {
            if (gameState.hasGrassField) {
                alert('Voc√™ j√° tem um campo de grama!');
                return;
            }
            
            if (gameState.money < 150) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 150;
            gameState.hasGrassField = true;
            document.getElementById('grass-field-area').style.display = 'block';
            document.getElementById('buy-grass-btn').style.display = 'none';
            createGrassField();
            updateDisplay();
            alert('Campo de grama comprado! Colete grama para ganhar flores.');
            showTutorial('buy-grass-field');
        }

        // Comprar pasto
        function buyPasture() {
            if (gameState.hasPasture) {
                alert('Voc√™ j√° tem um pasto!');
                return;
            }
            
            if (gameState.money < 200) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 200;
            gameState.hasPasture = true;
            document.getElementById('pasture-area').style.display = 'block';
            document.getElementById('buy-pasture-btn').style.display = 'none';
            document.getElementById('buy-cow-btn').style.display = 'block';
            updateDisplay();
            alert('Pasto comprado! Agora voc√™ pode comprar vacas leiteiras.');
            showTutorial('buy-pasture');
        }

        // Comprar curral de ovelhas
        function buySheepPen() {
            if (gameState.hasSheepPen) {
                alert('Voc√™ j√° tem um curral de ovelhas!');
                return;
            }
            
            if (gameState.money < 180) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 180;
            gameState.hasSheepPen = true;
            document.getElementById('sheep-area').style.display = 'block';
            document.getElementById('buy-sheep-pen-btn').style.display = 'none';
            document.getElementById('buy-sheep-btn').style.display = 'block';
            updateDisplay();
            alert('Curral de ovelhas comprado! Agora voc√™ pode comprar ovelhas.');
        }

        // Comprar secador
        function buyDryer() {
            if (gameState.hasDryer) {
                alert('Voc√™ j√° tem um secador!');
                return;
            }
            
            if (gameState.money < 80) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 80;
            gameState.hasDryer = true;
            document.getElementById('drying-panel').style.display = 'block';
            document.getElementById('buy-dryer-btn').style.display = 'none';
            updateDisplay();
            alert('Secador de grama comprado! Agora voc√™ pode secar grama e fazer feno.');
            showTutorial('buy-dryer');
        }

        // Comprar misturador
        function buyMixer() {
            if (gameState.hasMixer) {
                alert('Voc√™ j√° tem um misturador!');
                return;
            }
            
            if (gameState.money < 120) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 120;
            gameState.hasMixer = true;
            document.getElementById('mixer-panel').style.display = 'block';
            document.getElementById('buy-mixer-btn').style.display = 'none';
            updateDisplay();
            alert('Misturador comprado! Agora voc√™ pode fazer ra√ß√£o para os animais.');
        }

        // Comprar galinheiro
        function buyChickenCoop() {
            if (gameState.hasChickenCoop) {
                alert('Voc√™ j√° tem um galinheiro!');
                return;
            }
            
            if (!gameState.hasMixer) {
                alert('Voc√™ precisa comprar o misturador primeiro para fazer ra√ß√£o!');
                return;
            }
            
            if (gameState.money < 150) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 150;
            gameState.hasChickenCoop = true;
            document.getElementById('chickens-area').style.display = 'block';
            document.getElementById('buy-chicken-coop-btn').style.display = 'none';
            document.getElementById('buy-chicken-btn').style.display = 'block';
            updateDisplay();
            alert('Galinheiro comprado! Agora voc√™ pode comprar galinhas.');
        }

        // Comprar chiqueiro
        function buyPigPen() {
            if (gameState.hasPigPen) {
                alert('Voc√™ j√° tem um chiqueiro!');
                return;
            }
            
            if (!gameState.hasMixer) {
                alert('Voc√™ precisa comprar o misturador primeiro para fazer ra√ß√£o!');
                return;
            }
            
            if (gameState.money < 120) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 120;
            gameState.hasPigPen = true;
            document.getElementById('pigs-area').style.display = 'block';
            document.getElementById('buy-pig-pen-btn').style.display = 'none';
            document.getElementById('buy-pig-btn').style.display = 'block';
            updateDisplay();
            alert('Chiqueiro comprado! Agora voc√™ pode comprar porcos.');
        }

        // Comprar queijaria
        function buyCheeseMaker() {
            if (gameState.hasCheeseMaker) {
                alert('Voc√™ j√° tem uma queijaria!');
                return;
            }
            
            if (gameState.money < 90) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 90;
            gameState.hasCheeseMaker = true;
            document.getElementById('cheese-panel').style.display = 'block';
            document.getElementById('buy-cheese-btn').style.display = 'none';
            updateDisplay();
            alert('Queijaria comprada! Agora voc√™ pode fazer queijo com leite (2 leites = 1 queijo).');
        }

        // Comprar machado (agora inclui cortador de lenha)
        function buyAxe() {
            if (gameState.hasAxe) {
                alert('Voc√™ j√° tem um machado!');
                return;
            }
            
            if (gameState.money < 40) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 40;
            gameState.hasAxe = true;
            gameState.hasWoodCutter = true; // Agora vem junto
            document.getElementById('buy-axe-btn').style.display = 'none';
            document.getElementById('wood-panel').style.display = 'block'; // Mostrar painel de cortar lenha
            updateDisplay();
            alert('Machado comprado! Agora voc√™ pode coletar troncos da √°rvore e cortar lenha!');
            showTutorial('buy-axe');
        }

        // Fun√ß√£o mantida para compatibilidade (n√£o ser√° mais usada)
        function buyWoodCutter() {
            alert('O cortador de lenha agora vem junto com o machado!');
        }

        // Comprar torradeira
        function buyRoaster() {
            if (gameState.hasRoaster) {
                alert('Voc√™ j√° tem uma torradeira!');
                return;
            }
            
            if (gameState.money < 60) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 60;
            gameState.hasRoaster = true;
            document.getElementById('roaster-panel').style.display = 'block';
            document.getElementById('buy-roaster-btn').style.display = 'none';
            updateDisplay();
            alert('Torradeira comprada! Agora voc√™ pode torrar caf√© (4 gr√£os + 3 lenhas = 2 pacotes).');
        }

        // Comprar m√°quina de fiar
        function buySpinningMachine() {
            if (gameState.hasSpinningMachine) {
                alert('Voc√™ j√° tem uma m√°quina de fiar!');
                return;
            }
            
            if (gameState.money < 70) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 70;
            gameState.hasSpinningMachine = true;
            document.getElementById('spinning-panel').style.display = 'block';
            document.getElementById('buy-spinning-btn').style.display = 'none';
            updateDisplay();
            alert('M√°quina de fiar comprada! Agora voc√™ pode transformar l√£ em novelos (4 l√£s = 2 novelos).');
        }

        // Comprar moinho
        function buyMill() {
            if (gameState.hasMill) {
                alert('Voc√™ j√° tem um moinho!');
                return;
            }
            
            if (gameState.money < 85) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 85;
            gameState.hasMill = true;
            document.getElementById('mill-panel').style.display = 'block';
            document.getElementById('buy-mill-btn').style.display = 'none';
            updateDisplay();
            alert('Moinho comprado! Agora voc√™ pode moer trigo em farinha (4 trigos = 2 farinhas).');
        }

        // Comprar colmeia
        function buyBeehive() {
            if (gameState.hasBeehive) {
                alert('Voc√™ j√° tem uma colmeia!');
                return;
            }
            
            if (gameState.money < 120) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 120;
            gameState.hasBeehive = true;
            document.getElementById('beehive-area').style.display = 'block';
            document.getElementById('buy-beehive-btn').style.display = 'none';
            updateDisplay();
            alert('Colmeia comprada! As abelhas produzem 2 potes de mel a cada 20 minutos.');
        }

        // Comprar m√°quina de suco
        function buyJuiceMaker() {
            if (gameState.hasJuiceMaker) {
                alert('Voc√™ j√° tem uma m√°quina de suco!');
                return;
            }
            
            if (gameState.money < 75) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 75;
            gameState.hasJuiceMaker = true;
            document.getElementById('juice-panel').style.display = 'block';
            document.getElementById('buy-juice-btn').style.display = 'none';
            updateDisplay();
            alert('M√°quina de suco comprada! Agora voc√™ pode fazer suco de uva (4 uvas = 2 garrafas).');
        }

        // Comprar fog√£o a lenha
        function buyStove() {
            if (gameState.hasStove) {
                alert('Voc√™ j√° tem um fog√£o!');
                return;
            }
            
            if (gameState.money < 150) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 150;
            gameState.hasStove = true;
            document.getElementById('stove-panel').style.display = 'block';
            document.getElementById('buy-stove-btn').style.display = 'none';
            updateDisplay();
            alert('Fog√£o a lenha comprado! Agora voc√™ pode cozinhar refei√ß√µes para recuperar energia e assar p√£o!');
        }

        // Comprar bosque
        function buyBosque() {
            if (gameState.hasBosque) {
                alert('Voc√™ j√° tem um bosque!');
                return;
            }
            
            if (gameState.money < 300) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 300;
            gameState.hasBosque = true;
            gameState.branchesCollected = 0;
            document.getElementById('tree-area').style.display = 'block';
            document.getElementById('buy-bosque-btn').style.display = 'none';
            updateDisplay();
            alert('Bosque comprado! Agora voc√™ pode coletar troncos, frutas e galhos para a composteira!');
            showTutorial('buy-bosque');
        }

        // Comprar mais canteiros
        function buyPlots() {
            if (gameState.maxPlots >= 40) {
                alert('Voc√™ j√° tem o m√°ximo de canteiros (40)!');
                return;
            }
            
            if (gameState.money < 200) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 200;
            gameState.maxPlots += 8;
            
            // Adicionar novos canteiros ao array
            for (let i = 0; i < 8; i++) {
                gameState.plots.push({
                    fertilized: false,
                    planted: false,
                    watered: false,
                    seedType: null,
                    growthProgress: 0,
                    readyToHarvest: false,
                    growthTimer: null
                });
            }
            
            // Recriar grid de canteiros
            createPlots();
            
            // Esconder bot√£o se chegou ao m√°ximo
            if (gameState.maxPlots >= 40) {
                document.getElementById('buy-plots-btn').style.display = 'none';
            }
            
            updateDisplay();
            alert(`+8 canteiros comprados! Agora voc√™ tem ${gameState.maxPlots} canteiros.`);
        }

        // Comprar estufa
        function buyGreenhouse() {
            if (gameState.hasGreenhouse) {
                alert('Voc√™ j√° tem uma estufa!');
                return;
            }
            
            if (gameState.currentSeason !== 3) { // S√≥ pode comprar no inverno
                alert('‚ùÑÔ∏è A estufa s√≥ pode ser comprada durante o inverno! Aguarde a esta√ß√£o fria chegar.');
                return;
            }
            
            if (gameState.money < 800) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 800;
            gameState.hasGreenhouse = true;
            document.getElementById('greenhouse-area').style.display = 'block';
            document.getElementById('buy-greenhouse-btn').style.display = 'none';
            createGreenhousePlots();
            updateDisplay();
            alert('‚ùÑÔ∏è Estufa comprada! Agora voc√™ pode plantar no inverno usando os 12 canteiros protegidos. A estufa permanecer√° dispon√≠vel para sempre, mas s√≥ funciona no inverno.');
        }

        // Comprar lago dos peixes
        function buyFishingLake() {
            if (gameState.hasFishingLake) {
                alert('Voc√™ j√° tem o lago dos peixes!');
                return;
            }
            
            if (gameState.money < 250) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 250;
            gameState.hasFishingLake = true;
            document.getElementById('fishing-lake').style.display = 'block';
            document.getElementById('buy-fishing-lake-btn').style.display = 'none';
            document.getElementById('buy-fishing-rod-btn').style.display = 'block';
            spawnFish(); // Criar peixes no lago
            updateDisplay();
            alert('Lago dos Peixes comprado! Agora voc√™ pode comprar uma vara de pesca para pescar.');
        }

        // Comprar vara de pesca
        function buyFishingRod() {
            if (!gameState.hasFishingLake) {
                alert('Voc√™ precisa comprar o Lago dos Peixes primeiro!');
                return;
            }
            
            if (gameState.hasFishingRod) {
                alert('Voc√™ j√° tem uma vara de pesca!');
                return;
            }
            
            if (gameState.money < 60) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 60;
            gameState.hasFishingRod = true;
            gameState.fishingRodUses = 0;
            document.getElementById('buy-fishing-rod-btn').style.display = 'none';
            updateDisplay();
            alert('Vara de pesca comprada! Agora voc√™ pode pescar no lago (4 peixes por dia, 3s cada).');
        }

        // Sistema de peixes interativos
        let fishInLake = [];

        // Criar peixes no lago
        function spawnFish() {
            const fishContainer = document.getElementById('fish-container');
            if (!fishContainer) return;
            
            fishContainer.innerHTML = '';
            fishInLake = [];
            
            const fishTypes = ['üêü', 'üê†', 'üê°', 'ü¶à'];
            const swimPatterns = ['swimming1', 'swimming2', 'swimming3'];
            
            for (let i = 0; i < gameState.fishAvailable; i++) {
                const fish = document.createElement('div');
                const fishType = fishTypes[Math.floor(Math.random() * fishTypes.length)];
                const swimPattern = swimPatterns[Math.floor(Math.random() * swimPatterns.length)];
                
                fish.className = `fish ${swimPattern}`;
                fish.textContent = fishType;
                fish.id = `fish-${i}`;
                
                // Posi√ß√£o inicial aleat√≥ria
                const x = Math.random() * 250 + 25; // 25px de margem
                const y = Math.random() * 150 + 25; // 25px de margem
                
                fish.style.left = x + 'px';
                fish.style.top = y + 'px';
                
                // Adicionar delay aleat√≥rio na anima√ß√£o
                fish.style.animationDelay = Math.random() * 2 + 's';
                
                fish.onclick = () => catchSpecificFish(i, fish);
                
                fishContainer.appendChild(fish);
                fishInLake.push({
                    id: i,
                    element: fish,
                    type: fishType,
                    caught: false
                });
            }
        }

        // Pescar peixe espec√≠fico
        function catchSpecificFish(fishId, fishElement) {
            
            if (!gameState.hasFishingLake) {
                alert('Voc√™ precisa comprar o Lago dos Peixes primeiro!');
                return;
            }
            
            if (!gameState.hasFishingRod) {
                alert('Voc√™ precisa comprar uma vara de pesca primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.isFishing) {
                alert('Voc√™ j√° est√° pescando! Aguarde terminar.');
                return;
            }
            
            const fish = fishInLake.find(f => f.id === fishId);
            if (!fish || fish.caught) {
                return;
            }
            
            // Marcar peixe como sendo pescado
            fish.caught = true;
            gameState.isFishing = true;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.fishingRodUses++;
            
            // Criar efeito de ondula√ß√£o
            createRippleEffect(fishElement);
            
            // Anima√ß√£o de captura
            fishElement.classList.add('caught');
            fishElement.style.pointerEvents = 'none';
            
            let timeLeft = 3; // 3 segundos para pescar
            const statusElement = document.getElementById('fishing-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Pescando ${fish.type}... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isFishing = false;
                    gameState.fishAvailable--;
                    gameState.fishCaught++;
                    gameState.totalFishCaught++;
                    gameState.products.fish++;
                    
                    // Verificar se ganhou p√©rola (a cada 6 peixes)
                    let pearlMessage = '';
                    if (gameState.totalFishCaught % 6 === 0) {
                        gameState.pearls++;
                        pearlMessage = '\n\nü¶™ Uma p√©rola foi encontrada! Adicionada √† quitanda para venda!';
                    }
                    
                    // Remover peixe do lago
                    setTimeout(() => {
                        fishElement.remove();
                    }, 500);
                    
                    statusElement.textContent = `${fish.type} pescado!`;
                    clearInterval(gameState.fishingTimer);
                    
                    // Verificar se a vara quebrou
                    if (gameState.fishingRodUses >= 50) {
                        gameState.hasFishingRod = false;
                        gameState.fishingRodUses = 0;
                        document.getElementById('buy-fishing-rod-btn').style.display = 'block';
                        alert(`${fish.type} pescado! +1 peixe${pearlMessage}\n\nSua vara de pesca quebrou! Voc√™ precisa comprar outra.`);
                    } else {
                        alert(`${fish.type} pescado! +1 peixe${pearlMessage}`);
                    }
                    
                    updateDisplay();
                }
            };
            
            updateTimer();
            gameState.fishingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Criar efeito de ondula√ß√£o
        function createRippleEffect(fishElement) {
            const ripple = document.createElement('div');
            ripple.className = 'fishing-ripple';
            
            const rect = fishElement.getBoundingClientRect();
            const lakeRect = document.getElementById('fishing-lake-container').getBoundingClientRect();
            
            const x = rect.left - lakeRect.left + rect.width / 2 - 50;
            const y = rect.top - lakeRect.top + rect.height / 2 - 50;
            
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            
            document.getElementById('fishing-lake-container').appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 1000);
        }

        // Fun√ß√£o antiga mantida para compatibilidade (n√£o ser√° mais usada)
        function catchFish() {
            alert('Clique diretamente nos peixes para pesc√°-los!');
        }

        // Fazer suco de uva
        function makeGrapeJuice() {
            if (!gameState.hasJuiceMaker) {
                alert('Voc√™ precisa comprar a m√°quina de suco primeiro!');
                return;
            }
            
            if (gameState.isMakingJuice) {
                alert('J√° h√° suco sendo feito! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const grapesCount = gameState.inventory[9] || 0; // Uva √© √≠ndice 9
            if (grapesCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 uvas para fazer suco!');
                return;
            }
            
            gameState.inventory[9] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMakingJuice = true;
            
            let timeLeft = 20; // 20 segundos
            const statusElement = document.getElementById('juice-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fazendo suco... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMakingJuice = false;
                    gameState.products.juice += 2;
                    statusElement.textContent = '2 garrafas de suco prontas! üç∑';
                    clearInterval(gameState.juiceTimer);
                    updateDisplay();
                    alert('Suco de uva pronto! +2 garrafas de suco');
                }
            };
            
            updateTimer();
            gameState.juiceTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Cozinhar salada (50% energia)
        function cookSalad() {
            if (!gameState.hasStove) {
                alert('Voc√™ precisa comprar o fog√£o primeiro!');
                return;
            }
            
            if (gameState.isCooking) {
                alert('J√° h√° algo sendo cozinhado! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar ingredientes: 1 ovo + 1 br√≥colis + 1 alface
            if (gameState.products.eggs < 1) {
                alert('Voc√™ precisa de 1 ovo!');
                return;
            }
            
            const broccoliCount = gameState.inventory[7] || 0; // Br√≥colis √© √≠ndice 7
            const lettuceCount = gameState.inventory[8] || 0; // Alface √© √≠ndice 8
            
            if (broccoliCount < 1 || lettuceCount < 1) {
                alert('Voc√™ precisa de 1 br√≥colis e 1 alface!');
                return;
            }
            
            if (gameState.firewood < 2) {
                alert('Voc√™ precisa de 2 lenhas para acender o fog√£o!');
                return;
            }
            
            // Consumir ingredientes
            gameState.products.eggs -= 1;
            gameState.inventory[7] -= 1; // Br√≥colis
            gameState.inventory[8] -= 1; // Alface
            gameState.firewood -= 2;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isCooking = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('stove-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Cozinhando salada... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isCooking = false;
                    gameState.food.salad += 1;
                    statusElement.textContent = 'Salada pronta! Armazenada no celeiro ü•ó';
                    clearInterval(gameState.cookingTimer);
                    updateDisplay();
                    alert('Salada cozinhada! +1 salada armazenada no celeiro (recupera 50% energia)');
                }
            };
            
            updateTimer();
            gameState.cookingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Cozinhar ensopado (65% energia)
        function cookStew() {
            if (!gameState.hasStove) {
                alert('Voc√™ precisa comprar o fog√£o primeiro!');
                return;
            }
            
            if (gameState.isCooking) {
                alert('J√° h√° algo sendo cozinhado! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar ingredientes: 1 tomate + 1 batata + 1 ab√≥bora
            const tomatoCount = gameState.inventory[1] || 0; // Tomate √© √≠ndice 1
            const potatoCount = gameState.inventory[0] || 0; // Batata √© √≠ndice 0
            const pumpkinCount = gameState.inventory[6] || 0; // Ab√≥bora √© √≠ndice 6
            
            if (tomatoCount < 1 || potatoCount < 1 || pumpkinCount < 1) {
                alert('Voc√™ precisa de 1 tomate, 1 batata e 1 ab√≥bora!');
                return;
            }
            
            if (gameState.firewood < 2) {
                alert('Voc√™ precisa de 2 lenhas para acender o fog√£o!');
                return;
            }
            
            // Consumir ingredientes
            gameState.inventory[1] -= 1; // Tomate
            gameState.inventory[0] -= 1; // Batata
            gameState.inventory[6] -= 1; // Ab√≥bora
            gameState.firewood -= 2;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isCooking = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('stove-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Cozinhando ensopado... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isCooking = false;
                    gameState.food.stew += 1;
                    statusElement.textContent = 'Ensopado pronto! Armazenado no celeiro üç≤';
                    clearInterval(gameState.cookingTimer);
                    updateDisplay();
                    alert('Ensopado cozinhado! +1 ensopado armazenado no celeiro (recupera 65% energia)');
                }
            };
            
            updateTimer();
            gameState.cookingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Cozinhar bife (100% energia)
        function cookSteak() {
            if (!gameState.hasStove) {
                alert('Voc√™ precisa comprar o fog√£o primeiro!');
                return;
            }
            
            if (gameState.isCooking) {
                alert('J√° h√° algo sendo cozinhado! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar ingredientes: 1 carne su√≠na
            if (gameState.products.meat < 1) {
                alert('Voc√™ precisa de 1 carne su√≠na!');
                return;
            }
            
            if (gameState.firewood < 2) {
                alert('Voc√™ precisa de 2 lenhas para acender o fog√£o!');
                return;
            }
            
            // Consumir ingredientes
            gameState.products.meat -= 1;
            gameState.firewood -= 2;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isCooking = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('stove-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Cozinhando bife... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isCooking = false;
                    gameState.food.steak = (gameState.food.steak || 0) + 1;
                    statusElement.textContent = 'Bife pronto! Armazenado no celeiro ü•©';
                    clearInterval(gameState.cookingTimer);
                    updateDisplay();
                    alert('Bife cozinhado! +1 bife armazenado no celeiro (recupera 100% energia)');
                }
            };
            
            updateTimer();
            gameState.cookingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Assar p√£o
        function bakeBread() {
            if (!gameState.hasStove) {
                alert('Voc√™ precisa comprar o fog√£o primeiro!');
                return;
            }
            
            if (gameState.isBaking) {
                alert('J√° h√° p√£o sendo assado! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar ingredientes: 1 ovo + 1 leite + 1 farinha
            if (gameState.products.eggs < 1 || gameState.products.milk < 1 || gameState.products.flour < 1) {
                alert('Voc√™ precisa de 1 ovo, 1 leite e 1 farinha!');
                return;
            }
            
            if (gameState.firewood < 3) {
                alert('Voc√™ precisa de 3 lenhas para acender o forno!');
                return;
            }
            
            // Consumir ingredientes
            gameState.products.eggs -= 1;
            gameState.products.milk -= 1;
            gameState.products.flour -= 1;
            gameState.firewood -= 3;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isBaking = true;
            
            let timeLeft = 180; // 3 minutos
            const statusElement = document.getElementById('stove-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Assando p√£o... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isBaking = false;
                    gameState.breadReady += 1;
                    gameState.products.bread += 1;
                    statusElement.textContent = 'P√£o assado! üçû';
                    clearInterval(gameState.bakingTimer);
                    updateDisplay();
                    alert('P√£o assado! +1 p√£o pronto para comer ou vender!');
                }
            };
            
            updateTimer();
            gameState.bakingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Assar peixe (80% energia)
        function bakeFish() {
            if (!gameState.hasStove) {
                alert('Voc√™ precisa comprar o fog√£o primeiro!');
                return;
            }
            
            if (gameState.isBaking) {
                alert('J√° h√° algo sendo assado! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar ingredientes: 1 peixe
            if (gameState.products.fish < 1) {
                alert('Voc√™ precisa de 1 peixe!');
                return;
            }
            
            if (gameState.firewood < 3) {
                alert('Voc√™ precisa de 3 lenhas para acender o forno!');
                return;
            }
            
            // Consumir ingredientes
            gameState.products.fish -= 1;
            gameState.firewood -= 3;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isBaking = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('stove-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Assando peixe... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isBaking = false;
                    gameState.food.bakedFish = (gameState.food.bakedFish || 0) + 1;
                    statusElement.textContent = 'Peixe assado! üêü';
                    clearInterval(gameState.bakingTimer);
                    updateDisplay();
                    alert('Peixe assado! +1 peixe assado pronto para comer (recupera 80% energia)');
                }
            };
            
            updateTimer();
            gameState.bakingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }



        // Selecionar canteiro da estufa
        function selectGreenhousePlot(index) {
            
            if (gameState.currentSeason !== 3) {
                alert('A estufa s√≥ √© usada no inverno!');
                return;
            }
            
            gameState.selectedPlot = null; // Limpar sele√ß√£o normal
            gameState.selectedGreenhousePlot = index;
            
            // Destacar canteiro selecionado
            document.querySelectorAll('#greenhouse-grid .plot').forEach((plot, i) => {
                plot.style.border = i === index ? '3px solid #FFD700' : '3px solid #654321';
            });
            
            const plot = gameState.greenhousePlots[index];
            
            // Executar a√ß√£o apropriada baseada no estado do canteiro
            if (plot.readyToHarvest) {
                harvestGreenhousePlot();
            } else if (plot.planted && !plot.watered) {
                waterGreenhousePlot();
            } else if (plot.fertilized && !plot.planted) {
                plantGreenhouseSeed();
            } else if (!plot.fertilized) {
                fertilizeGreenhousePlot();
            }
        }

        // Adubar canteiro da estufa
        function fertilizeGreenhousePlot() {
            if (gameState.selectedGreenhousePlot === null) {
                alert('Selecione um canteiro da estufa primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.fertilizer < 1) {
                alert('Voc√™ n√£o tem adubo! Use a composteira para fazer.');
                return;
            }
            
            const plot = gameState.greenhousePlots[gameState.selectedGreenhousePlot];
            if (!plot.fertilized) {
                gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
                gameState.fertilizer -= 1;
                plot.fertilized = true;
                updateGreenhousePlotDisplay(gameState.selectedGreenhousePlot);
                updateDisplay();
                alert('Solo da estufa adubado!');
            } else {
                alert('Este canteiro j√° est√° adubado!');
            }
        }

        // Plantar na estufa
        function plantGreenhouseSeed() {
            if (gameState.selectedGreenhousePlot === null || gameState.selectedSeed === null) {
                alert('Selecione um canteiro da estufa e uma semente!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.money < 10) {
                alert('Voc√™ n√£o tem dinheiro suficiente! Cada semente custa 10 moedas.');
                return;
            }
            
            const plot = gameState.greenhousePlots[gameState.selectedGreenhousePlot];
            if (!plot.fertilized) {
                alert('Adube o solo primeiro!');
                return;
            }
            
            if (plot.planted) {
                alert('Este canteiro j√° tem uma planta!');
                return;
            }
            
            gameState.money -= 10;
            gameState.energy = Math.max(0, gameState.energy - 5);
            plot.planted = true;
            plot.seedType = gameState.selectedSeed;
            updateGreenhousePlotDisplay(gameState.selectedGreenhousePlot);
            updateDisplay();
            alert('Semente plantada na estufa por 10 moedas! Agora regue para crescer. üè†');
        }

        // Regar canteiro da estufa
        function waterGreenhousePlot() {
            if (gameState.selectedGreenhousePlot === null) {
                alert('Selecione um canteiro da estufa primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.water <= 0) {
                alert('Voc√™ n√£o tem √°gua! Colete no po√ßo.');
                return;
            }
            
            const plot = gameState.greenhousePlots[gameState.selectedGreenhousePlot];
            if (!plot.planted) {
                alert('Plante algo primeiro!');
                return;
            }
            
            if (!plot.watered) {
                gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
                gameState.water--;
                plot.watered = true;
                startGreenhouseGrowth(gameState.selectedGreenhousePlot);
                updateGreenhousePlotDisplay(gameState.selectedGreenhousePlot);
                updateDisplay();
                alert('Planta da estufa regada! Crescer√° em 1 minuto.');
            } else {
                alert('Esta planta j√° foi regada!');
            }
        }

        // Colher da estufa
        function harvestGreenhousePlot() {
            if (gameState.selectedGreenhousePlot === null) {
                alert('Selecione um canteiro da estufa primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const plot = gameState.greenhousePlots[gameState.selectedGreenhousePlot];
            if (!plot.readyToHarvest) {
                alert('A planta ainda n√£o est√° pronta para colher!');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            const seed = seeds[plot.seedType];
            
            // Adicionar ao invent√°rio (TODOS v√£o para o invent√°rio)
            gameState.inventory[plot.seedType] = (gameState.inventory[plot.seedType] || 0) + 1;
            
            // Resetar canteiro
            plot.fertilized = false;
            plot.planted = false;
            plot.watered = false;
            plot.seedType = null;
            plot.growthProgress = 0;
            plot.readyToHarvest = false;
            if (plot.growthTimer) {
                clearInterval(plot.growthTimer);
                plot.growthTimer = null;
            }
            
            updateGreenhousePlotDisplay(gameState.selectedGreenhousePlot);
            updateDisplay();
            alert(`1x ${seed.name} colhido da estufa e adicionado ao celeiro! üè†`);
        }

        // Iniciar crescimento na estufa
        function startGreenhouseGrowth(plotIndex) {
            const plot = gameState.greenhousePlots[plotIndex];
            if (plot.growthTimer) clearInterval(plot.growthTimer);
            
            let growthTime = 60; // 1 minuto na estufa
            
            plot.growthTimer = setInterval(() => {
                plot.growthProgress += 100/growthTime;
                
                if (plot.growthProgress >= 100) {
                    plot.growthProgress = 100;
                    plot.readyToHarvest = true;
                    clearInterval(plot.growthTimer);
                    plot.growthTimer = null;
                }
                
                updateGreenhousePlotDisplay(plotIndex);
            }, 1000);
        }

        // Atualizar display do canteiro da estufa
        function updateGreenhousePlotDisplay(plotIndex) {
            const plot = gameState.greenhousePlots[plotIndex];
            const plotElement = document.querySelectorAll('#greenhouse-grid .plot')[plotIndex];
            const contentElement = document.getElementById(`greenhouse-content-${plotIndex}`);
            const statusElement = document.getElementById(`greenhouse-status-${plotIndex}`);
            const progressElement = document.getElementById(`greenhouse-progress-${plotIndex}`);
            
            // Atualizar classe do canteiro
            plotElement.className = 'plot';
            if (plot.fertilized) plotElement.classList.add('fertilized');
            if (plot.watered) plotElement.classList.add('watered');
            if (plot.planted && plot.growthProgress > 0) plotElement.classList.add('growing');
            
            // Atualizar conte√∫do
            if (plot.readyToHarvest) {
                contentElement.textContent = seeds[plot.seedType].emoji;
                statusElement.textContent = 'Pronto!';
            } else if (plot.planted) {
                contentElement.textContent = plot.watered ? 'üå±' : seeds[plot.seedType].emoji;
                statusElement.textContent = plot.watered ? 'Crescendo...' : 'Precisa regar';
            } else if (plot.fertilized) {
                contentElement.textContent = 'üå±';
                statusElement.textContent = 'Adubado';
            } else {
                contentElement.textContent = 'üå±';
                statusElement.textContent = 'Vazio';
            }
            
            // Atualizar barra de progresso
            progressElement.style.width = `${plot.growthProgress}%`;
        }

        // Comprar ra√ß√£o de cachorro
        function buyDogFood() {
            if (gameState.money < 15) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 15;
            gameState.dogFood += 1;
            
            // A cada 2 ra√ß√µes compradas, ganha 1 osso de brinde
            if (gameState.dogFood % 2 === 0) {
                gameState.dogBones += 1;
                alert('Ra√ß√£o de cachorro comprada! +1 osso de brinde (a cada 2 ra√ß√µes)! ü¶¥');
            } else {
                alert('Ra√ß√£o de cachorro comprada! Alimente a Mocinha para ela encontrar tesouros.');
            }
            
            updateDisplay();
        }

        // Comprar vacina animal
        function buyVaccine() {
            if (gameState.money < 25) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 25;
            gameState.vaccines += 1;
            updateDisplay();
            alert('Vacina comprada! Use para curar animais doentes.');
        }

        // Comprar Mocinha
        function buyDog() {
            if (gameState.hasDog) {
                alert('Voc√™ j√° tem a Mocinha!');
                return;
            }
            
            if (gameState.money < 500) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 500;
            gameState.hasDog = true;
            document.getElementById('dog-area').style.display = 'block';
            document.getElementById('buy-dog-btn').style.display = 'none';
            updateDisplay();
            alert('Mocinha comprada! Agora voc√™ tem uma cachorrinha que encontra tesouros!');
        }

        // Comprar Duque
        function buyHorse() {
            if (gameState.hasHorse) {
                alert('Voc√™ j√° tem o Duque!');
                return;
            }
            
            if (gameState.money < 1000) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 1000;
            gameState.hasHorse = true;
            document.getElementById('horse-stable').style.display = 'block';
            document.getElementById('buy-horse-btn').style.display = 'none';
            document.getElementById('buy-order-panel-btn').style.display = 'block';
            updateDisplay();
            alert('Duque comprado! Alimente-o com 1 ma√ß√£ por dia e d√™ frutas para aumentar a amizade. Agora voc√™ pode comprar o Painel de Pedidos!');
        }

        // Comprar Painel de Pedidos
        function buyOrderPanel() {
            if (gameState.hasOrderPanel) {
                alert('Voc√™ j√° tem o painel de pedidos!');
                return;
            }
            
            if (!gameState.hasHorse) {
                alert('Voc√™ precisa ter o Duque primeiro para fazer entregas!');
                return;
            }
            
            if (gameState.money < 500) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 500;
            gameState.hasOrderPanel = true;
            document.getElementById('order-panel').style.display = 'block';
            document.getElementById('buy-order-panel-btn').style.display = 'none';
            
            // Gerar primeiros pedidos automaticamente
            setTimeout(() => {
                generateNewOrder();
            }, 2000);
            
            updateDisplay();
            alert('Painel de Pedidos comprado! Agora voc√™ pode receber pedidos de clientes e usar o Duque para entregar. Seu primeiro pedido chegar√° em breve!');
        }

        // Comprar picareta
        function buyPickaxe() {
            if (gameState.hasPickaxe) {
                alert('Voc√™ j√° tem uma picareta!');
                return;
            }
            
            if (gameState.money < 80) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 80;
            gameState.hasPickaxe = true;
            gameState.pickaxeUses = 0;
            document.getElementById('buy-pickaxe-btn').style.display = 'none';
            document.getElementById('buy-mine-btn').style.display = 'block';
            updateDisplay();
            alert('‚õèÔ∏è Picareta comprada! Agora voc√™ pode comprar a mina para extrair carv√£o e pedras preciosas!');
        }

        // Comprar mina
        function buyMine() {
            if (gameState.hasMine) {
                alert('Voc√™ j√° tem uma mina!');
                return;
            }
            
            if (!gameState.hasPickaxe) {
                alert('Voc√™ precisa comprar uma picareta primeiro!');
                return;
            }
            
            if (gameState.money < 400) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 400;
            gameState.hasMine = true;
            document.getElementById('mine-area').style.display = 'block';
            document.getElementById('buy-mine-btn').style.display = 'none';
            updateDisplay();
            alert('‚õèÔ∏è Mina comprada! Agora voc√™ pode extrair carv√£o e pedras preciosas das 3 rochas. A cada 3 batidas voc√™ ganha algo!');
        }

        // Comprar roupa de frio para o cavalo
        function buyHorseWinterClothing() {
            if (!gameState.hasHorse) {
                alert('Voc√™ precisa ter o Duque primeiro!');
                return;
            }
            
            if (gameState.currentSeason !== 3) {
                alert('‚ùÑÔ∏è A roupa de frio s√≥ pode ser comprada durante o inverno!');
                return;
            }
            
            if (gameState.horse.hasWinterClothing) {
                alert('Duque j√° tem roupa de frio!');
                return;
            }
            
            if (gameState.money < 150) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 150;
            gameState.horse.hasWinterClothing = true;
            document.getElementById('buy-horse-clothing-btn').style.display = 'none';
            updateHorseDisplay();
            updateDisplay();
            alert('üß• Roupa de frio comprada para o Duque! Agora ele est√° quentinho e protegido do inverno. A roupa ser√° automaticamente removida na primavera.');
        }

        // Minerar rocha
        function mineRock(rockIndex) {
            
            if (!gameState.hasMine) {
                alert('Voc√™ precisa comprar a mina primeiro!');
                return;
            }
            
            if (!gameState.hasPickaxe) {
                alert('Voc√™ precisa de uma picareta para minerar!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const rock = gameState.rocks[rockIndex];
            
            // Verificar se a rocha pode ser minerada (30 minutos de cooldown)
            const currentTime = Date.now();
            if (!rock.canMine) {
                const timeLeft = Math.ceil((rock.lastResetTime + 1800000 - currentTime) / 60000); // 30 minutos em ms
                if (timeLeft > 0) {
                    alert(`Esta rocha precisa descansar! Aguarde ${timeLeft} minutos.`);
                    return;
                } else {
                    // Resetar rocha ap√≥s 30 minutos
                    rock.canMine = true;
                    rock.hits = 0;
                }
            }
            
            // Consumir energia
            gameState.energy = Math.max(0, gameState.energy - 0.5);
            gameState.pickaxeUses++;
            
            // Incrementar batidas na rocha
            rock.hits++;
            
            // Anima√ß√£o da rocha
            const rockElement = document.getElementById(`rock-${rockIndex + 1}`);
            rockElement.classList.add('mining');
            
            // Criar efeito de fa√≠scas
            const sparks = document.createElement('div');
            sparks.className = 'mining-sparks';
            sparks.textContent = '‚ú®üí•‚ú®';
            rockElement.appendChild(sparks);
            
            setTimeout(() => {
                rockElement.classList.remove('mining');
                sparks.remove();
            }, 500);
            
            // Verificar se completou 3 batidas
            if (rock.hits >= rock.maxHits) {
                // Bloquear rocha por 30 minutos
                rock.canMine = false;
                rock.lastResetTime = currentTime;
                
                // Determinar o que ser√° extra√≠do (50% carv√£o, 50% pedra preciosa)
                const isCoal = Math.random() < 0.5;
                
                if (isCoal) {
                    gameState.coal++;
                    document.getElementById('mining-status').textContent = 'ü™® Carv√£o extra√≠do!';
                    alert('ü™® Voc√™ extraiu carv√£o! Armazenado no celeiro para usos futuros.');
                } else {
                    // Escolher pedra preciosa aleat√≥ria
                    const gemTypes = ['ruby', 'emerald', 'sapphire'];
                    const randomGem = gemTypes[Math.floor(Math.random() * gemTypes.length)];
                    const gemEmojis = { ruby: 'üíé', emerald: 'üíö', sapphire: 'üíô' };
                    const gemNames = { ruby: 'Rubi', emerald: 'Esmeralda', sapphire: 'Safira' };
                    
                    gameState.gems[randomGem]++;
                    document.getElementById('mining-status').textContent = `${gemEmojis[randomGem]} ${gemNames[randomGem]} extra√≠da!`;
                    alert(`${gemEmojis[randomGem]} Voc√™ extraiu uma ${gemNames[randomGem]}! Venda na quitanda por um bom pre√ßo!`);
                }
            } else {
                document.getElementById('mining-status').textContent = `Minerando... ${rock.hits}/3 batidas na rocha ${rockIndex + 1}`;
            }
            
            // Verificar se a picareta quebrou
            if (gameState.pickaxeUses >= 54) {
                gameState.hasPickaxe = false;
                gameState.pickaxeUses = 0;
                document.getElementById('buy-pickaxe-btn').style.display = 'block';
                alert('‚õèÔ∏è Sua picareta quebrou! Voc√™ precisa comprar outra para continuar minerando.');
            }
            
            updateDisplay();
            updateMineDisplay();
        }

        // Vender pedra preciosa
        function sellGem(gemType) {
            if (gameState.gems[gemType] <= 0) {
                const gemNames = { ruby: 'rubis', emerald: 'esmeraldas', sapphire: 'safiras' };
                alert(`Voc√™ n√£o tem ${gemNames[gemType]} para vender!`);
                return;
            }
            
            const gemPrices = { ruby: 150, emerald: 200, sapphire: 180 };
            const gemEmojis = { ruby: 'üíé', emerald: 'üíö', sapphire: 'üíô' };
            const gemNames = { ruby: 'Rubi', emerald: 'Esmeralda', sapphire: 'Safira' };
            
            const price = gemPrices[gemType];
            gameState.gems[gemType]--;
            gameState.money += price;
            updateDisplay();
            alert(`${gemEmojis[gemType]} ${gemNames[gemType]} vendida por ${price} moedas!`);
        }

        // Vender p√©rola
        function sellPearl() {
            if (gameState.pearls <= 0) {
                alert('Voc√™ n√£o tem p√©rolas para vender!');
                return;
            }
            
            const price = 250;
            gameState.pearls--;
            gameState.money += price;
            updateDisplay();
            alert(`ü¶™ P√©rola vendida por ${price} moedas!`);
        }

        // Atualizar display da mina
        function updateMineDisplay() {
            if (!gameState.hasMine) return;
            
            // Atualizar contadores de batidas e status das rochas
            gameState.rocks.forEach((rock, index) => {
                const hitsElement = document.getElementById(`rock-${index + 1}-hits`);
                const rockElement = document.getElementById(`rock-${index + 1}`);
                
                if (hitsElement && rockElement) {
                    if (!rock.canMine) {
                        const currentTime = Date.now();
                        const timeLeft = Math.ceil((rock.lastResetTime + 1800000 - currentTime) / 60000); // 30 minutos
                        
                        if (timeLeft > 0) {
                            hitsElement.textContent = `Descansando (${timeLeft}min)`;
                            rockElement.style.opacity = '0.5';
                            rockElement.style.cursor = 'not-allowed';
                        } else {
                            // Resetar rocha ap√≥s 30 minutos
                            rock.canMine = true;
                            rock.hits = 0;
                            hitsElement.textContent = `${rock.hits}/3 batidas`;
                            rockElement.style.opacity = '1';
                            rockElement.style.cursor = 'pointer';
                        }
                    } else {
                        hitsElement.textContent = `${rock.hits}/3 batidas`;
                        rockElement.style.opacity = '1';
                        rockElement.style.cursor = 'pointer';
                    }
                }
            });
        }

        // Interagir com cachorro
        function interactWithDog() {
            const dog = gameState.dog;
            
            if (!dog.fedToday) {
                feedDog();
            } else if (dog.treasureReady) {
                collectTreasure();
            } else {
                alert('Mocinha j√° foi alimentada hoje! Aguarde ela encontrar um tesouro.');
            }
        }

        // Alimentar cachorro
        function feedDog() {
            const dog = gameState.dog;
            
            if (dog.fed) {
                alert('Mocinha j√° foi alimentada!');
                return;
            }
            
            if (gameState.dogFood <= 0) {
                alert('Voc√™ n√£o tem ra√ß√£o de cachorro! Compre no mercadinho.');
                return;
            }
            
            gameState.dogFood--;
            dog.fed = true;
            
            // Mostrar cora√ß√µes
            showDogHearts();
            
            // Iniciar busca por tesouro (30 segundos)
            dog.treasureTimer = setTimeout(() => {
                findTreasure();
            }, 30000);
            
            updateDogDisplay();
            updateDisplay();
            alert('Mocinha foi alimentada! ‚ù§Ô∏è Ela vai procurar tesouros agora (30 segundos).');
        }

        // Mostrar cora√ß√µes no cachorro
        function showDogHearts() {
            const heartsElement = document.getElementById('dog-hearts');
            heartsElement.textContent = '‚ù§Ô∏èüíï‚ù§Ô∏è';
            heartsElement.style.opacity = '1';
            
            setTimeout(() => {
                heartsElement.style.opacity = '0';
            }, 2000);
        }

        // Dar petisco (osso) para o cachorro
        function giveBoneTreat() {
            if (!gameState.hasDog) {
                alert('Voc√™ precisa comprar a Mocinha primeiro!');
                return;
            }
            
            if (gameState.dogBones <= 0) {
                alert('Voc√™ n√£o tem ossos! Compre 2 ra√ß√µes para ganhar 1 osso de brinde.');
                return;
            }
            
            gameState.dogBones--;
            gameState.dog.friendship = Math.min(100, gameState.dog.friendship + 10);
            
            // Mostrar cora√ß√µes
            showDogHearts();
            
            updateDogDisplay();
            updateDisplay();
            alert(`Mocinha adorou o petisco! ‚ù§Ô∏è Amizade: ${gameState.dog.friendship}/100`);
        }

        // Encontrar tesouro
        function findTreasure() {
            const dog = gameState.dog;
            
            if (gameState.treasuresFoundToday >= 1) {
                return; // M√°ximo 1 tesouro por dia
            }
            
            const treasureTypes = ['cd', 'bottle', 'shoe', 'ball'];
            const randomTreasure = treasureTypes[Math.floor(Math.random() * treasureTypes.length)];
            
            dog.currentTreasure = randomTreasure;
            dog.treasureReady = true;
            dog.hasFoundTreasure = true;
            
            document.getElementById('collect-treasure-btn').style.display = 'block';
            updateDogDisplay();
            
            alert('üéâ Mocinha encontrou um tesouro! Clique para coletar.');
        }

        // Coletar tesouro
        function collectTreasure() {
            const dog = gameState.dog;
            
            if (!dog.treasureReady || !dog.currentTreasure) {
                alert('Mocinha ainda n√£o encontrou nenhum tesouro!');
                return;
            }
            
            const treasureEmojis = {
                cd: 'üíø',
                bottle: 'üçº', 
                shoe: 'üëü',
                ball: '‚öΩ'
            };
            
            gameState.treasures[dog.currentTreasure]++;
            gameState.treasuresFoundToday++;
            
            const treasureEmoji = treasureEmojis[dog.currentTreasure];
            const treasureName = getTreasureName(dog.currentTreasure);
            
            // Reset do cachorro
            dog.treasureReady = false;
            dog.currentTreasure = null;
            document.getElementById('collect-treasure-btn').style.display = 'none';
            
            updateDogDisplay();
            updateDisplay();
            alert(`Tesouro coletado! ${treasureEmoji} Mocinha encontrou um(a) ${treasureName}!`);
        }

        // Obter nome do tesouro
        function getTreasureName(treasure) {
            const names = {
                cd: 'CD',
                bottle: 'garrafa',
                shoe: 'sapato', 
                ball: 'bola'
            };
            return names[treasure] || treasure;
        }

        // Vender tesouro
        function sellTreasure(treasureType) {
            if (gameState.treasures[treasureType] <= 0) {
                alert(`Voc√™ n√£o tem ${getTreasureName(treasureType)} para vender!`);
                return;
            }
            
            const prices = {
                cd: 80,
                bottle: 60,
                shoe: 70,
                ball: 90
            };
            
            const price = prices[treasureType];
            gameState.treasures[treasureType]--;
            gameState.money += price;
            updateDisplay();
            alert(`${getTreasureName(treasureType)} vendido por ${price} moedas!`);
        }

        // Atualizar display do cachorro
        function updateDogDisplay() {
            const dog = gameState.dog;
            const statusElement = document.getElementById('dog-status');
            
            if (dog.treasureReady) {
                statusElement.textContent = `Encontrou tesouro! üíé`;
            } else if (dog.fedToday) {
                if (gameState.treasuresFoundToday >= 1) {
                    statusElement.textContent = 'J√° encontrou tesouro hoje';
                } else {
                    statusElement.textContent = 'Procurando tesouros...';
                }
            } else {
                statusElement.textContent = 'Com fome';
            }
        }

        // Sistema de Pedidos
        const orderItems = [
            { name: 'Leite', emoji: 'ü•õ', type: 'product', key: 'milk', basePrice: 15 },
            { name: 'Ovos', emoji: 'ü•ö', type: 'product', key: 'eggs', basePrice: 12 },
            { name: 'Queijo', emoji: 'üßÄ', type: 'product', key: 'cheese', basePrice: 60 },
            { name: 'P√£o', emoji: 'üçû', type: 'product', key: 'bread', basePrice: 35 },
            { name: 'Mel', emoji: 'üçØ', type: 'product', key: 'honey', basePrice: 35 },
            { name: 'Batata', emoji: 'ü•î', type: 'inventory', key: 0, basePrice: 25 },
            { name: 'Tomate', emoji: 'üçÖ', type: 'inventory', key: 1, basePrice: 30 },
            { name: 'Cenoura', emoji: 'ü•ï', type: 'inventory', key: 2, basePrice: 20 },
            { name: 'Ma√ß√£', emoji: 'üçé', type: 'fruit', key: 'apples', basePrice: 10 },
            { name: 'Banana', emoji: 'üçå', type: 'fruit', key: 'bananas', basePrice: 8 }
        ];

        const customerNames = [
            'Maria', 'Jo√£o', 'Ana', 'Pedro', 'Carla',
            'Roberto', 'Lucia', 'Carlos', 'Fernanda', 'Marcos'
        ];

        // Gerar novo pedido
        function generateNewOrder() {
            if (!gameState.hasOrderPanel) {
                alert('Voc√™ precisa comprar o painel de pedidos primeiro!');
                return;
            }
            
            if (gameState.orders.length >= 3) {
                alert('Voc√™ j√° tem o m√°ximo de pedidos ativos (3)!');
                return;
            }
            
            // Gerar pedidos at√© completar 3
            while (gameState.orders.length < 3) {
                // Selecionar cliente aleat√≥rio
                const customer = customerNames[Math.floor(Math.random() * customerNames.length)];
                
                // Selecionar 1-3 itens aleat√≥rios
                const numItems = Math.floor(Math.random() * 3) + 1;
                const selectedItems = [];
                
                for (let i = 0; i < numItems; i++) {
                    const item = orderItems[Math.floor(Math.random() * orderItems.length)];
                    const quantity = Math.floor(Math.random() * 3) + 1; // 1-3 unidades
                    const bonus = Math.floor(Math.random() * 20) + 10; // 10-30% de b√¥nus
                    const totalPrice = Math.floor(item.basePrice * quantity * (1 + bonus/100));
                    
                    selectedItems.push({
                        ...item,
                        quantity: quantity,
                        totalPrice: totalPrice
                    });
                }
                
                // Criar pedido
                const order = {
                    id: Date.now() + gameState.orders.length, // ID √∫nico
                    customer: customer,
                    items: selectedItems,
                    totalValue: selectedItems.reduce((sum, item) => sum + item.totalPrice, 0),
                    status: 'pending', // pending, ready, delivering, completed
                    deliveryTime: 60 // 1 minuto para entregar
                };
                
                gameState.orders.push(order);
                createOrderElement(order);
            }
            
            updateOrdersDisplay();
            alert(`üìã Novos pedidos chegaram! Agora voc√™ tem ${gameState.orders.length} pedidos ativos.`);
        }

        // Criar elemento visual do pedido
        function createOrderElement(order) {
            const ordersContainer = document.getElementById('orders-container');
            const orderElement = document.createElement('div');
            orderElement.className = 'order-item';
            orderElement.id = `order-${order.id}`;
            
            const itemsHtml = order.items.map(item => 
                `<div class="order-item-detail">${item.quantity}x ${item.emoji} ${item.name}</div>`
            ).join('');
            
            orderElement.innerHTML = `
                <div class="order-header">
                    <span>üë§ ${order.customer}</span>
                    <span>üí∞ ${order.totalValue} moedas</span>
                </div>
                <div class="order-items">
                    ${itemsHtml}
                </div>
                <div style="text-align: center; margin-bottom: 6px;">
                    <div id="order-status-${order.id}" style="font-size: 0.7rem; color: #666;">Aguardando decis√£o</div>
                </div>
                <div class="order-actions">
                    <button class="order-btn" onclick="prepareOrder(${order.id})" id="prepare-btn-${order.id}">‚úÖ Aceitar Pedido</button>
                    <button class="order-btn" onclick="rejectOrder(${order.id})" id="reject-btn-${order.id}" style="background: #FF6347;">‚ùå Recusar</button>
                    <button class="order-btn" onclick="deliverOrder(${order.id})" id="deliver-btn-${order.id}" style="display: none;">üê¥ Entregar com Duque</button>
                </div>
            `;
            
            ordersContainer.appendChild(orderElement);
        }

        // Recusar pedido
        function rejectOrder(orderId) {
            const orderIndex = gameState.orders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            const order = gameState.orders[orderIndex];
            gameState.orders.splice(orderIndex, 1);
            
            const orderElement = document.getElementById(`order-${orderId}`);
            if (orderElement) {
                orderElement.remove();
            }
            
            updateOrdersDisplay();
            alert(`‚ùå Pedido de ${order.customer} foi recusado.`);
        }

        // Preparar pedido
        function prepareOrder(orderId) {
            const order = gameState.orders.find(o => o.id === orderId);
            if (!order || order.status !== 'pending') return;
            
            // Verificar se tem todos os itens
            let canPrepare = true;
            const missingItems = [];
            
            for (const item of order.items) {
                let available = 0;
                
                if (item.type === 'product') {
                    available = gameState.products[item.key] || 0;
                } else if (item.type === 'inventory') {
                    available = gameState.inventory[item.key] || 0;
                } else if (item.type === 'fruit') {
                    available = gameState[item.key] || 0;
                }
                
                if (available < item.quantity) {
                    canPrepare = false;
                    missingItems.push(`${item.quantity - available}x ${item.name}`);
                }
            }
            
            if (!canPrepare) {
                alert(`Itens insuficientes! Faltam: ${missingItems.join(', ')}`);
                return;
            }
            
            // Consumir itens
            for (const item of order.items) {
                if (item.type === 'product') {
                    gameState.products[item.key] -= item.quantity;
                } else if (item.type === 'inventory') {
                    gameState.inventory[item.key] -= item.quantity;
                } else if (item.type === 'fruit') {
                    gameState[item.key] -= item.quantity;
                }
            }
            
            // Atualizar status do pedido
            order.status = 'ready';
            const orderElement = document.getElementById(`order-${orderId}`);
            orderElement.classList.add('ready');
            
            document.getElementById(`prepare-btn-${orderId}`).style.display = 'none';
            document.getElementById(`reject-btn-${orderId}`).style.display = 'none';
            document.getElementById(`deliver-btn-${orderId}`).style.display = 'block';
            document.getElementById(`order-status-${orderId}`).textContent = 'Pronto para entrega!';
            
            updateDisplay();
            updateOrdersDisplay();
            alert('üì¶ Pedido preparado! Agora use o Duque para entregar.');
        }

        // Entregar pedido
        function deliverOrder(orderId) {
            const order = gameState.orders.find(o => o.id === orderId);
            if (!order || order.status !== 'ready') return;
            
            if (!gameState.hasHorse) {
                alert('Voc√™ precisa ter o Duque para fazer entregas!');
                return;
            }
            
            if (!gameState.horse.fed || !gameState.horse.fedToday) {
                alert('Duque precisa estar alimentado para trabalhar!');
                return;
            }
            
            // Verificar se √© inverno e se tem roupa de frio
            if (gameState.currentSeason === 3 && !gameState.horse.hasWinterClothing) {
                alert('‚ùÑÔ∏è No inverno, Duque precisa de roupa de frio para trabalhar! Compre no mercadinho.');
                return;
            }
            
            // Iniciar entrega
            order.status = 'delivering';
            const orderElement = document.getElementById(`order-${orderId}`);
            orderElement.classList.remove('ready');
            orderElement.classList.add('delivering');
            
            document.getElementById(`deliver-btn-${orderId}`).style.display = 'none';
            document.getElementById(`order-status-${orderId}`).textContent = 'Duque est√° entregando...';
            document.getElementById('horse-delivery-status').textContent = 'Entregando pedido';
            
            // Timer de entrega (1 minuto)
            let deliveryTime = order.deliveryTime;
            const deliveryInterval = setInterval(() => {
                deliveryTime--;
                document.getElementById(`order-status-${orderId}`).textContent = `Duque entregando: ${deliveryTime}s`;
                
                if (deliveryTime <= 0) {
                    completeOrder(orderId);
                    clearInterval(deliveryInterval);
                }
            }, 1000);
            
            updateOrdersDisplay();
        }

        // Completar pedido
        function completeOrder(orderId) {
            const orderIndex = gameState.orders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            const order = gameState.orders[orderIndex];
            
            // Receber pagamento
            gameState.money += order.totalValue;
            gameState.completedOrders++;
            
            // Remover pedido
            gameState.orders.splice(orderIndex, 1);
            const orderElement = document.getElementById(`order-${orderId}`);
            if (orderElement) {
                orderElement.remove();
            }
            
            document.getElementById('horse-delivery-status').textContent = 'Dispon√≠vel';
            
            updateDisplay();
            updateOrdersDisplay();
            
            alert(`‚úÖ Pedido entregue! Voc√™ recebeu ${order.totalValue} moedas. Duque est√° de volta!`);
            
            // Gerar novos pedidos automaticamente ap√≥s 30 segundos se n√£o tiver 3
            setTimeout(() => {
                if (gameState.orders.length < 3) {
                    generateNewOrder();
                }
            }, 30000);
        }



        // Atualizar display dos pedidos
        function updateOrdersDisplay() {
            if (!gameState.hasOrderPanel) return;
            
            document.getElementById('active-orders').textContent = gameState.orders.length;
            document.getElementById('completed-orders').textContent = gameState.completedOrders;
            
            // Habilitar/desabilitar bot√£o de gerar pedido
            const generateBtn = document.getElementById('generate-order-btn');
            if (gameState.orders.length >= 3) {
                generateBtn.disabled = true;
                generateBtn.textContent = 'üìã M√°ximo de pedidos atingido';
            } else {
                generateBtn.disabled = false;
                generateBtn.textContent = 'üìã Gerar 3 Pedidos';
            }
        }

        // Interagir com cavalo
        function interactWithHorse() {
            if (!gameState.hasHorse) return;
            
            const horse = gameState.horse;
            
            if (!horse.fed && !horse.fedToday) {
                giveHayToHorse();
            } else if (horse.friendship >= 100 && horse.canRide) {
                rideHorse();
            } else {
                alert('Duque precisa ser alimentado ou ainda n√£o confia em voc√™ o suficiente para montar.');
            }
        }



        // Dar feno ao cavalo (alimentar)
        function giveHayToHorse() {
            if (!gameState.hasHorse) {
                alert('Voc√™ precisa comprar o Duque primeiro!');
                return;
            }
            
            const horse = gameState.horse;
            if (horse.fed) {
                alert('Duque j√° foi alimentado!');
                return;
            }
            
            if (gameState.hay <= 0) {
                alert('Voc√™ n√£o tem feno! Fa√ßa feno no secador de grama.');
                return;
            }
            
            gameState.hay--;
            horse.fed = true;
            
            // Produzir esterco ao alimentar
            gameState.compostMaterials.manure += 1;
            
            // Mostrar cora√ß√µes
            showHorseHearts();
            
            updateHorseDisplay();
            updateDisplay();
            alert('Duque foi alimentado com feno! +1 esterco adicionado √† composteira.');
        }

        // Dar ma√ß√£ ao cavalo (+amizade)
        function giveAppleToHorse() {
            if (!gameState.hasHorse) {
                alert('Voc√™ precisa comprar o Duque primeiro!');
                return;
            }
            
            if (gameState.apples <= 0) {
                alert('Voc√™ n√£o tem ma√ß√£s! Colete na macieira do bosque.');
                return;
            }
            
            gameState.apples--;
            gameState.horse.friendship = Math.min(100, gameState.horse.friendship + 10);
            
            // Mostrar cora√ß√µes
            showHorseHearts();
            
            // Verificar se pode montar
            if (gameState.horse.friendship >= 100) {
                gameState.horse.canRide = true;
                document.getElementById('ride-btn').style.display = 'block';
                alert(`Duque ama ma√ß√£s! ‚ù§Ô∏è Amizade: ${gameState.horse.friendship}/100. Agora voc√™ pode montar nele!`);
            } else {
                alert(`Duque ama ma√ß√£s! ‚ù§Ô∏è Amizade: ${gameState.horse.friendship}/100`);
            }
            
            updateHorseDisplay();
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }



        // Mostrar cora√ß√µes no cavalo
        function showHorseHearts() {
            const heartsElement = document.getElementById('horse-hearts');
            heartsElement.textContent = '‚ù§Ô∏èüíï‚ù§Ô∏è';
            heartsElement.style.opacity = '1';
            
            setTimeout(() => {
                heartsElement.style.opacity = '0';
            }, 2000);
        }

        // Montar no cavalo
        function rideHorse() {
            if (!gameState.horse.canRide) {
                alert('Duque ainda n√£o confia em voc√™ o suficiente! D√™ mais ma√ß√£s para ele.');
                return;
            }
            
            if (!gameState.horse.fed) {
                alert('Duque precisa ser alimentado antes de trabalhar!');
                return;
            }
            
            // Verificar se √© inverno e se tem roupa de frio
            if (gameState.currentSeason === 3 && !gameState.horse.hasWinterClothing) {
                alert('‚ùÑÔ∏è No inverno, Duque precisa de roupa de frio para trabalhar! Compre no mercadinho.');
                return;
            }
            
            alert('üèá Voc√™ montou no Duque! Que experi√™ncia incr√≠vel! Duque √© um cavalo leal e forte.');
            
            // Anima√ß√£o especial
            const horseDisplay = document.getElementById('horse-display');
            horseDisplay.style.transform = 'scale(1.2)';
            setTimeout(() => {
                horseDisplay.style.transform = 'scale(1)';
            }, 1000);
        }

        // Atualizar display do cavalo
        function updateHorseDisplay() {
            if (!gameState.hasHorse) return;
            
            const horse = gameState.horse;
            const statusElement = document.getElementById('horse-status');
            const horseDisplay = document.getElementById('horse-display');
            
            // Atualizar apar√™ncia do cavalo baseado na roupa de frio
            if (gameState.currentSeason === 3 && horse.hasWinterClothing) {
                horseDisplay.textContent = 'üê¥üß•'; // Cavalo com roupa de frio
            } else {
                horseDisplay.textContent = 'üê¥'; // Cavalo normal
            }
            
            if (horse.fedToday) {
                if (horse.canRide) {
                    statusElement.textContent = 'Alimentado e pronto para montar! üèá';
                } else {
                    statusElement.textContent = `Alimentado (amizade: ${horse.friendship}/100)`;
                }
            } else {
                statusElement.textContent = 'Com fome (precisa de 1 feno/dia)';
            }
            
            // Adicionar status da roupa de frio no inverno
            if (gameState.currentSeason === 3) {
                if (horse.hasWinterClothing) {
                    statusElement.textContent += ' ‚ùÑÔ∏è Protegido do frio!';
                } else {
                    statusElement.textContent += ' ‚ùÑÔ∏è Precisa de roupa de frio!';
                }
            }
        }

        // Iniciar secagem de grama
        function startDrying() {
            if (!gameState.hasDryer) {
                alert('Voc√™ precisa comprar o secador primeiro!');
                return;
            }
            
            if (gameState.isDrying) {
                alert('J√° h√° grama secando! Aguarde terminar.');
                return;
            }
            
            const amount = parseInt(document.getElementById('grass-amount').value);
            
            if (amount < 4 || amount > 8) {
                alert('Quantidade deve ser entre 4 e 8 gramas!');
                return;
            }
            
            if (gameState.freshGrass < amount) {
                alert('Voc√™ n√£o tem grama fresca suficiente!');
                return;
            }
            
            gameState.freshGrass -= amount;
            gameState.isDrying = true;
            
            let timeLeft = 30; // 30 segundos para secar
            const statusElement = document.getElementById('drying-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Secando... ${timeLeft}s restantes`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isDrying = false;
                    gameState.driedGrass += amount;
                    statusElement.textContent = `${amount} gramas secas prontas!`;
                    clearInterval(gameState.dryingTimer);
                    updateDisplay();
                    alert(`${amount} gramas foram secas com sucesso!`);
                    showTutorial('make-hay');
                }
            };
            
            updateTimer();
            gameState.dryingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Fazer feno
        function makeHay() {
            if (!gameState.hasDryer) {
                alert('Voc√™ precisa comprar o secador primeiro!');
                return;
            }
            
            if (gameState.driedGrass < 4) {
                alert('Voc√™ precisa de pelo menos 4 gramas secas para fazer feno!');
                return;
            }
            
            gameState.driedGrass -= 4;
            
            // Processo de fazer feno (20 segundos)
            let timeLeft = 20;
            const statusElement = document.getElementById('drying-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fazendo feno... ${timeLeft}s restantes`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.hay += 4;
                    statusElement.textContent = '4 fenos prontos! üü®';
                    updateDisplay();
                    alert('4 fenos foram produzidos e armazenados no celeiro! Agora voc√™ pode alimentar vacas, cavalos e ovelhas com feno.');
                }
            };
            
            updateTimer();
            const hayTimer = setInterval(updateTimer, 1000);
            
            setTimeout(() => {
                clearInterval(hayTimer);
            }, 20000);
            
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Comprar vaca
        function buyCow() {
            if (!gameState.hasPasture) {
                alert('Voc√™ precisa comprar o pasto primeiro!');
                return;
            }
            
            if (gameState.cows.length >= 4) {
                alert('M√°ximo de 4 vacas no pasto!');
                return;
            }
            
            if (gameState.money < 80) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 80;
            const cowId = gameState.cows.length;
            gameState.cows.push({
                id: cowId,
                fed: false,
                readyToMilk: false,
                milkTimer: null,
                feedTimer: null,
                milkedToday: false,
                isBeingMilked: false,
                milkingProgress: 0
            });
            
            createCowElement(cowId);
            updateDisplay();
            alert('Vaca leiteira comprada! Alimente-a para produzir leite (3 leites por dia + 1 esterco di√°rio).');
            showTutorial('buy-cow');
        }

        // Comprar galinha
        function buyChicken() {
            if (!gameState.hasChickenCoop) {
                alert('Voc√™ precisa comprar o galinheiro primeiro!');
                return;
            }
            
            if (gameState.money < 60) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            if (gameState.chickens.length >= 4) {
                alert('M√°ximo de 4 galinhas no galinheiro!');
                return;
            }
            
            gameState.money -= 60;
            const chickenId = gameState.chickens.length;
            gameState.chickens.push({
                id: chickenId,
                fed: false,
                readyToCollect: false,
                collectTimer: null,
                feedTimer: null,
                laidEggsToday: false,
                purchaseDay: 0
            });
            
            // Iniciar reprodu√ß√£o autom√°tica se tiver 2+ galinhas
            if (gameState.chickens.length >= 2 && !gameState.breedingTimer) {
                startAutomaticBreeding();
            }
            
            createChickenElement(chickenId);
            updateDisplay();
            alert('Galinha comprada! Alimente-a com ra√ß√£o para produzir ovos (3 ovos por dia).');
        }

        // Sistema de reprodu√ß√£o autom√°tica
        function startAutomaticBreeding() {
            if (gameState.breedingTimer) return;
            
            gameState.breedingTimer = setInterval(() => {
                // Verificar se ainda tem 2+ galinhas e espa√ßo
                if (gameState.chickens.length >= 2 && 
                    gameState.chicks.length + gameState.chickens.length < 4) {
                    
                    // Gerar pintinho automaticamente
                    const chickId = gameState.chicks.length;
                    gameState.chicks.push({
                        id: chickId,
                        birthTime: Date.now(),
                        isAdult: false
                    });
                    
                    createChickElement(chickId);
                    updateDisplay();
                    alert('üê£ Um pintinho nasceu automaticamente! Ele ficar√° adulto em 1 hora.');
                    
                    // Timer para o pintinho crescer (1 hora = 3600000ms)
                    setTimeout(() => {
                        growChickToAdult(chickId);
                    }, 3600000);
                }
                
                // Parar reprodu√ß√£o se n√£o tiver mais 2 galinhas
                if (gameState.chickens.length < 2) {
                    clearInterval(gameState.breedingTimer);
                    gameState.breedingTimer = null;
                }
            }, 300000); // A cada 5 minutos verifica se pode reproduzir
        }

        // Reprodu√ß√£o manual de pintinhos (mantida para compatibilidade)
        function breedChickens() {
            if (gameState.chickens.length < 2) {
                alert('Voc√™ precisa de pelo menos 2 galinhas para gerar pintinhos!');
                return;
            }
            
            if (gameState.chicks.length + gameState.chickens.length >= 4) {
                alert('M√°ximo de 4 galinhas/pintinhos no galinheiro!');
                return;
            }
            
            // Gerar pintinho
            const chickId = gameState.chicks.length;
            gameState.chicks.push({
                id: chickId,
                birthTime: Date.now(),
                isAdult: false
            });
            
            createChickElement(chickId);
            updateDisplay();
            alert('üê£ Um pintinho nasceu! Ele ficar√° adulto em 1 hora.');
            
            // Timer para o pintinho crescer (1 hora = 3600000ms)
            setTimeout(() => {
                growChickToAdult(chickId);
            }, 3600000);
        }

        // Crescer pintinho para galinha adulta
        function growChickToAdult(chickId) {
            const chickIndex = gameState.chicks.findIndex(chick => chick.id === chickId);
            if (chickIndex === -1) return;
            
            // Remover pintinho
            gameState.chicks.splice(chickIndex, 1);
            
            // Adicionar galinha adulta
            const newChickenId = gameState.chickens.length;
            gameState.chickens.push({
                id: newChickenId,
                fed: false,
                readyToCollect: false,
                collectTimer: null,
                feedTimer: null,
                laidEggsToday: false,
                purchaseDay: gameState.dayCount
            });
            
            // Remover elemento do pintinho
            const chickElement = document.getElementById(`chick-${chickId}`);
            if (chickElement) {
                chickElement.remove();
            }
            
            // Criar elemento da galinha adulta
            createChickenElement(newChickenId);
            updateDisplay();
            alert('üêî O pintinho cresceu e virou uma galinha adulta!');
        }

        // Sacrificar galinha
        function sacrificeChicken() {
            if (gameState.chickens.length === 0) {
                alert('Voc√™ n√£o tem galinhas para sacrificar!');
                return;
            }
            
            // Remover a √∫ltima galinha
            const removedChicken = gameState.chickens.pop();
            
            // Adicionar frango cru aos produtos
            gameState.products.rawChicken += 1;
            
            // Remover elemento visual
            const chickenElement = document.getElementById(`chicken-${removedChicken.id}`);
            if (chickenElement) {
                chickenElement.remove();
            }
            
            // Parar reprodu√ß√£o se ficou com menos de 2 galinhas
            if (gameState.chickens.length < 2 && gameState.breedingTimer) {
                clearInterval(gameState.breedingTimer);
                gameState.breedingTimer = null;
            }
            
            updateDisplay();
            alert('Galinha sacrificada! +1 frango cru para vender (80 moedas).');
        }

        // Comprar porco
        function buyPig() {
            if (!gameState.hasPigPen) {
                alert('Voc√™ precisa comprar o chiqueiro primeiro!');
                return;
            }
            
            if (gameState.pigs.length >= 4) {
                alert('M√°ximo de 4 porcos no chiqueiro!');
                return;
            }
            
            if (gameState.money < 100) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 100;
            const pigId = gameState.pigs.length;
            gameState.pigs.push({
                id: pigId,
                fed: false,
                readyToCollect: false,
                collectTimer: null,
                feedTimer: null,
                canProduceToday: true,
                lastProductionDay: 0
            });
            
            createPigElement(pigId);
            updateDisplay();
            alert('Porco comprado! Alimente-o com ra√ß√£o para produzir carne (dia sim, dia n√£o).');
        }

        // Comprar ovelha
        function buySheep() {
            if (!gameState.hasSheepPen) {
                alert('Voc√™ precisa comprar o curral de ovelhas primeiro!');
                return;
            }
            
            if (gameState.sheep.length >= 4) {
                alert('M√°ximo de 4 ovelhas no curral!');
                return;
            }
            
            if (gameState.money < 70) {
                alert('Dinheiro insuficiente!');
                return;
            }
            
            gameState.money -= 70;
            const sheepId = gameState.sheep.length;
            gameState.sheep.push({
                id: sheepId,
                fed: false,
                readyToCollect: false,
                collectTimer: null,
                feedTimer: null,
                canFeedToday: true,
                lastFeedDay: 0,
                isBeingSheared: false,
                shearingProgress: 0
            });
            
            createSheepElement(sheepId);
            updateDisplay();
            alert('Ovelha comprada! Alimente-a com feno para produzir l√£ (dia sim, dia n√£o, tosquia dura 12s).');
        }

        // Fazer ra√ß√£o de galinha
        function makeChickenFeed() {
            if (!gameState.hasMixer) {
                alert('Voc√™ precisa comprar o misturador primeiro!');
                return;
            }
            
            if (gameState.isMakingChickenFeed) {
                alert('J√° h√° ra√ß√£o de galinha sendo feita! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar se tem os ingredientes: 2 milhos + 1 trigo
            const cornCount = gameState.inventory[3] || 0; // Milho √© √≠ndice 3
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            
            if (cornCount < 2 || wheatCount < 1) {
                alert('Ingredientes insuficientes! Precisa de: 2 milhos + 1 trigo');
                return;
            }
            
            gameState.inventory[3] -= 2; // Remove 2 milhos
            gameState.inventory[4] -= 1; // Remove 1 trigo
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMakingChickenFeed = true;
            
            let timeLeft = 10; // 10 segundos
            
            const updateTimer = () => {
                // Atualizar status no painel do misturador
                const statusElement = document.getElementById('mixer-status');
                if (statusElement) {
                    statusElement.textContent = `Fazendo ra√ß√£o de galinha... ${timeLeft}s`;
                }
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMakingChickenFeed = false;
                    gameState.feed.chicken += 4; // Adiciona 4 por√ß√µes de ra√ß√£o ao celeiro
                    if (statusElement) {
                        statusElement.textContent = '4 por√ß√µes de ra√ß√£o de galinha prontas! üêî';
                    }
                    clearInterval(gameState.chickenFeedTimer);
                    updateDisplay();
                    alert('Ra√ß√£o de galinha produzida! +4 por√ß√µes armazenadas no celeiro üì¶');
                }
            };
            
            updateTimer();
            gameState.chickenFeedTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Fazer ra√ß√£o de porco
        function makePigFeed() {
            if (!gameState.hasMixer) {
                alert('Voc√™ precisa comprar o misturador primeiro!');
                return;
            }
            
            if (gameState.isMakingPigFeed) {
                alert('J√° h√° ra√ß√£o de porco sendo feita! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar se tem os ingredientes: 1 tomate + 1 batata + 1 milho + 1 alface
            const tomatoCount = gameState.inventory[1] || 0; // Tomate √© √≠ndice 1
            const potatoCount = gameState.inventory[0] || 0; // Batata √© √≠ndice 0
            const cornCount = gameState.inventory[3] || 0; // Milho √© √≠ndice 3
            const lettuceCount = gameState.inventory[8] || 0; // Alface √© √≠ndice 8
            
            if (tomatoCount < 1 || potatoCount < 1 || cornCount < 1 || lettuceCount < 1) {
                alert('Ingredientes insuficientes! Precisa de: 1 tomate + 1 batata + 1 milho + 1 alface');
                return;
            }
            
            gameState.inventory[1] -= 1; // Remove 1 tomate
            gameState.inventory[0] -= 1; // Remove 1 batata
            gameState.inventory[3] -= 1; // Remove 1 milho
            gameState.inventory[8] -= 1; // Remove 1 alface
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMakingPigFeed = true;
            
            let timeLeft = 10; // 10 segundos
            
            const updateTimer = () => {
                // Atualizar status no painel do misturador
                const statusElement = document.getElementById('mixer-status');
                if (statusElement) {
                    statusElement.textContent = `Fazendo ra√ß√£o de porco... ${timeLeft}s`;
                }
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMakingPigFeed = false;
                    gameState.feed.pig += 4; // Adiciona 4 por√ß√µes de ra√ß√£o ao celeiro
                    if (statusElement) {
                        statusElement.textContent = '4 por√ß√µes de ra√ß√£o de porco prontas! üê∑';
                    }
                    clearInterval(gameState.pigFeedTimer);
                    updateDisplay();
                    alert('Ra√ß√£o de porco produzida! +4 por√ß√µes armazenadas no celeiro üì¶');
                }
            };
            
            updateTimer();
            gameState.pigFeedTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Fazer queijo
        function makeCheese() {
            if (!gameState.hasCheeseMaker) {
                alert('Voc√™ precisa comprar a queijaria primeiro!');
                return;
            }
            
            if (gameState.isMakingCheese) {
                alert('J√° h√° queijo sendo feito! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.milk < 2) {
                alert('Voc√™ precisa de pelo menos 2 leites para fazer queijo!');
                return;
            }
            
            gameState.products.milk -= 2;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMakingCheese = true;
            
            let timeLeft = 300; // 5 minutos em segundos
            const statusElement = document.getElementById('cheese-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Fazendo queijo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMakingCheese = false;
                    gameState.cheeseReady += 1;
                    gameState.products.cheese += 1;
                    statusElement.textContent = '1 queijo pronto! üßÄ';
                    clearInterval(gameState.cheeseTimer);
                    updateDisplay();
                    alert('Queijo pronto! +1 queijo (vale 60 moedas)');
                }
            };
            
            updateTimer();
            gameState.cheeseTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Coletar troncos da √°rvore
        function collectLogs() {
            
            if (!gameState.hasBosque) {
                alert('Voc√™ precisa comprar o bosque primeiro!');
                return;
            }
            
            if (!gameState.hasAxe) {
                alert('Voc√™ precisa comprar um machado primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.logs += 1; // Ganha 1 tronco por batida
            gameState.axeUses += 1;
            gameState.logsCollectedCount += 1;
            
            // A cada 3 batidas na √°rvore, ganha 1 galho
            if (gameState.logsCollectedCount >= 3) {
                gameState.branchesCollected += 1;
                gameState.compostMaterials.branches += 1;
                gameState.logsCollectedCount = 0;
                alert('üåø Galho coletado! +1 galho para composteira!');
                showTutorial('collect-logs');
            }
            
            // Verificar se o machado quebrou
            if (gameState.axeUses >= 50) {
                gameState.hasAxe = false;
                gameState.hasWoodCutter = false; // Perde os dois juntos
                gameState.axeUses = 0;
                document.getElementById('wood-panel').style.display = 'none';
                document.getElementById('buy-axe-btn').style.display = 'block';
                alert('Seu machado quebrou! Voc√™ precisa comprar outro machado (que j√° inclui o cortador de lenha).');
            }
            
            // Anima√ß√£o da √°rvore
            const tree = document.getElementById('tree');
            tree.style.transform = 'scale(1.1)';
            setTimeout(() => {
                tree.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
        }

        // Coletar ma√ß√£s da macieira
        function collectApples() {
            
            if (!gameState.hasBosque) {
                alert('Voc√™ precisa comprar o bosque primeiro!');
                return;
            }
            
            if (!gameState.canCollectApples) {
                alert('As ma√ß√£s ainda n√£o cresceram! Aguarde o pr√≥ximo update (10 min).');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.apples += 5;
            gameState.canCollectApples = false;
            
            // Anima√ß√£o da macieira
            const appleTree = document.getElementById('apple-tree');
            appleTree.style.transform = 'scale(1.1)';
            setTimeout(() => {
                appleTree.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Ma√ß√£s coletadas! +5 ma√ß√£s (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Coletar bananas da bananeira
        function collectBananas() {
            if (!gameState.hasBosque) {
                alert('Voc√™ precisa comprar o bosque primeiro!');
                return;
            }
            
            if (!gameState.canCollectBananas) {
                alert('As bananas ainda n√£o cresceram! Aguarde o pr√≥ximo update (10 min).');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.bananas += 4;
            gameState.canCollectBananas = false;
            
            // Anima√ß√£o da bananeira
            const bananaTree = document.getElementById('banana-tree');
            bananaTree.style.transform = 'scale(1.1)';
            setTimeout(() => {
                bananaTree.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Bananas coletadas! +4 bananas (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Coletar laranjas da laranjeira
        function collectOranges() {
            if (!gameState.hasBosque) {
                alert('Voc√™ precisa comprar o bosque primeiro!');
                return;
            }
            
            if (!gameState.canCollectOranges) {
                alert('As laranjas ainda n√£o cresceram! Aguarde o pr√≥ximo update (10 min).');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.oranges += 4;
            gameState.canCollectOranges = false;
            
            // Anima√ß√£o da laranjeira
            const orangeTree = document.getElementById('orange-tree');
            orangeTree.style.transform = 'scale(1.1)';
            setTimeout(() => {
                orangeTree.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Laranjas coletadas! +4 laranjas (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Refinar madeira
        function refineWood() {
            if (!gameState.hasWoodCutter) {
                alert('Voc√™ precisa comprar o cortador de lenha primeiro!');
                return;
            }
            
            if (gameState.isRefiningWood) {
                alert('J√° h√° madeira sendo refinada! Aguarde terminar.');
                return;
            }
            
            if (gameState.logs < 1) {
                alert('Voc√™ precisa de pelo menos 1 tronco para refinar!');
                return;
            }
            
            gameState.logs -= 1;
            gameState.isRefiningWood = true;
            
            let timeLeft = 10; // 10 segundos
            const statusElement = document.getElementById('wood-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Cortando lenha... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isRefiningWood = false;
                    gameState.firewood += 4;
                    statusElement.textContent = '4 lenhas prontas! ü™®';
                    clearInterval(gameState.woodTimer);
                    updateDisplay();
                    alert('Corte completo! +4 lenhas');
                }
            };
            
            updateTimer();
            gameState.woodTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Torrar caf√©
        function roastCoffee() {
            if (!gameState.hasRoaster) {
                alert('Voc√™ precisa comprar a torradeira primeiro!');
                return;
            }
            
            if (gameState.isRoasting) {
                alert('J√° h√° caf√© sendo torrado! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            // Verificar se tem gr√£os de caf√© suficientes (do invent√°rio)
            const coffeeBeansCount = gameState.inventory[5] || 0; // Caf√© √© √≠ndice 5
            if (coffeeBeansCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 gr√£os de caf√©!');
                return;
            }
            
            if (gameState.firewood < 3) {
                alert('Voc√™ precisa de pelo menos 3 lenhas para acender o fogo!');
                return;
            }
            
            gameState.inventory[5] -= 4; // Remove gr√£os de caf√© do invent√°rio
            gameState.firewood -= 3;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isRoasting = true;
            
            let timeLeft = 60; // 1 minuto em segundos
            const statusElement = document.getElementById('roaster-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Torrando caf√©... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isRoasting = false;
                    gameState.products.coffee += 2; // Adiciona caf√© torrado aos produtos
                    statusElement.textContent = '2 pacotes de caf√© torrado prontos! ‚òï';
                    clearInterval(gameState.roastingTimer);
                    updateDisplay();
                    alert('Caf√© torrado! +2 pacotes de caf√© torrado (vale mais que gr√£os crus)');
                }
            };
            
            updateTimer();
            gameState.roastingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }



        // Fazer adubo
        function makeCompost() {
            if (!gameState.hasCompost) {
                alert('Voc√™ precisa comprar a composteira primeiro!');
                return;
            }
            
            if (gameState.isComposting) {
                alert('J√° h√° adubo sendo feito! Aguarde terminar.');
                return;
            }
            
            if (gameState.compostMaterials.flowers < 1 || 
                gameState.compostMaterials.branches < 1 || 
                gameState.compostMaterials.manure < 2) {
                alert('Materiais insuficientes! Precisa de: 1 flor, 1 galho, 2 estercos');
                return;
            }
            
            gameState.compostMaterials.flowers -= 1;
            gameState.compostMaterials.branches -= 1;
            gameState.compostMaterials.manure -= 2;
            gameState.isComposting = true;
            
            let timeLeft = 600; // 10 minutos em segundos
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('compost-status').textContent = `Compostando... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isComposting = false;
                    gameState.fertilizer += 8;
                    document.getElementById('compost-status').textContent = '8 adubos prontos! üåø';
                    clearInterval(gameState.compostTimer);
                    updateDisplay();
                    alert('Compostagem completa! +8 adubos');
                    showTutorial('make-compost');
                }
            };
            
            updateTimer();
            gameState.compostTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Adubar canteiro
        function fertilizePlot() {
            if (gameState.selectedPlot === null) {
                alert('Selecione um canteiro primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.fertilizer < 1) {
                alert('Voc√™ n√£o tem adubo! Use a composteira para fazer.');
                return;
            }
            
            const plot = gameState.plots[gameState.selectedPlot];
            if (!plot.fertilized) {
                gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
                gameState.fertilizer -= 1;
                plot.fertilized = true;
                updatePlotDisplay(gameState.selectedPlot);
                updateDisplay();
                alert('Solo adubado!');
                showTutorial('fertilize-plot');
            } else {
                alert('Este canteiro j√° est√° adubado!');
            }
        }

        // Plantar semente
        function plantSeed() {
            // Verificar se √© inverno e n√£o tem estufa
            if (gameState.currentSeason === 3 && !gameState.hasGreenhouse) { // Inverno
                alert('‚ùÑÔ∏è No inverno n√£o √© poss√≠vel plantar! Compre uma estufa ou aguarde a primavera.');
                return;
            }
            
            // No inverno, s√≥ pode plantar na estufa
            if (gameState.currentSeason === 3) {
                alert('‚ùÑÔ∏è No inverno, s√≥ √© poss√≠vel plantar na estufa! Use os canteiros protegidos.');
                return;
            }
            
            if (gameState.selectedPlot === null || gameState.selectedSeed === null) {
                alert('Selecione um canteiro e uma semente!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.money < 10) {
                alert('Voc√™ n√£o tem dinheiro suficiente! Cada semente custa 10 moedas.');
                return;
            }
            
            const plot = gameState.plots[gameState.selectedPlot];
            if (!plot.fertilized) {
                alert('Adube o solo primeiro!');
                return;
            }
            
            if (plot.planted) {
                alert('Este canteiro j√° tem uma planta!');
                return;
            }
            
            // Consumir dinheiro e energia
            gameState.money -= 10;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            
            plot.planted = true;
            plot.seedType = gameState.selectedSeed;
            updatePlotDisplay(gameState.selectedPlot);
            updateDisplay();
            
            // Mensagem baseada na esta√ß√£o
            let message = `Semente plantada por 10 moedas! Agora regue para crescer.`;
            if (gameState.currentSeason === 0) { // Primavera
                message += ' ‚ú® Na primavera, suas plantas s√£o mais valiosas!';
            } else if (gameState.currentSeason === 1) { // Ver√£o
                message += ' ‚òÄÔ∏è No ver√£o, voc√™ ganhar√° 2 frutos por canteiro!';
            } else if (gameState.currentSeason === 2) { // Outono
                message += ' üçÇ No outono, as plantas crescem mais r√°pido!';
            }
            
            alert(message);
            showTutorial('plant-seed');
        }

        // Regar canteiro
        function waterPlot() {
            if (gameState.selectedPlot === null) {
                alert('Selecione um canteiro primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.water <= 0) {
                alert('Voc√™ n√£o tem √°gua! Colete no po√ßo.');
                return;
            }
            
            const plot = gameState.plots[gameState.selectedPlot];
            if (!plot.planted) {
                alert('Plante algo primeiro!');
                return;
            }
            
            if (!plot.watered) {
                gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
                gameState.water--;
                plot.watered = true;
                startGrowth(gameState.selectedPlot);
                updatePlotDisplay(gameState.selectedPlot);
                updateDisplay();
                alert('Planta regada! Crescer√° em 1 minuto.');
                showTutorial('water-plant');
            } else {
                alert('Esta planta j√° foi regada!');
            }
        }

        // Iniciar crescimento
        function startGrowth(plotIndex) {
            const plot = gameState.plots[plotIndex];
            if (plot.growthTimer) clearInterval(plot.growthTimer);
            
            // Determinar tempo de crescimento baseado na esta√ß√£o
            let growthTime = 60; // Padr√£o: 60 segundos
            if (gameState.currentSeason === 2) { // Outono
                growthTime = 60; // 1 minuto no outono
            }
            
            plot.growthTimer = setInterval(() => {
                plot.growthProgress += 100/growthTime;
                
                if (plot.growthProgress >= 100) {
                    plot.growthProgress = 100;
                    plot.readyToHarvest = true;
                    clearInterval(plot.growthTimer);
                    plot.growthTimer = null;
                    
                    // Trigger tutorial when plant is ready to harvest
                    if (tutorialState.active && tutorialState.currentStep === tutorialState.steps.findIndex(step => step.id === 'wait-growth')) {
                        showTutorial('wait-growth');
                    }
                }
                
                updatePlotDisplay(plotIndex);
            }, 1000);
        }

        // Colher - agora adiciona produtos ao invent√°rio
        function harvestPlot() {
            if (gameState.selectedPlot === null) {
                alert('Selecione um canteiro primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const plot = gameState.plots[gameState.selectedPlot];
            if (!plot.readyToHarvest) {
                alert('A planta ainda n√£o est√° pronta para colher!');
                return;
            }
            
            // Consumir energia
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            
            const seed = seeds[plot.seedType];
            
            // Determinar quantidade baseada na esta√ß√£o
            let quantity = 1;
            let bonusMessage = '';
            
            if (gameState.currentSeason === 1) { // Ver√£o - 2 frutos por canteiro
                quantity = 2;
                bonusMessage = ' ‚òÄÔ∏è B√¥nus do ver√£o: +1 fruto extra!';
            } else if (gameState.currentSeason === 0) { // Primavera - estrelinhas nos frutos
                bonusMessage = ' ‚ú® Fruto da primavera: vale mais na venda!';
            }
            
            // Adicionar produtos ao invent√°rio (TODOS v√£o para o invent√°rio agora)
            gameState.inventory[plot.seedType] = (gameState.inventory[plot.seedType] || 0) + quantity;
            
            // Resetar canteiro
            plot.fertilized = false;
            plot.planted = false;
            plot.watered = false;
            plot.seedType = null;
            plot.growthProgress = 0;
            plot.readyToHarvest = false;
            if (plot.growthTimer) {
                clearInterval(plot.growthTimer);
                plot.growthTimer = null;
            }
            
            updatePlotDisplay(gameState.selectedPlot);
            updateDisplay();
            alert(`${quantity}x ${seed.name} colhido e adicionado ao celeiro!${bonusMessage}`);
            showTutorial('harvest-plant');
        }

        // Coletar √°gua
        function collectWater() {
            if (!gameState.hasWell) {
                alert('Voc√™ precisa comprar o po√ßo primeiro!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.water += 4;
            updateDisplay();
            
            // Anima√ß√£o do po√ßo
            const well = document.getElementById('well');
            well.style.transform = 'scale(1.2)';
            setTimeout(() => {
                well.style.transform = 'scale(1)';
            }, 200);
            
            showTutorial('collect-water');
        }

        // Alimentar avatar
        function feedAvatar() {
            if (gameState.money < 20) {
                alert('Voc√™ n√£o tem dinheiro suficiente para comprar p√£o!');
                return;
            }
            
            gameState.money -= 20;
            gameState.energy = Math.min(100, gameState.energy + 30);
            updateDisplay();
            alert('Voc√™ comeu p√£o e recuperou 30% de energia!');
        }

        // Descansar avatar
        function restAvatar() {
            if (gameState.isResting) {
                alert('Voc√™ j√° est√° descansando!');
                return;
            }
            
            if (gameState.energy > 90) {
                alert('Voc√™ s√≥ pode descansar quando tiver gasto pelo menos 10% da energia (90% ou menos)!');
                return;
            }
            
            gameState.isResting = true;
            let restTime = 300; // 5 minutos em segundos
            
            // Desabilitar bot√£o de descansar
            const restBtn = document.getElementById('rest-btn');
            if (restBtn) {
                restBtn.disabled = true;
                restBtn.textContent = 'Descansando...';
            }
            
            const restInterval = setInterval(() => {
                restTime--;
                updateAvatarStatus(`Descansando... ${Math.floor(restTime/60)}:${(restTime%60).toString().padStart(2, '0')}`);
                
                if (restTime <= 0) {
                    gameState.isResting = false;
                    gameState.energy = Math.min(100, gameState.energy + 50); // Recupera 50% (50 pontos de 100)
                    
                    // Reabilitar bot√£o
                    if (restBtn) {
                        restBtn.disabled = false;
                        restBtn.textContent = 'üí§ Descansar (5 min)';
                    }
                    
                    clearInterval(restInterval);
                    updateDisplay();
                    alert('Voc√™ descansou e recuperou 50% da energia!');
                }
            }, 1000);
        }

        // Mostrar menu de comida
        function showFoodMenu() {
            
            const totalFood = (gameState.food.salad || 0) + (gameState.food.stew || 0) + (gameState.food.steak || 0) + (gameState.food.bakedFish || 0);
            
            if (totalFood === 0) {
                alert('Voc√™ n√£o tem comida no celeiro! Cozinhe no fog√£o a lenha.');
                return;
            }
            
            // Criar menu de comida
            let menuOptions = [];
            if (gameState.food.salad > 0) {
                menuOptions.push(`ü•ó Salada (${gameState.food.salad} dispon√≠vel) - Recupera 50% energia`);
            }
            if (gameState.food.stew > 0) {
                menuOptions.push(`üç≤ Ensopado (${gameState.food.stew} dispon√≠vel) - Recupera 65% energia`);
            }
            if (gameState.food.steak > 0) {
                menuOptions.push(`ü•© Bife (${gameState.food.steak} dispon√≠vel) - Recupera 100% energia`);
            }
            if (gameState.food.bakedFish > 0) {
                menuOptions.push(`üêü Peixe Assado (${gameState.food.bakedFish} dispon√≠vel) - Recupera 80% energia`);
            }
            
            const choice = prompt(`Escolha o que comer:\n\n${menuOptions.map((option, index) => `${index + 1}. ${option}`).join('\n')}\n\n0. Cancelar\n\nDigite o n√∫mero da op√ß√£o:`);
            
            if (choice === '0' || choice === null) {
                return;
            }
            
            const choiceNum = parseInt(choice);
            let optionIndex = 0;
            
            if (gameState.food.salad > 0) {
                optionIndex++;
                if (choiceNum === optionIndex) {
                    eatSalad();
                    return;
                }
            }
            if (gameState.food.stew > 0) {
                optionIndex++;
                if (choiceNum === optionIndex) {
                    eatStew();
                    return;
                }
            }
            if (gameState.food.steak > 0) {
                optionIndex++;
                if (choiceNum === optionIndex) {
                    eatSteak();
                    return;
                }
            }
            if (gameState.food.bakedFish > 0) {
                optionIndex++;
                if (choiceNum === optionIndex) {
                    eatBakedFish();
                    return;
                }
            }
            
            alert('Op√ß√£o inv√°lida ou comida n√£o dispon√≠vel!');
        }

        // Comer salada
        function eatSalad() {
            if (gameState.food.salad <= 0) {
                alert('Voc√™ n√£o tem saladas no celeiro!');
                return;
            }
            
            gameState.food.salad--;
            gameState.energy = Math.min(100, gameState.energy + 50);
            updateDisplay();
            alert('ü•ó Voc√™ comeu uma salada deliciosa! +50% energia recuperada!');
        }

        // Comer ensopado
        function eatStew() {
            if (gameState.food.stew <= 0) {
                alert('Voc√™ n√£o tem ensopados no celeiro!');
                return;
            }
            
            gameState.food.stew--;
            gameState.energy = Math.min(100, gameState.energy + 65); // Recupera 65% da energia
            updateDisplay();
            alert('üç≤ Voc√™ comeu um ensopado nutritivo! +65% energia recuperada!');
        }

        // Comer bife
        function eatSteak() {
            if ((gameState.food.steak || 0) <= 0) {
                alert('Voc√™ n√£o tem bifes no celeiro!');
                return;
            }
            
            gameState.food.steak--;
            gameState.energy = 100; // Recupera 100% da energia
            updateDisplay();
            alert('ü•© Voc√™ comeu um bife suculento! Energia totalmente recuperada!');
        }

        // Comer peixe assado
        function eatBakedFish() {
            if ((gameState.food.bakedFish || 0) <= 0) {
                alert('Voc√™ n√£o tem peixes assados no celeiro!');
                return;
            }
            
            gameState.food.bakedFish--;
            gameState.energy = Math.min(100, gameState.energy + 80); // Recupera 80% da energia
            updateDisplay();
            alert('üêü Voc√™ comeu um peixe assado delicioso! +80% energia recuperada!');
        }

        // Atualizar status do avatar
        function updateAvatarStatus(status) {
            const avatarStatus = document.getElementById('avatar-status');
            if (avatarStatus) {
                avatarStatus.textContent = status;
            }
        }

        // Criar campo de grama
        function createGrassField() {
            const grassGrid = document.getElementById('grass-grid');
            grassGrid.innerHTML = '';
            
            for (let i = 0; i < 24; i++) {
                const grassTile = document.createElement('div');
                grassTile.className = 'grass-tile';
                grassTile.onclick = () => collectGrass(i);
                grassTile.innerHTML = 'üåø';
                grassTile.id = `grass-${i}`;
                grassGrid.appendChild(grassTile);
            }
        }

        // Coletar grama
        function collectGrass(index) {
            if (!gameState.hasGrassField) return;
            
            const grass = gameState.grassField[index];
            if (!grass.hasGrass || grass.regenerating) return;
            
            // Coletar grama
            grass.hasGrass = false;
            grass.regenerating = true;
            gameState.grassCollected++;
            gameState.freshGrass++; // Adiciona grama fresca
            
            // Verificar se ganhou flor (a cada 4 gramas)
            if (gameState.grassCollected >= 4) {
                gameState.grassCollected = 0;
                gameState.compostMaterials.flowers++;
                alert('Voc√™ ganhou uma flor! üå∏');
                showTutorial('collect-grass');
            }
            
            // Atualizar visual
            updateGrassTile(index);
            
            // Iniciar regenera√ß√£o
            grass.regenerationTimer = setTimeout(() => {
                grass.hasGrass = true;
                grass.regenerating = false;
                updateGrassTile(index);
            }, 20000); // 20 segundos
            
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Atualizar visual da grama
        function updateGrassTile(index) {
            const tile = document.getElementById(`grass-${index}`);
            const grass = gameState.grassField[index];
            
            if (grass.hasGrass) {
                tile.className = 'grass-tile';
                tile.innerHTML = 'üåø';
            } else if (grass.regenerating) {
                tile.className = 'grass-tile regenerating';
                tile.innerHTML = '‚è≥';
            } else {
                tile.className = 'grass-tile empty';
                tile.innerHTML = '';
            }
        }

        // Criar elemento da vaca
        function createCowElement(cowId) {
            const cowsContainer = document.getElementById('cows-container');
            const cowElement = document.createElement('div');
            cowElement.className = 'cow-item';
            cowElement.id = `cow-${cowId}`;
            cowElement.onclick = () => interactWithCow(cowId);
            cowElement.innerHTML = `
                <span class="cow-emoji">üêÑ</span>
                <div class="cow-status" id="cow-status-${cowId}">Com fome</div>
                <div class="cow-timer" id="cow-timer-${cowId}"></div>
            `;
            cowsContainer.appendChild(cowElement);
        }

        // Criar elemento da galinha
        function createChickenElement(chickenId) {
            const chickensContainer = document.getElementById('chickens-container');
            const chickenElement = document.createElement('div');
            chickenElement.className = 'cow-item';
            chickenElement.id = `chicken-${chickenId}`;
            chickenElement.onclick = () => interactWithChicken(chickenId);
            chickenElement.innerHTML = `
                <span class="cow-emoji">üêî</span>
                <div class="cow-status" id="chicken-status-${chickenId}">Com fome</div>
                <div class="cow-timer" id="chicken-timer-${chickenId}"></div>
            `;
            chickensContainer.appendChild(chickenElement);
        }

        // Criar elemento do pintinho
        function createChickElement(chickId) {
            const chickensContainer = document.getElementById('chickens-container');
            const chickElement = document.createElement('div');
            chickElement.className = 'cow-item';
            chickElement.id = `chick-${chickId}`;
            chickElement.style.opacity = '0.7';
            chickElement.innerHTML = `
                <span class="cow-emoji">üê£</span>
                <div class="cow-status">Crescendo...</div>
                <div class="cow-timer">1h para adulto</div>
            `;
            chickensContainer.appendChild(chickElement);
        }

        // Criar elemento do porco
        function createPigElement(pigId) {
            const pigsContainer = document.getElementById('pigs-container');
            const pigElement = document.createElement('div');
            pigElement.className = 'cow-item';
            pigElement.id = `pig-${pigId}`;
            pigElement.onclick = () => interactWithPig(pigId);
            pigElement.innerHTML = `
                <span class="cow-emoji">üê∑</span>
                <div class="cow-status" id="pig-status-${pigId}">Com fome</div>
                <div class="cow-timer" id="pig-timer-${pigId}"></div>
            `;
            pigsContainer.appendChild(pigElement);
        }

        // Criar elemento da ovelha
        function createSheepElement(sheepId) {
            const sheepContainer = document.getElementById('sheep-container');
            const sheepElement = document.createElement('div');
            sheepElement.className = 'cow-item';
            sheepElement.id = `sheep-${sheepId}`;
            sheepElement.onclick = () => interactWithSheep(sheepId);
            sheepElement.innerHTML = `
                <span class="cow-emoji">üêë</span>
                <div class="cow-status" id="sheep-status-${sheepId}">Com fome</div>
                <div class="cow-timer" id="sheep-timer-${sheepId}"></div>
            `;
            sheepContainer.appendChild(sheepElement);
        }

        // Interagir com vaca
        function interactWithCow(cowId) {
            const cow = gameState.cows[cowId];
            
            if (cow.sick) {
                // Se est√° doente, aplicar vacina automaticamente se tiver
                if (gameState.vaccines > 0) {
                    vaccinateAnimal('cow', cowId);
                } else {
                    alert('ü§í Esta vaca est√° doente! Voc√™ precisa comprar uma vacina no mercadinho para cur√°-la.');
                }
                return;
            }
            
            // Verificar se √© inverno e se a fogueira est√° acesa
            if (gameState.currentSeason === 3 && !gameState.bonfire.lit) {
                alert('‚ùÑÔ∏è No inverno, as vacas precisam da fogueira acesa para produzir! Acenda a fogueira primeiro.');
                return;
            }
            
            if (cow.milkedToday) {
                alert('Esta vaca j√° foi ordenhada hoje! Aguarde o pr√≥ximo update (10 min).');
                return;
            }
            
            if (!cow.fed) {
                feedCow(cowId);
            } else if (cow.readyToMilk) {
                milkCow(cowId);
            }
        }

        // Interagir com galinha
        function interactWithChicken(chickenId) {
            const chicken = gameState.chickens[chickenId];
            
            if (chicken.sick) {
                // Se est√° doente, aplicar vacina automaticamente se tiver
                if (gameState.vaccines > 0) {
                    vaccinateAnimal('chicken', chickenId);
                } else {
                    alert('ü§í Esta galinha est√° doente! Voc√™ precisa comprar uma vacina no mercadinho para cur√°-la.');
                }
                return;
            }
            
            // Verificar se √© inverno e se a fogueira est√° acesa
            if (gameState.currentSeason === 3 && !gameState.bonfire.lit) {
                alert('‚ùÑÔ∏è No inverno, as galinhas precisam da fogueira acesa para produzir! Acenda a fogueira primeiro.');
                return;
            }
            
            if (!chicken.fed) {
                feedChicken(chickenId);
            } else if (chicken.readyToCollect) {
                collectEggs(chickenId);
            }
        }

        // Interagir com porco
        function interactWithPig(pigId) {
            const pig = gameState.pigs[pigId];
            
            if (pig.sick) {
                // Se est√° doente, aplicar vacina automaticamente se tiver
                if (gameState.vaccines > 0) {
                    vaccinateAnimal('pig', pigId);
                } else {
                    alert('ü§í Este porco est√° doente! Voc√™ precisa comprar uma vacina no mercadinho para cur√°-lo.');
                }
                return;
            }
            
            // Verificar se √© inverno e se a fogueira est√° acesa
            if (gameState.currentSeason === 3 && !gameState.bonfire.lit) {
                alert('‚ùÑÔ∏è No inverno, os porcos precisam da fogueira acesa para produzir! Acenda a fogueira primeiro.');
                return;
            }
            
            if (!pig.fed) {
                feedPig(pigId);
            } else if (pig.readyToCollect) {
                collectMeat(pigId);
            }
        }

        // Interagir com ovelha
        function interactWithSheep(sheepId) {
            const sheep = gameState.sheep[sheepId];
            
            if (sheep.sick) {
                // Se est√° doente, aplicar vacina automaticamente se tiver
                if (gameState.vaccines > 0) {
                    vaccinateAnimal('sheep', sheepId);
                } else {
                    alert('ü§í Esta ovelha est√° doente! Voc√™ precisa comprar uma vacina no mercadinho para cur√°-la.');
                }
                return;
            }
            
            // Verificar se √© inverno e se a fogueira est√° acesa
            if (gameState.currentSeason === 3 && !gameState.bonfire.lit) {
                alert('‚ùÑÔ∏è No inverno, as ovelhas precisam da fogueira acesa para produzir! Acenda a fogueira primeiro.');
                return;
            }
            
            if (!sheep.fed) {
                feedSheep(sheepId);
            } else if (sheep.readyToCollect) {
                collectWool(sheepId);
            }
        }

        // Alimentar vaca
        function feedCow(cowId) {
            const cow = gameState.cows[cowId];
            
            if (cow.sick) {
                alert('ü§í Esta vaca est√° doente! Use uma vacina para cur√°-la primeiro.');
                return;
            }
            
            if (cow.fed) return;
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.hay <= 0) {
                alert('Voc√™ n√£o tem feno! Fa√ßa feno no secador de grama.');
                return;
            }
            
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde 0.5 pontos (0.5% de 100)
            gameState.hay--;
            cow.fed = true;
            
            // Produzir esterco imediatamente ao alimentar
            gameState.compostMaterials.manure += 1;
            
            cow.feedTimer = setTimeout(() => {
                cow.readyToMilk = true;
                updateCowDisplay(cowId);
            }, 15000); // 15 segundos
            
            updateCowDisplay(cowId);
            startCowTimer(cowId, 15);
            updateDisplay();
            alert('Vaca alimentada! +1 esterco adicionado √† composteira.');
            showTutorial('feed-cow');
        }

        // Alimentar galinha
        function feedChicken(chickenId) {
            const chicken = gameState.chickens[chickenId];
            
            if (chicken.sick) {
                alert('ü§í Esta galinha est√° doente! Use uma vacina para cur√°-la primeiro.');
                return;
            }
            
            if (chicken.fed || chicken.laidEggsToday) return;
            
            if (gameState.feed.chicken <= 0) {
                alert('Voc√™ n√£o tem ra√ß√£o de galinha no celeiro! Fa√ßa no misturador.');
                return;
            }
            
            gameState.feed.chicken--; // Remove do celeiro
            chicken.fed = true;
            chicken.feedTimer = setTimeout(() => {
                chicken.readyToCollect = true;
                updateChickenDisplay(chickenId);
            }, 20000); // 20 segundos
            
            updateChickenDisplay(chickenId);
            startChickenTimer(chickenId, 20);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Alimentar porco
        function feedPig(pigId) {
            const pig = gameState.pigs[pigId];
            
            if (pig.sick) {
                alert('ü§í Este porco est√° doente! Use uma vacina para cur√°-lo primeiro.');
                return;
            }
            
            if (pig.fed) return;
            
            if (gameState.feed.pig <= 0) {
                alert('Voc√™ n√£o tem ra√ß√£o de porco no celeiro! Fa√ßa no misturador.');
                return;
            }
            
            gameState.feed.pig--; // Remove do celeiro
            pig.fed = true;
            pig.feedTimer = setTimeout(() => {
                pig.readyToCollect = true;
                updatePigDisplay(pigId);
            }, 20000); // 20 segundos
            
            updatePigDisplay(pigId);
            startPigTimer(pigId, 20);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Alimentar ovelha
        function feedSheep(sheepId) {
            const sheep = gameState.sheep[sheepId];
            
            if (sheep.sick) {
                alert('ü§í Esta ovelha est√° doente! Use uma vacina para cur√°-la primeiro.');
                return;
            }
            
            if (sheep.fed) return;
            
            if (gameState.hay <= 0) {
                alert('Voc√™ n√£o tem feno! Fa√ßa feno no secador de grama.');
                return;
            }
            
            gameState.hay--;
            sheep.fed = true;
            
            sheep.feedTimer = setTimeout(() => {
                sheep.readyToCollect = true;
                updateSheepDisplay(sheepId);
            }, 20000); // 20 segundos
            
            updateSheepDisplay(sheepId);
            startSheepTimer(sheepId);
            updateDisplay();
        }

        // Fiar l√£
        function spinWool() {
            if (!gameState.hasSpinningMachine) {
                alert('Voc√™ precisa comprar a m√°quina de fiar primeiro!');
                return;
            }
            
            if (gameState.isSpinning) {
                alert('J√° h√° l√£ sendo fiada! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.products.wool < 4) {
                alert('Voc√™ precisa de pelo menos 4 l√£s para fiar!');
                return;
            }
            
            gameState.products.wool -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isSpinning = true;
            
            let timeLeft = 30; // 30 segundos
            const statusElement = document.getElementById('spinning-status');
            
            const updateTimer = () => {
                statusElement.textContent = `Fiando l√£... ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isSpinning = false;
                    gameState.yarnCount += 2;
                    gameState.products.yarn += 2;
                    statusElement.textContent = '2 novelos prontos! üßµ';
                    clearInterval(gameState.spinningTimer);
                    updateDisplay();
                    alert('L√£ fiada! +2 novelos (valem mais que l√£ bruta)');
                }
            };
            
            updateTimer();
            gameState.spinningTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Moer trigo
        function millWheat() {
            if (!gameState.hasMill) {
                alert('Voc√™ precisa comprar o moinho primeiro!');
                return;
            }
            
            if (gameState.isMilling) {
                alert('J√° h√° trigo sendo mo√≠do! Aguarde terminar.');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            const wheatCount = gameState.inventory[4] || 0; // Trigo √© √≠ndice 4
            if (wheatCount < 4) {
                alert('Voc√™ precisa de pelo menos 4 trigos para moer!');
                return;
            }
            
            gameState.inventory[4] -= 4;
            gameState.energy = Math.max(0, gameState.energy - 0.5); // Perde energia
            gameState.isMilling = true;
            
            let timeLeft = 60; // 1 minuto
            const statusElement = document.getElementById('mill-status');
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                statusElement.textContent = `Moendo trigo... ${minutes}:${seconds.toString().padStart(2, '0')}`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    gameState.isMilling = false;
                    gameState.products.flour += 2;
                    statusElement.textContent = '2 pacotes de farinha prontos! üçö';
                    clearInterval(gameState.millingTimer);
                    updateDisplay();
                    alert('Trigo mo√≠do! +2 pacotes de farinha');
                }
            };
            
            updateTimer();
            gameState.millingTimer = setInterval(updateTimer, 1000);
            updateDisplay();
        }

        // Coletar mel
        function collectHoney() {
            if (!gameState.hasBeehive) {
                alert('Voc√™ precisa comprar a colmeia primeiro!');
                return;
            }
            
            if (!gameState.canCollectHoney) {
                alert('O mel ainda n√£o est√° pronto! As abelhas produzem mel a cada 20 minutos.');
                return;
            }
            
            gameState.products.honey += 2;
            gameState.honeyAvailable = 0;
            gameState.canCollectHoney = false;
            
            // Anima√ß√£o da colmeia
            const beehive = document.getElementById('beehive-display');
            beehive.style.transform = 'scale(1.1)';
            setTimeout(() => {
                beehive.style.transform = 'scale(1)';
            }, 200);
            
            updateDisplay();
            alert('Mel coletado! +2 potes de mel (pr√≥xima coleta no pr√≥ximo update)');
        }

        // Ordenhar vaca
        function milkCow(cowId) {
            const cow = gameState.cows[cowId];
            
            if (!cow.readyToMilk || cow.isBeingMilked) return;
            
            cow.isBeingMilked = true;
            cow.milkingProgress = 0;
            
            // Processo de ordenha de 12 segundos
            const milkingInterval = setInterval(() => {
                cow.milkingProgress += 100/12; // 12 segundos
                
                if (cow.milkingProgress >= 100) {
                    cow.milkingProgress = 100;
                    cow.isBeingMilked = false;
                    
                    gameState.products.milk += 3;
                    cow.fed = false;
                    cow.readyToMilk = false;
                    cow.milkedToday = true;
                    
                    if (cow.feedTimer) {
                        clearTimeout(cow.feedTimer);
                        cow.feedTimer = null;
                    }
                    
                    clearInterval(milkingInterval);
                    updateCowDisplay(cowId);
                    updateDisplay();
                    alert('Vaca ordenhada! +3 leites (pr√≥xima ordenha no pr√≥ximo update)');
                }
                
                updateCowDisplay(cowId);
            }, 1000);
        }

        // Coletar ovos
        function collectEggs(chickenId) {
            const chicken = gameState.chickens[chickenId];
            
            if (!chicken.readyToCollect) return;
            
            gameState.products.eggs += 3; // 3 ovos por dia
            chicken.fed = false;
            chicken.readyToCollect = false;
            chicken.laidEggsToday = true; // Marca que botou ovos hoje
            
            if (chicken.feedTimer) {
                clearTimeout(chicken.feedTimer);
                chicken.feedTimer = null;
            }
            
            updateChickenDisplay(chickenId);
            updateDisplay();
            alert('Ovos coletados! +3 ovos (pr√≥xima postura no pr√≥ximo update)');
        }

        // Coletar carne
        function collectMeat(pigId) {
            const pig = gameState.pigs[pigId];
            
            if (!pig.readyToCollect) return;
            
            gameState.products.meat += 1;
            pig.fed = false;
            pig.readyToCollect = false;
            
            if (pig.feedTimer) {
                clearTimeout(pig.feedTimer);
                pig.feedTimer = null;
            }
            
            updatePigDisplay(pigId);
            updateDisplay();
            alert('Carne coletada! +1 carne');
        }

        // Coletar l√£ (tosquiar)
        function collectWool(sheepId) {
            const sheep = gameState.sheep[sheepId];
            
            // Animais doentes n√£o produzem
            if (sheep.sick) {
                alert('ü§í Esta ovelha est√° doente! Vacine-a primeiro para ela voltar a produzir l√£.');
                return;
            }
            
            if (!sheep.readyToCollect || sheep.isBeingSheared) return;
            
            sheep.isBeingSheared = true;
            sheep.shearingProgress = 0;
            
            // Processo de tosquia de 12 segundos
            const shearingInterval = setInterval(() => {
                sheep.shearingProgress += 100/12; // 12 segundos
                
                if (sheep.shearingProgress >= 100) {
                    sheep.shearingProgress = 100;
                    sheep.isBeingSheared = false;
                    
                    gameState.products.wool += 2;
                    sheep.fed = false;
                    sheep.readyToCollect = false;
                    
                    if (sheep.feedTimer) {
                        clearTimeout(sheep.feedTimer);
                        sheep.feedTimer = null;
                    }
                    
                    clearInterval(shearingInterval);
                    updateSheepDisplay(sheepId);
                    updateDisplay();
                    alert('L√£ coletada! +2 l√£s (tosquia completa)');
                }
                
                updateSheepDisplay(sheepId);
            }, 1000);
        }

        // Alimentar todas as vacas
        function feedAllCows() {
            let fedCount = 0;
            gameState.cows.forEach((cow, index) => {
                if (!cow.fed && !cow.milkedToday && gameState.hay > 0) {
                    feedCow(index);
                    fedCount++;
                }
            });
            
            if (fedCount === 0) {
                alert('Nenhuma vaca pode ser alimentada (sem feno ou j√° alimentadas)!');
            }
        }

        // Ordenhar todas as vacas
        function milkAllCows() {
            let totalMilk = 0;
            gameState.cows.forEach((cow, index) => {
                if (cow.readyToMilk && !cow.milkedToday && !cow.sick) {
                    totalMilk += 3;
                    milkCow(index);
                }
            });
            
            if (totalMilk > 0) {
                alert(`Todas as vacas ordenhadas! +${totalMilk} leites`);
            } else {
                alert('Nenhuma vaca est√° pronta para ordenhar (podem estar doentes)!');
            }
        }

        // Alimentar todas as galinhas
        function feedAllChickens() {
            let fedCount = 0;
            gameState.chickens.forEach((chicken, index) => {
                if (!chicken.fed && !chicken.sick && gameState.feed.chicken > 0) {
                    feedChicken(index);
                    fedCount++;
                }
            });
            
            if (fedCount === 0) {
                alert('Nenhuma galinha pode ser alimentada (sem ra√ß√£o no celeiro, j√° alimentadas ou doentes)!');
            }
        }

        // Coletar todos os ovos
        function collectAllEggs() {
            let totalEggs = 0;
            gameState.chickens.forEach((chicken, index) => {
                if (chicken.readyToCollect && !chicken.sick) {
                    totalEggs += 3;
                    collectEggs(index);
                }
            });
            
            if (totalEggs > 0) {
                alert(`Todos os ovos coletados! +${totalEggs} ovos`);
            } else {
                alert('Nenhuma galinha est√° pronta para coleta (podem estar doentes)!');
            }
        }

        // Alimentar todos os porcos
        function feedAllPigs() {
            let fedCount = 0;
            gameState.pigs.forEach((pig, index) => {
                if (!pig.fed && !pig.sick && gameState.feed.pig > 0) {
                    feedPig(index);
                    fedCount++;
                }
            });
            
            if (fedCount === 0) {
                alert('Nenhum porco pode ser alimentado (sem ra√ß√£o no celeiro, j√° alimentados ou doentes)!');
            }
        }

        // Coletar toda a carne
        function collectAllMeat() {
            let totalMeat = 0;
            gameState.pigs.forEach((pig, index) => {
                if (pig.readyToCollect && !pig.sick) {
                    totalMeat += 1;
                    collectMeat(index);
                }
            });
            
            if (totalMeat > 0) {
                alert(`Toda a carne coletada! +${totalMeat} carnes`);
            } else {
                alert('Nenhum porco est√° pronto para coleta (podem estar doentes)!');
            }
        }

        // Alimentar todas as ovelhas
        function feedAllSheep() {
            let fedCount = 0;
            gameState.sheep.forEach((sheep, index) => {
                if (!sheep.fed && sheep.canFeedToday && !sheep.sick && gameState.hay > 0) {
                    feedSheep(index);
                    fedCount++;
                }
            });
            
            if (fedCount === 0) {
                alert('Nenhuma ovelha pode ser alimentada (sem feno, j√° alimentadas, doentes ou n√£o √© o dia permitido)!');
            }
        }

        // Coletar toda a l√£
        function collectAllWool() {
            let totalWool = 0;
            gameState.sheep.forEach((sheep, index) => {
                if (sheep.readyToCollect && !sheep.sick) {
                    totalWool += 2;
                    collectWool(index);
                }
            });
            
            if (totalWool > 0) {
                alert(`Toda a l√£ coletada! +${totalWool} l√£s`);
            } else {
                alert('Nenhuma ovelha est√° pronta para coleta (podem estar doentes)!');
            }
        }

        // Vacinar animal
        function vaccinateAnimal(animalType, animalId) {
            if (gameState.vaccines <= 0) {
                alert('Voc√™ n√£o tem vacinas! Compre no mercadinho.');
                return;
            }
            
            let animal = null;
            let animalName = '';
            
            if (animalType === 'cow') {
                animal = gameState.cows[animalId];
                animalName = 'vaca';
            } else if (animalType === 'chicken') {
                animal = gameState.chickens[animalId];
                animalName = 'galinha';
            } else if (animalType === 'pig') {
                animal = gameState.pigs[animalId];
                animalName = 'porco';
            } else if (animalType === 'sheep') {
                animal = gameState.sheep[animalId];
                animalName = 'ovelha';
            }
            
            if (!animal || !animal.sick) {
                alert('Este animal n√£o est√° doente!');
                return;
            }
            
            gameState.vaccines--;
            animal.sick = false;
            animal.sickTime = null;
            
            // Cancelar timer de morte se existir
            if (animal.deathTimer) {
                clearTimeout(animal.deathTimer);
                animal.deathTimer = null;
            }
            
            // Atualizar display do animal
            if (animalType === 'cow') updateCowDisplay(animalId);
            else if (animalType === 'chicken') updateChickenDisplay(animalId);
            else if (animalType === 'pig') updatePigDisplay(animalId);
            else if (animalType === 'sheep') updateSheepDisplay(animalId);
            
            updateDisplay();
            alert(`üíâ ${animalName.charAt(0).toUpperCase() + animalName.slice(1)} curada! Agora pode voltar a produzir.`);
        }

        // Sistema de doen√ßas - fazer um animal ficar doente
        function makeAnimalSick() {
            // Coletar todos os animais saud√°veis
            let healthyAnimals = [];
            
            gameState.cows.forEach((cow, index) => {
                if (!cow.sick) {
                    healthyAnimals.push({ type: 'cow', id: index, animal: cow });
                }
            });
            
            gameState.chickens.forEach((chicken, index) => {
                if (!chicken.sick) {
                    healthyAnimals.push({ type: 'chicken', id: index, animal: chicken });
                }
            });
            
            gameState.pigs.forEach((pig, index) => {
                if (!pig.sick) {
                    healthyAnimals.push({ type: 'pig', id: index, animal: pig });
                }
            });
            
            gameState.sheep.forEach((sheep, index) => {
                if (!sheep.sick) {
                    healthyAnimals.push({ type: 'sheep', id: index, animal: sheep });
                }
            });
            
            // Se n√£o h√° animais ou todos j√° est√£o doentes, n√£o fazer nada
            if (healthyAnimals.length === 0) return;
            
            // 30% de chance de um animal ficar doente a cada update (10 min)
            if (Math.random() < 0.3) {
                const randomAnimal = healthyAnimals[Math.floor(Math.random() * healthyAnimals.length)];
                randomAnimal.animal.sick = true;
                randomAnimal.animal.sickTime = Date.now(); // Marcar quando ficou doente
                
                // Limpar timers e estados do animal doente
                if (randomAnimal.animal.feedTimer) {
                    clearTimeout(randomAnimal.animal.feedTimer);
                    randomAnimal.animal.feedTimer = null;
                }
                randomAnimal.animal.fed = false;
                randomAnimal.animal.readyToCollect = false;
                randomAnimal.animal.readyToMilk = false;
                
                // Iniciar timer de morte (22 minutos = 1320000ms)
                randomAnimal.animal.deathTimer = setTimeout(() => {
                    killSickAnimal(randomAnimal.type, randomAnimal.id);
                }, 1320000);
                
                // Atualizar display
                if (randomAnimal.type === 'cow') updateCowDisplay(randomAnimal.id);
                else if (randomAnimal.type === 'chicken') updateChickenDisplay(randomAnimal.id);
                else if (randomAnimal.type === 'pig') updatePigDisplay(randomAnimal.id);
                else if (randomAnimal.type === 'sheep') updateSheepDisplay(randomAnimal.id);
                
                const animalNames = {
                    cow: 'vaca',
                    chicken: 'galinha', 
                    pig: 'porco',
                    sheep: 'ovelha'
                };
                
                alert(`ü§í Uma ${animalNames[randomAnimal.type]} ficou doente! Use uma vacina para cur√°-la em at√© 22 minutos ou ela morrer√°!`);
            }
        }

        // Matar animal doente que n√£o foi vacinado a tempo
        function killSickAnimal(animalType, animalId) {
            const animalNames = {
                cow: 'vaca',
                chicken: 'galinha',
                pig: 'porco', 
                sheep: 'ovelha'
            };
            
            const animalEmojis = {
                cow: 'üêÑ',
                chicken: 'üêî',
                pig: 'üê∑',
                sheep: 'üêë'
            };
            
            // Remover animal do array correspondente
            if (animalType === 'cow') {
                const cow = gameState.cows[animalId];
                if (cow && cow.sick) {
                    gameState.cows.splice(animalId, 1);
                    // Remover elemento visual
                    const cowElement = document.getElementById(`cow-${animalId}`);
                    if (cowElement) cowElement.remove();
                    // Recriar elementos com IDs corretos
                    recreateAnimalElements('cow');
                }
            } else if (animalType === 'chicken') {
                const chicken = gameState.chickens[animalId];
                if (chicken && chicken.sick) {
                    gameState.chickens.splice(animalId, 1);
                    const chickenElement = document.getElementById(`chicken-${animalId}`);
                    if (chickenElement) chickenElement.remove();
                    recreateAnimalElements('chicken');
                }
            } else if (animalType === 'pig') {
                const pig = gameState.pigs[animalId];
                if (pig && pig.sick) {
                    gameState.pigs.splice(animalId, 1);
                    const pigElement = document.getElementById(`pig-${animalId}`);
                    if (pigElement) pigElement.remove();
                    recreateAnimalElements('pig');
                }
            } else if (animalType === 'sheep') {
                const sheep = gameState.sheep[animalId];
                if (sheep && sheep.sick) {
                    gameState.sheep.splice(animalId, 1);
                    const sheepElement = document.getElementById(`sheep-${animalId}`);
                    if (sheepElement) sheepElement.remove();
                    recreateAnimalElements('sheep');
                }
            }
            
            updateDisplay();
            alert(`üíÄ A ${animalNames[animalType]} morreu por falta de tratamento! ${animalEmojis[animalType]} Voc√™ precisar√° comprar um novo animal.`);
        }

        // Recriar elementos dos animais com IDs corretos ap√≥s morte
        function recreateAnimalElements(animalType) {
            if (animalType === 'cow') {
                const container = document.getElementById('cows-container');
                container.innerHTML = '';
                gameState.cows.forEach((cow, index) => {
                    cow.id = index; // Atualizar ID
                    createCowElement(index);
                    updateCowDisplay(index);
                });
            } else if (animalType === 'chicken') {
                const container = document.getElementById('chickens-container');
                // Manter pintinhos, remover apenas galinhas
                const chicks = container.querySelectorAll('[id^="chick-"]');
                container.innerHTML = '';
                // Recriar pintinhos
                chicks.forEach(chick => container.appendChild(chick));
                // Recriar galinhas
                gameState.chickens.forEach((chicken, index) => {
                    chicken.id = index;
                    createChickenElement(index);
                    updateChickenDisplay(index);
                });
            } else if (animalType === 'pig') {
                const container = document.getElementById('pigs-container');
                container.innerHTML = '';
                gameState.pigs.forEach((pig, index) => {
                    pig.id = index;
                    createPigElement(index);
                    updatePigDisplay(index);
                });
            } else if (animalType === 'sheep') {
                const container = document.getElementById('sheep-container');
                container.innerHTML = '';
                gameState.sheep.forEach((sheep, index) => {
                    sheep.id = index;
                    createSheepElement(index);
                    updateSheepDisplay(index);
                });
            }
        }

        // Atualizar display da vaca
        function updateCowDisplay(cowId) {
            const cow = gameState.cows[cowId];
            const cowElement = document.getElementById(`cow-${cowId}`);
            const statusElement = document.getElementById(`cow-status-${cowId}`);
            const timerElement = document.getElementById(`cow-timer-${cowId}`);
            
            cowElement.className = 'cow-item';
            
            if (cow.sick) {
                cowElement.classList.add('sick');
                statusElement.textContent = 'ü§í Doente!';
                
                // Mostrar countdown de morte
                if (cow.sickTime) {
                    const timeLeft = Math.max(0, 1320000 - (Date.now() - cow.sickTime)); // 22 minutos
                    const minutesLeft = Math.floor(timeLeft / 60000);
                    const secondsLeft = Math.floor((timeLeft % 60000) / 1000);
                    timerElement.textContent = `üíÄ ${minutesLeft}:${secondsLeft.toString().padStart(2, '0')}`;
                    timerElement.style.color = '#FF0000';
                }
                
                cowElement.onclick = () => vaccinateAnimal('cow', cowId);
            } else if (cow.isBeingMilked) {
                cowElement.classList.add('fed');
                statusElement.textContent = `Ordenhando... ${Math.floor(cow.milkingProgress)}%`;
                timerElement.style.color = '#666';
                cowElement.onclick = () => interactWithCow(cowId);
            } else if (cow.milkedToday) {
                statusElement.textContent = 'Ordenhada hoje';
                timerElement.style.color = '#666';
                cowElement.onclick = () => interactWithCow(cowId);
            } else if (cow.readyToMilk) {
                cowElement.classList.add('ready-to-milk');
                statusElement.textContent = 'Pronta para ordenha!';
                timerElement.style.color = '#666';
                cowElement.onclick = () => interactWithCow(cowId);
            } else if (cow.fed) {
                cowElement.classList.add('fed');
                statusElement.textContent = 'Alimentada';
                timerElement.style.color = '#666';
                cowElement.onclick = () => interactWithCow(cowId);
            } else {
                statusElement.textContent = 'Com fome';
                timerElement.style.color = '#666';
                cowElement.onclick = () => interactWithCow(cowId);
            }
        }

        // Atualizar display da galinha
        function updateChickenDisplay(chickenId) {
            const chicken = gameState.chickens[chickenId];
            const chickenElement = document.getElementById(`chicken-${chickenId}`);
            const statusElement = document.getElementById(`chicken-status-${chickenId}`);
            const timerElement = document.getElementById(`chicken-timer-${chickenId}`);
            
            chickenElement.className = 'cow-item';
            
            if (chicken.sick) {
                chickenElement.classList.add('sick');
                statusElement.textContent = 'ü§í Doente!';
                
                // Mostrar countdown de morte
                if (chicken.sickTime) {
                    const timeLeft = Math.max(0, 1320000 - (Date.now() - chicken.sickTime)); // 22 minutos
                    const minutesLeft = Math.floor(timeLeft / 60000);
                    const secondsLeft = Math.floor((timeLeft % 60000) / 1000);
                    timerElement.textContent = `üíÄ ${minutesLeft}:${secondsLeft.toString().padStart(2, '0')}`;
                    timerElement.style.color = '#FF0000';
                }
                
                chickenElement.onclick = () => vaccinateAnimal('chicken', chickenId);
            } else if (chicken.laidEggsToday) {
                statusElement.textContent = 'Botou ovos hoje';
                timerElement.style.color = '#666';
                chickenElement.onclick = () => interactWithChicken(chickenId);
            } else if (chicken.readyToCollect) {
                chickenElement.classList.add('ready-to-milk');
                statusElement.textContent = 'Pronta! (3 ovos)';
                timerElement.style.color = '#666';
                chickenElement.onclick = () => interactWithChicken(chickenId);
            } else if (chicken.fed) {
                chickenElement.classList.add('fed');
                statusElement.textContent = 'Alimentada';
                timerElement.style.color = '#666';
                chickenElement.onclick = () => interactWithChicken(chickenId);
            } else {
                statusElement.textContent = 'Com fome';
                timerElement.style.color = '#666';
                chickenElement.onclick = () => interactWithChicken(chickenId);
            }
        }

        // Atualizar display do porco
        function updatePigDisplay(pigId) {
            const pig = gameState.pigs[pigId];
            const pigElement = document.getElementById(`pig-${pigId}`);
            const statusElement = document.getElementById(`pig-status-${pigId}`);
            const timerElement = document.getElementById(`pig-timer-${pigId}`);
            
            pigElement.className = 'cow-item';
            
            if (pig.sick) {
                pigElement.classList.add('sick');
                statusElement.textContent = 'ü§í Doente!';
                
                // Mostrar countdown de morte
                if (pig.sickTime) {
                    const timeLeft = Math.max(0, 1320000 - (Date.now() - pig.sickTime)); // 22 minutos
                    const minutesLeft = Math.floor(timeLeft / 60000);
                    const secondsLeft = Math.floor((timeLeft % 60000) / 1000);
                    timerElement.textContent = `üíÄ ${minutesLeft}:${secondsLeft.toString().padStart(2, '0')}`;
                    timerElement.style.color = '#FF0000';
                }
                
                pigElement.onclick = () => vaccinateAnimal('pig', pigId);
            } else if (pig.readyToCollect) {
                pigElement.classList.add('ready-to-milk');
                statusElement.textContent = 'Pronto! (1 carne)';
                timerElement.style.color = '#666';
                pigElement.onclick = () => interactWithPig(pigId);
            } else if (pig.fed) {
                pigElement.classList.add('fed');
                statusElement.textContent = 'Alimentado';
                timerElement.style.color = '#666';
                pigElement.onclick = () => interactWithPig(pigId);
            } else {
                statusElement.textContent = 'Com fome';
                timerElement.style.color = '#666';
                pigElement.onclick = () => interactWithPig(pigId);
            }
        }

        // Atualizar display da ovelha
        function updateSheepDisplay(sheepId) {
            const sheep = gameState.sheep[sheepId];
            const sheepElement = document.getElementById(`sheep-${sheepId}`);
            const statusElement = document.getElementById(`sheep-status-${sheepId}`);
            const timerElement = document.getElementById(`sheep-timer-${sheepId}`);
            
            sheepElement.className = 'cow-item';
            
            if (sheep.sick) {
                sheepElement.classList.add('sick');
                statusElement.textContent = 'ü§í Doente!';
                
                // Mostrar countdown de morte
                if (sheep.sickTime) {
                    const timeLeft = Math.max(0, 1320000 - (Date.now() - sheep.sickTime)); // 22 minutos
                    const minutesLeft = Math.floor(timeLeft / 60000);
                    const secondsLeft = Math.floor((timeLeft % 60000) / 1000);
                    timerElement.textContent = `üíÄ ${minutesLeft}:${secondsLeft.toString().padStart(2, '0')}`;
                    timerElement.style.color = '#FF0000';
                }
                
                sheepElement.onclick = () => vaccinateAnimal('sheep', sheepId);
            } else if (sheep.readyToCollect) {
                sheepElement.classList.add('ready-to-milk');
                statusElement.textContent = 'Pronta!';
                timerElement.style.color = '#666';
                sheepElement.onclick = () => interactWithSheep(sheepId);
            } else if (sheep.fed) {
                sheepElement.classList.add('fed');
                statusElement.textContent = 'Alimentada';
                timerElement.style.color = '#666';
                sheepElement.onclick = () => interactWithSheep(sheepId);
            } else {
                statusElement.textContent = 'Com fome';
                timerElement.style.color = '#666';
                sheepElement.onclick = () => interactWithSheep(sheepId);
            }
        }

        // Timer da vaca
        function startCowTimer(cowId, duration) {
            const cow = gameState.cows[cowId];
            let timeLeft = duration;
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                const timerElement = document.getElementById(`cow-timer-${cowId}`);
                if (timerElement) {
                    timerElement.textContent = `${timeLeft}s`;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (timerElement) {
                        timerElement.textContent = '';
                    }
                }
            }, 1000);
        }

        // Timer da galinha
        function startChickenTimer(chickenId, duration) {
            const chicken = gameState.chickens[chickenId];
            let timeLeft = duration;
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                const timerElement = document.getElementById(`chicken-timer-${chickenId}`);
                if (timerElement) {
                    timerElement.textContent = `${timeLeft}s`;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (timerElement) {
                        timerElement.textContent = '';
                    }
                }
            }, 1000);
        }

        // Timer do porco
        function startPigTimer(pigId, duration) {
            const pig = gameState.pigs[pigId];
            let timeLeft = duration;
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                const timerElement = document.getElementById(`pig-timer-${pigId}`);
                if (timerElement) {
                    timerElement.textContent = `${timeLeft}s`;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (timerElement) {
                        timerElement.textContent = '';
                    }
                }
            }, 1000);
        }

        // Timer da ovelha
        function startSheepTimer(sheepId) {
            const sheep = gameState.sheep[sheepId];
            let timeLeft = 20;
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                const timerElement = document.getElementById(`sheep-timer-${sheepId}`);
                if (timerElement) {
                    timerElement.textContent = `${timeLeft}s`;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (timerElement) {
                        timerElement.textContent = '';
                    }
                }
            }, 1000);
        }

        // Produzir produtos da fazenda
        function produceProducts() {
            // Produzir produtos aleatoriamente
            gameState.products.honey += Math.floor(Math.random() * 2) + 1;
            gameState.products.wool += Math.floor(Math.random() * 2) + 1;
            
            updateDisplay();
            alert('Produtos produzidos!');
        }

        // Vender produto individual
        function sellProduct(productType) {
            if (gameState.products[productType] <= 0) {
                alert(`Voc√™ n√£o tem ${getProductEmoji(productType)} para vender!`);
                return;
            }
            
            const price = productPrices[productType];
            gameState.products[productType]--;
            gameState.money += price;
            updateDisplay();
            alert(`${getProductEmoji(productType)} vendido por ${price} moedas!`);
        }

        // Vender frutas
        function sellFruit(fruitType) {
            const fruitPrices = {
                banana: 8,
                apple: 10,
                orange: 9
            };
            
            const fruitEmojis = {
                banana: 'üçå',
                apple: 'üçé',
                orange: 'üçä'
            };
            
            const fruitNames = {
                banana: 'bananas',
                apple: 'apples',
                orange: 'oranges'
            };
            
            const count = gameState[fruitNames[fruitType]] || 0;
            if (count <= 0) {
                alert(`Voc√™ n√£o tem ${fruitEmojis[fruitType]} para vender!`);
                return;
            }
            
            const price = fruitPrices[fruitType];
            gameState[fruitNames[fruitType]]--;
            gameState.money += price;
            updateDisplay();
            alert(`${fruitEmojis[fruitType]} vendido por ${price} moedas!`);
        }

        // Vender itens do invent√°rio
        function sellInventoryItem(seedIndex) {
            const count = gameState.inventory[seedIndex] || 0;
            if (count <= 0) {
                alert(`Voc√™ n√£o tem ${seeds[seedIndex].emoji} para vender!`);
                return;
            }
            
            let price = seeds[seedIndex].sellPrice;
            let bonusMessage = '';
            
            // B√¥nus da primavera: +50% no valor de venda
            if (gameState.currentSeason === 0) {
                price = Math.floor(price * 1.5);
                bonusMessage = ' ‚ú® (B√¥nus da primavera: +50%)';
            }
            
            gameState.inventory[seedIndex]--;
            gameState.money += price;
            updateDisplay();
            alert(`${seeds[seedIndex].emoji} vendido por ${price} moedas!${bonusMessage}`);
            showTutorial('sell-products');
        }

        // Vender todos os produtos
        function sellAllProducts() {
            let totalEarnings = 0;
            let soldItems = [];
            
            // Vender produtos da fazenda
            Object.keys(gameState.products).forEach(product => {
                if (gameState.products[product] > 0) {
                    const earnings = gameState.products[product] * productPrices[product];
                    totalEarnings += earnings;
                    soldItems.push(`${gameState.products[product]} ${getProductEmoji(product)}`);
                    gameState.products[product] = 0;
                }
            });
            
            // Vender frutas
            const fruits = [
                { key: 'bananas', emoji: 'üçå', price: 8 },
                { key: 'apples', emoji: 'üçé', price: 10 },
                { key: 'oranges', emoji: 'üçä', price: 9 }
            ];
            
            fruits.forEach(fruit => {
                const count = gameState[fruit.key] || 0;
                if (count > 0) {
                    const earnings = count * fruit.price;
                    totalEarnings += earnings;
                    soldItems.push(`${count} ${fruit.emoji}`);
                    gameState[fruit.key] = 0;
                }
            });
            
            // Vender vegetais do invent√°rio
            seeds.forEach((seed, index) => {
                const count = gameState.inventory[index] || 0;
                if (count > 0) {
                    let price = seed.sellPrice;
                    let bonusText = '';
                    
                    // B√¥nus da primavera: +50% no valor de venda
                    if (gameState.currentSeason === 0) {
                        price = Math.floor(price * 1.5);
                        bonusText = ' ‚ú®';
                    }
                    
                    const earnings = count * price;
                    totalEarnings += earnings;
                    soldItems.push(`${count} ${seed.emoji}${bonusText}`);
                    gameState.inventory[index] = 0;
                }
            });
            
            // Vender tesouros da Mocinha
            const treasures = [
                { key: 'cd', emoji: 'üíø', price: 80 },
                { key: 'bottle', emoji: 'üçº', price: 60 },
                { key: 'shoe', emoji: 'üëü', price: 70 },
                { key: 'ball', emoji: '‚öΩ', price: 90 }
            ];
            
            treasures.forEach(treasure => {
                const count = gameState.treasures[treasure.key] || 0;
                if (count > 0) {
                    const earnings = count * treasure.price;
                    totalEarnings += earnings;
                    soldItems.push(`${count} ${treasure.emoji}`);
                    gameState.treasures[treasure.key] = 0;
                }
            });
            
            // Vender pedras preciosas
            const gems = [
                { key: 'ruby', emoji: 'üíé', price: 150 },
                { key: 'emerald', emoji: 'üíö', price: 200 },
                { key: 'sapphire', emoji: 'üíô', price: 180 }
            ];
            
            gems.forEach(gem => {
                const count = gameState.gems[gem.key] || 0;
                if (count > 0) {
                    const earnings = count * gem.price;
                    totalEarnings += earnings;
                    soldItems.push(`${count} ${gem.emoji}`);
                    gameState.gems[gem.key] = 0;
                }
            });
            
            // Vender p√©rolas
            if (gameState.pearls > 0) {
                const earnings = gameState.pearls * 250;
                totalEarnings += earnings;
                soldItems.push(`${gameState.pearls} ü¶™`);
                gameState.pearls = 0;
            }
            
            if (totalEarnings > 0) {
                gameState.money += totalEarnings;
                updateDisplay();
                
                let message = `üí∞ Tudo vendido por ${totalEarnings} moedas!`;
                
                if (gameState.currentSeason === 0) {
                    message += ` ‚ú® (B√¥nus da primavera aplicado!)`;
                }
                
                alert(message);
            } else {
                alert('Voc√™ n√£o tem produtos para vender!');
            }
        }

        // Obter emoji do produto
        function getProductEmoji(product) {
            const emojis = {
                milk: 'ü•õ',
                eggs: 'ü•ö',
                coffee: '‚òï',
                wool: 'üß∂',
                flour: 'üåæ',
                honey: 'üçØ',
                meat: 'ü•©',
                juice: 'üç∑',
                cheese: 'üßÄ',
                yarn: 'üßµ',
                bread: 'üçû',
                rawChicken: 'üçó',
                fish: 'üêü'
            };
            return emojis[product] || '';
        }

        // Atualizar display do canteiro
        function updatePlotDisplay(plotIndex) {
            const plot = gameState.plots[plotIndex];
            const plotElement = document.querySelectorAll('.plot')[plotIndex];
            const contentElement = document.getElementById(`plot-content-${plotIndex}`);
            const statusElement = document.getElementById(`plot-status-${plotIndex}`);
            const progressElement = document.getElementById(`progress-${plotIndex}`);
            
            // Atualizar classe do canteiro
            plotElement.className = 'plot';
            if (plot.fertilized) plotElement.classList.add('fertilized');
            if (plot.watered) plotElement.classList.add('watered');
            if (plot.planted && plot.growthProgress > 0) plotElement.classList.add('growing');
            
            // Atualizar conte√∫do
            if (plot.readyToHarvest) {
                contentElement.textContent = seeds[plot.seedType].emoji;
                statusElement.textContent = 'Pronto!';
            } else if (plot.planted) {
                contentElement.textContent = plot.watered ? 'üå±' : seeds[plot.seedType].emoji;
                statusElement.textContent = plot.watered ? 'Crescendo...' : 'Precisa regar';
            } else if (plot.fertilized) {
                contentElement.textContent = 'üå±';
                statusElement.textContent = 'Adubado';
            } else {
                contentElement.textContent = 'üå±';
                statusElement.textContent = 'Vazio';
            }
            
            // Atualizar barra de progresso
            progressElement.style.width = `${plot.growthProgress}%`;
        }

        // Atualizar display geral
        function updateDisplay() {
            document.getElementById('money').textContent = gameState.money;
            document.getElementById('water').textContent = gameState.water;
            document.getElementById('fertilizer').textContent = gameState.fertilizer;
            document.getElementById('energy').textContent = gameState.energy;
            document.getElementById('day-counter').textContent = gameState.dayCount;
            
            // Atualizar barra de energia
            const energyBar = document.getElementById('energy-bar');
            const energyDisplay = document.getElementById('energy-display');
            const avatarDisplay = document.getElementById('avatar-display');
            
            if (energyBar) {
                energyBar.style.width = `${gameState.energy}%`;
            }
            if (energyDisplay) {
                energyDisplay.textContent = gameState.energy;
            }
            
            // Mudar apar√™ncia do avatar baseado na energia (agora de 100)
            if (gameState.isNight) {
                avatarDisplay.textContent = 'üò¥';
                updateAvatarStatus('Dormindo... Zzz');
            } else if (gameState.isResting) {
                avatarDisplay.textContent = 'üò¥';
                updateAvatarStatus('Descansando...');
            } else if (gameState.energy <= 0) {
                avatarDisplay.textContent = 'üòµ';
                updateAvatarStatus('Exausta! Precisa descansar.');
            } else if (gameState.energy <= 20) {
                avatarDisplay.textContent = 'üò∞';
                updateAvatarStatus('Muito cansada');
            } else if (gameState.energy <= 50) {
                avatarDisplay.textContent = 'üòÖ';
                updateAvatarStatus('Cansada');
            } else if (gameState.energy <= 80) {
                avatarDisplay.textContent = 'üôÇ';
                updateAvatarStatus('Bem disposta');
            } else {
                avatarDisplay.textContent = 'üë©‚Äçüåæ';
                updateAvatarStatus('Energizada e pronta!');
            }
            
            // Atualizar materiais da composteira
            if (gameState.hasCompost) {
                document.getElementById('flowers').textContent = gameState.compostMaterials.flowers;
                document.getElementById('branches').textContent = gameState.compostMaterials.branches;
                document.getElementById('manure').textContent = gameState.compostMaterials.manure;
            }
            
            // Atualizar campo de grama
            if (gameState.hasGrassField) {
                document.getElementById('grass-collected').textContent = gameState.grassCollected;
                document.getElementById('flower-inventory').textContent = gameState.compostMaterials.flowers;
            }
            
            // Atualizar secador
            if (gameState.hasDryer) {
                document.getElementById('fresh-grass').textContent = gameState.freshGrass;
                document.getElementById('dried-grass').textContent = gameState.driedGrass;
                document.getElementById('hay-count').textContent = gameState.hay;
            }
            
            // Atualizar ra√ß√µes no celeiro
            const chickenFeedCeleiro = document.getElementById('chicken-feed-celeiro');
            const pigFeedCeleiro = document.getElementById('pig-feed-celeiro');
            if (chickenFeedCeleiro) chickenFeedCeleiro.textContent = gameState.feed.chicken;
            if (pigFeedCeleiro) pigFeedCeleiro.textContent = gameState.feed.pig;
            
            // Atualizar comidas no celeiro
            const saladCeleiro = document.getElementById('salad-celeiro');
            const stewCeleiro = document.getElementById('stew-celeiro');
            const steakCeleiro = document.getElementById('steak-celeiro');
            const bakedFishCeleiro = document.getElementById('baked-fish-celeiro');
            if (saladCeleiro) saladCeleiro.textContent = gameState.food.salad;
            if (stewCeleiro) stewCeleiro.textContent = gameState.food.stew;
            if (steakCeleiro) steakCeleiro.textContent = gameState.food.steak || 0;
            if (bakedFishCeleiro) bakedFishCeleiro.textContent = gameState.food.bakedFish || 0;
            
            // Atualizar pasto das vacas
            if (gameState.hasPasture) {
                document.getElementById('cow-count').textContent = gameState.cows.length;
                const availableMilk = gameState.cows.filter(cow => cow.readyToMilk && !cow.milkedToday).length * 3;
                document.getElementById('available-milk').textContent = availableMilk;
            }
            
            // Atualizar galinheiro
            if (gameState.hasChickenCoop) {
                document.getElementById('chicken-count').textContent = gameState.chickens.length;
                document.getElementById('chick-count').textContent = gameState.chicks.length;
                document.getElementById('raw-chicken-count').textContent = gameState.products.rawChicken;
                const availableEggs = gameState.chickens.filter(chicken => chicken.readyToCollect).length * 2;
                document.getElementById('available-eggs').textContent = availableEggs;
            }
            
            // Atualizar chiqueiro
            if (gameState.hasPigPen) {
                document.getElementById('pig-count').textContent = gameState.pigs.length;
                const availableMeat = gameState.pigs.filter(pig => pig.readyToCollect).length;
                document.getElementById('available-meat').textContent = availableMeat;
            }
            
            // Atualizar curral das ovelhas
            if (gameState.hasSheepPen) {
                document.getElementById('sheep-count').textContent = gameState.sheep.length;
                const availableWool = gameState.sheep.filter(sheep => sheep.readyToCollect).length * 2;
                document.getElementById('available-wool').textContent = availableWool;
            }
            
            // Sementes s√£o ilimitadas agora, n√£o precisa atualizar contadores
            
            // Atualizar queijaria
            if (gameState.hasCheeseMaker) {
                document.getElementById('milk-for-cheese').textContent = gameState.products.milk;
                document.getElementById('cheese-ready').textContent = gameState.cheeseReady;
            }
            
            // Atualizar sistema de madeira
            if (gameState.hasBosque) {
                document.getElementById('logs-count').textContent = gameState.logs;
                document.getElementById('axe-status').textContent = gameState.hasAxe ? 'Possui' : 'N√£o possui';
                document.getElementById('axe-uses').textContent = gameState.axeUses;
                document.getElementById('apples-collected').textContent = gameState.apples;
                document.getElementById('bananas-collected').textContent = gameState.bananas;
                document.getElementById('oranges-collected').textContent = gameState.oranges;
                document.getElementById('branches-collected').textContent = gameState.branchesCollected;
            }
            
            // Atualizar timers das √°rvores
            const appleTimer = document.getElementById('apple-timer');
            if (!gameState.canCollectApples) {
                appleTimer.textContent = 'Pr√≥xima coleta amanh√£';
            } else {
                appleTimer.textContent = 'Dispon√≠vel para coleta!';
            }

            const bananaTimer = document.getElementById('banana-timer');
            if (!gameState.canCollectBananas) {
                bananaTimer.textContent = 'Pr√≥xima coleta amanh√£';
            } else {
                bananaTimer.textContent = 'Dispon√≠vel para coleta!';
            }

            const orangeTimer = document.getElementById('orange-timer');
            if (!gameState.canCollectOranges) {
                orangeTimer.textContent = 'Pr√≥xima coleta amanh√£';
            } else {
                orangeTimer.textContent = 'Dispon√≠vel para coleta!';
            }

            const treeTimer = document.getElementById('tree-timer');
            if (treeTimer) {
                treeTimer.textContent = '';
            }
            
            if (gameState.hasAxe) {
                document.getElementById('logs-inventory').textContent = gameState.logs;
                document.getElementById('firewood-count').textContent = gameState.firewood;
            }
            
            // Atualizar baia do cavalo
            if (gameState.hasHorse) {
                document.getElementById('horse-friendship').textContent = gameState.horse.friendship;
                document.getElementById('hay-for-horse').textContent = gameState.hay;
                document.getElementById('apples-count').textContent = gameState.apples;
                updateHorseDisplay();
            }
            
            // Atualizar cachorro
            if (gameState.hasDog) {
                document.getElementById('dog-food-count').textContent = gameState.dogFood;
                document.getElementById('dog-bones-count').textContent = gameState.dogBones;
                document.getElementById('dog-friendship').textContent = gameState.dog.friendship;
                document.getElementById('treasures-found-today').textContent = gameState.treasuresFoundToday;
                updateDogDisplay();
            }
            
            // Atualizar tesouros
            document.getElementById('cd-count').textContent = gameState.treasures.cd;
            document.getElementById('bottle-count').textContent = gameState.treasures.bottle;
            document.getElementById('shoe-count').textContent = gameState.treasures.shoe;
            document.getElementById('ball-count').textContent = gameState.treasures.ball;
            
            // Atualizar torradeira
            if (gameState.hasRoaster) {
                document.getElementById('coffee-beans').textContent = gameState.inventory[5] || 0; // Gr√£os crus do invent√°rio
                document.getElementById('coffee-roasted').textContent = gameState.products.coffee; // Caf√© torrado dos produtos
                document.getElementById('firewood-for-roaster').textContent = gameState.firewood;
            }
            
            // Atualizar m√°quina de fiar
            if (gameState.hasSpinningMachine) {
                document.getElementById('wool-for-spinning').textContent = gameState.products.wool;
                document.getElementById('yarn-count').textContent = gameState.yarnCount;
            }
            
            // Atualizar moinho
            if (gameState.hasMill) {
                document.getElementById('wheat-for-mill').textContent = gameState.inventory[4] || 0;
                document.getElementById('flour-ready').textContent = gameState.products.flour;
            }
            
            // Atualizar m√°quina de suco
            if (gameState.hasJuiceMaker) {
                document.getElementById('grapes-for-juice').textContent = gameState.inventory[9] || 0;
                document.getElementById('juice-ready').textContent = gameState.products.juice;
            }
            
            // Atualizar fog√£o
            if (gameState.hasStove) {
                document.getElementById('firewood-for-stove').textContent = gameState.firewood;
                document.getElementById('bread-ready').textContent = gameState.breadReady;
            }
            
            // Atualizar frutas na quitanda
            document.getElementById('banana-count').textContent = gameState.bananas;
            document.getElementById('apple-count').textContent = gameState.apples;
            document.getElementById('orange-count').textContent = gameState.oranges;
            document.getElementById('juice-count-market').textContent = gameState.products.juice;
            
            // Atualizar vegetais na quitanda
            document.getElementById('potato-count').textContent = gameState.inventory[0] || 0;
            document.getElementById('tomato-count').textContent = gameState.inventory[1] || 0;
            document.getElementById('carrot-count').textContent = gameState.inventory[2] || 0;
            document.getElementById('pumpkin-count').textContent = gameState.inventory[6] || 0;
            document.getElementById('broccoli-count').textContent = gameState.inventory[7] || 0;
            document.getElementById('lettuce-count').textContent = gameState.inventory[8] || 0;
            
            // Atualizar emojis e pre√ßos na primavera
            const vegetableData = [
                { index: 0, emoji: 'ü•î', price: 25 },
                { index: 1, emoji: 'üçÖ', price: 30 },
                { index: 2, emoji: 'ü•ï', price: 20 },
                { index: 6, emoji: 'üéÉ', price: 40 },
                { index: 7, emoji: 'ü•¶', price: 25 },
                { index: 8, emoji: 'ü•¨', price: 20 }
            ];
            
            vegetableData.forEach(veg => {
                const emojiElement = document.getElementById(`${['potato', 'tomato', 'carrot', '', '', '', 'pumpkin', 'broccoli', 'lettuce'][veg.index]}-emoji`);
                const priceElement = document.getElementById(`${['potato', 'tomato', 'carrot', '', '', '', 'pumpkin', 'broccoli', 'lettuce'][veg.index]}-price`);
                
                if (emojiElement && priceElement) {
                    if (gameState.currentSeason === 0) { // Primavera
                        emojiElement.textContent = `‚ú®${veg.emoji}‚ú®`;
                        priceElement.textContent = `${Math.floor(veg.price * 1.5)}m`;
                    } else {
                        emojiElement.textContent = veg.emoji;
                        priceElement.textContent = `${veg.price}m`;
                    }
                }
            });
            
            // Atualizar colmeia
            if (gameState.hasBeehive) {
                document.getElementById('honey-available').textContent = gameState.honeyAvailable;
                const honeyTimer = document.getElementById('honey-timer');
                if (gameState.canCollectHoney) {
                    honeyTimer.textContent = 'Pronto para coleta!';
                } else {
                    honeyTimer.textContent = 'Pr√≥xima produ√ß√£o no pr√≥ximo update (10 min)';
                }
            }
            
            // Atualizar produtos da fazenda
            document.getElementById('milk-count').textContent = gameState.products.milk;
            document.getElementById('eggs-count').textContent = gameState.products.eggs;
            document.getElementById('coffee-count').textContent = gameState.products.coffee;
            document.getElementById('wool-count').textContent = gameState.products.wool;
            document.getElementById('flour-count').textContent = gameState.products.flour;
            document.getElementById('honey-count').textContent = gameState.products.honey;
            document.getElementById('meat-count').textContent = gameState.products.meat;
            document.getElementById('juice-count').textContent = gameState.products.juice;
            document.getElementById('cheese-count').textContent = gameState.products.cheese;
            document.getElementById('yarn-count-display').textContent = gameState.products.yarn;
            document.getElementById('bread-count').textContent = gameState.products.bread;
            document.getElementById('juice-count-farm').textContent = gameState.products.juice;
            document.getElementById('raw-chicken-market').textContent = gameState.products.rawChicken;
            document.getElementById('fish-count').textContent = gameState.products.fish;
            
            // Atualizar pescaria
            document.getElementById('fish-available').textContent = gameState.fishAvailable;
            document.getElementById('fishing-rod-status').textContent = gameState.hasFishingRod ? 'Possui' : 'N√£o possui';
            document.getElementById('rod-uses').textContent = gameState.fishingRodUses;
            document.getElementById('fish-caught-today').textContent = gameState.fishCaught;
            
            // Atualizar p√©rolas na quitanda
            const pearlCountElement = document.getElementById('pearl-count');
            if (pearlCountElement) {
                pearlCountElement.textContent = gameState.pearls;
            }
            
            // Atualizar contador de peixes total e pr√≥xima p√©rola
            const totalFishElement = document.getElementById('total-fish-caught');
            const nextPearlElement = document.getElementById('next-pearl');
            if (totalFishElement) {
                totalFishElement.textContent = gameState.totalFishCaught;
            }
            if (nextPearlElement) {
                const fishUntilPearl = 6 - (gameState.totalFishCaught % 6);
                nextPearlElement.textContent = fishUntilPearl === 6 ? 6 : fishUntilPearl;
            }
            
            // Atualizar painel de pedidos
            updateOrdersDisplay();
            
            // Atualizar mina
            if (gameState.hasMine) {
                document.getElementById('coal-count').textContent = gameState.coal;
                document.getElementById('ruby-count').textContent = gameState.gems.ruby;
                document.getElementById('emerald-count').textContent = gameState.gems.emerald;
                document.getElementById('sapphire-count').textContent = gameState.gems.sapphire;
                document.getElementById('pickaxe-status').textContent = gameState.hasPickaxe ? 'Possui' : 'N√£o possui';
                document.getElementById('pickaxe-uses').textContent = gameState.pickaxeUses;
                
                // Atualizar contadores na quitanda
                document.getElementById('ruby-market-count').textContent = gameState.gems.ruby;
                document.getElementById('emerald-market-count').textContent = gameState.gems.emerald;
                document.getElementById('sapphire-market-count').textContent = gameState.gems.sapphire;
                
                updateMineDisplay();
            }
            
            // Atualizar carv√£o no celeiro
            const coalCeleiro = document.getElementById('coal-celeiro');
            if (coalCeleiro) coalCeleiro.textContent = gameState.coal;
            
            // Atualizar celeiro de sementes
            const inventoryDisplay = document.getElementById('inventory-display');
            inventoryDisplay.innerHTML = '';
            seeds.forEach((seed, index) => {
                const count = gameState.inventory[index] || 0;
                if (count > 0) {
                    const inventoryItem = document.createElement('div');
                    inventoryItem.style.textAlign = 'center';
                    inventoryItem.style.padding = '5px';
                    inventoryItem.style.background = '#F0F8FF';
                    inventoryItem.style.borderRadius = '5px';
                    
                    // Adicionar estrelinhas nos frutos da primavera
                    let displayEmoji = seed.emoji;
                    if (gameState.currentSeason === 0) { // Primavera
                        displayEmoji = `‚ú®${seed.emoji}‚ú®`;
                    }
                    
                    inventoryItem.innerHTML = `
                        <div style="font-size: 1rem;">${displayEmoji}</div>
                        <div style="font-size: 0.7rem; color: #2F4F4F;">${count}</div>
                    `;
                    inventoryDisplay.appendChild(inventoryItem);
                }
            });
            
            // Atualizar feno no celeiro
            const hayCeleiroElement = document.getElementById('hay-celeiro');
            if (hayCeleiroElement) {
                hayCeleiroElement.textContent = gameState.hay;
            }
            
            // Atualizar vacinas no celeiro
            const vaccinesCeleiro = document.getElementById('vaccines-celeiro');
            if (vaccinesCeleiro) vaccinesCeleiro.textContent = gameState.vaccines;
            
            // Atualizar todos os canteiros
            for (let i = 0; i < gameState.maxPlots; i++) {
                updatePlotDisplay(i);
            }
            
            // Atualizar canteiros da estufa se existir
            if (gameState.hasGreenhouse) {
                for (let i = 0; i < 12; i++) {
                    updateGreenhousePlotDisplay(i);
                }
            }
        }

        // Sistema de timers
        function startGameTimer() {
            setInterval(() => {
                // Timer da chuva (15 minutos)
                gameState.rainTimer--;
                

                
                // Verificar se deve chover
                if (gameState.rainTimer <= 0) {
                    gameState.rainTimer = 900; // Reset para 15 minutos
                    startRain();
                }
                
                // Timer de updates (10 minutos)
                gameState.updateTimer--;
                
                // Verificar se deve fazer updates
                if (gameState.updateTimer <= 0) {
                    gameState.updateTimer = 600; // Reset para 10 minutos
                    performPeriodicUpdates();
                }
                
                // Atualizar countdown de morte dos animais doentes
                updateSickAnimalsCountdown();
                
                // Atualizar display sempre
                updateDisplay();
            }, 1000);
        }

        // Atualizar countdown de morte dos animais doentes
        function updateSickAnimalsCountdown() {
            // Atualizar vacas doentes
            gameState.cows.forEach((cow, index) => {
                if (cow.sick && cow.sickTime) {
                    updateCowDisplay(index);
                }
            });
            
            // Atualizar galinhas doentes
            gameState.chickens.forEach((chicken, index) => {
                if (chicken.sick && chicken.sickTime) {
                    updateChickenDisplay(index);
                }
            });
            
            // Atualizar porcos doentes
            gameState.pigs.forEach((pig, index) => {
                if (pig.sick && pig.sickTime) {
                    updatePigDisplay(index);
                }
            });
            
            // Atualizar ovelhas doentes
            gameState.sheep.forEach((sheep, index) => {
                if (sheep.sick && sheep.sickTime) {
                    updateSheepDisplay(index);
                }
            });
        }
        
        // Fun√ß√£o para updates peri√≥dicos (a cada 10 minutos)
        function performPeriodicUpdates() {
            // SALVAMENTO AUTOM√ÅTICO
            saveGame();
            
            // Reset das vacas
            gameState.cows.forEach(cow => {
                cow.milkedToday = false;
            });
            
            // Reset do cavalo
            if (gameState.hasHorse) {
                gameState.horse.fedToday = false;
                gameState.horse.fed = false;
                updateHorseDisplay();
            }
            
            // Reset do cachorro
            if (gameState.hasDog) {
                gameState.dog.fedToday = false;
                gameState.dog.fed = false;
                gameState.dog.treasureReady = false;
                gameState.dog.currentTreasure = null;
                gameState.treasuresFoundToday = 0;
                const collectBtn = document.getElementById('collect-treasure-btn');
                if (collectBtn) {
                    collectBtn.style.display = 'none';
                }
                updateDogDisplay();
            }
            
            // Resetar coleta de frutas
            gameState.canCollectApples = true;
            gameState.canCollectBananas = true;
            gameState.canCollectOranges = true;
            
            // Verificar mel (a cada 2 updates = 20 minutos)
            if (gameState.hasBeehive) {
                gameState.canCollectHoney = true;
                gameState.honeyAvailable = 2;
            }
            
            // Reabilitar bot√£o de descansar se estava descansando
            if (gameState.isResting) {
                gameState.isResting = false;
                const restBtn = document.getElementById('rest-btn');
                if (restBtn) {
                    restBtn.disabled = false;
                    restBtn.textContent = 'üí§ Descansar (5 min)';
                }
            }
            
            // Resetar ovelhas
            gameState.sheep.forEach((sheep, index) => {
                updateSheepDisplay(index);
            });
            
            // Resetar porcos
            gameState.pigs.forEach((pig, index) => {
                updatePigDisplay(index);
            });
            
            // Reset das galinhas
            gameState.chickens.forEach((chicken, index) => {
                chicken.laidEggsToday = false;
                updateChickenDisplay(index);
            });
            
            // Sistema de doen√ßas - um animal fica doente esporadicamente
            makeAnimalSick();
            
            // Reset da pescaria
            gameState.fishAvailable = 4;
            gameState.fishCaught = 0;
            spawnFish(); // Repovoar o lago com novos peixes
            
            alert('üîÑ Sistema atualizado! Animais resetados, energia recuperada e atividades renovadas!');
        }

        // Sistema de chuva - agora chove dia sim dia n√£o
        function startWeatherSystem() {
            // A chuva agora √© controlada pelo sistema de dias
        }

        function startRain() {
            if (gameState.isRaining) return;
            
            gameState.isRaining = true;
            document.body.classList.add('raining');
            
            // Verificar se √© inverno para neve
            const isWinter = gameState.currentSeason === 3;
            
            // Mostrar indicador de chuva ou neve
            const indicator = document.getElementById('weather-indicator');
            if (indicator) {
                indicator.textContent = isWinter ? '‚ùÑÔ∏è' : 'üåßÔ∏è';
                indicator.classList.add('active');
            }
            
            // Criar gotas de chuva ou neve
            if (isWinter) {
                createSnowFlakes();
            } else {
                createRainDrops();
            }
            
            // Regar todas as plantas automaticamente (exceto no inverno)
            if (!isWinter) {
                gameState.plots.forEach((plot, index) => {
                    if (plot.planted && !plot.watered) {
                        plot.watered = true;
                        startGrowth(index);
                        updatePlotDisplay(index);
                    }
                });
                alert('Chuva! Todas as plantas foram regadas automaticamente! üåßÔ∏è');
            } else {
                alert('Neve! ‚ùÑÔ∏è Que paisagem linda, mas as plantas n√£o podem crescer no inverno.');
            }
            
            // Parar chuva/neve ap√≥s 1 minuto
            setTimeout(() => {
                gameState.isRaining = false;
                document.body.classList.remove('raining');
                if (indicator) {
                    indicator.classList.remove('active');
                }
                const rainDrops = document.getElementById('rain-drops');
                if (rainDrops) {
                    rainDrops.innerHTML = '';
                }
            }, 60000); // 1 minuto (60000ms)
        }

        function createRainDrops() {
            const rainContainer = document.getElementById('rain-drops');
            if (!rainContainer) return;
            
            rainContainer.innerHTML = ''; // Limpar gotas anteriores
            
            for (let i = 0; i < 100; i++) {
                const drop = document.createElement('div');
                drop.className = 'rain-drop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
                drop.style.animationDelay = Math.random() * 2 + 's';
                rainContainer.appendChild(drop);
            }
        }

        function createSnowFlakes() {
            const rainContainer = document.getElementById('rain-drops');
            if (!rainContainer) return;
            
            rainContainer.innerHTML = ''; // Limpar flocos anteriores
            
            for (let i = 0; i < 50; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snow-drop';
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDuration = (Math.random() * 2 + 2) + 's'; // Mais lento que chuva
                snowflake.style.animationDelay = Math.random() * 3 + 's';
                rainContainer.appendChild(snowflake);
            }
        }

        // Sistema de esta√ß√µes
        function startSeasonCycle() {
            // Aplicar classe inicial
            document.body.classList.add(`season-${gameState.currentSeason}`);
            updateSeasonalVisibility();
            
            setInterval(() => {
                // Remover classe da esta√ß√£o anterior
                document.body.classList.remove(`season-${gameState.currentSeason}`);
                
                gameState.currentSeason = (gameState.currentSeason + 1) % 4;
                document.getElementById('season-display').textContent = seasons[gameState.currentSeason];
                
                // Aplicar classe da nova esta√ß√£o
                document.body.classList.add(`season-${gameState.currentSeason}`);
                
                // Atualizar visibilidade baseada na esta√ß√£o
                updateSeasonalVisibility();
                
                // Mensagem de mudan√ßa de esta√ß√£o
                const seasonMessages = [
                    'üå∏ Primavera chegou! Plantas s√£o mais valiosas! A roupa de frio do Duque foi guardada.',
                    '‚òÄÔ∏è Ver√£o chegou! Plantas produzem 2 frutos!',
                    'üçÇ Outono chegou! Plantas crescem em 1 minuto!',
                    '‚ùÑÔ∏è Inverno chegou! N√£o √© poss√≠vel plantar nos canteiros normais. Duque precisa de roupa de frio!'
                ];
                
                let message = seasonMessages[gameState.currentSeason];
                
                // Mensagem especial se o cavalo perdeu a roupa de frio na primavera
                if (gameState.currentSeason === 0 && gameState.hasHorse) {
                    if (gameState.horse.hasWinterClothing) {
                        message = 'üå∏ Primavera chegou! Plantas s√£o mais valiosas! A roupa de frio do Duque foi automaticamente removida e descartada.';
                    }
                }
                
                alert(message);
            }, 7200000); // Muda esta√ß√£o a cada 2 horas
        }

        // Atualizar visibilidade baseada na esta√ß√£o
        function updateSeasonalVisibility() {
            const isWinter = gameState.currentSeason === 3;
            
            // Mostrar/esconder bot√£o de comprar estufa baseado na esta√ß√£o
            const buyGreenhouseBtn = document.getElementById('buy-greenhouse-btn');
            if (buyGreenhouseBtn) {
                if (isWinter && !gameState.hasGreenhouse) {
                    buyGreenhouseBtn.style.display = 'block';
                } else if (!isWinter) {
                    buyGreenhouseBtn.style.display = 'none';
                }
            }
            
            // Mostrar/esconder √°rea da estufa baseado na esta√ß√£o (se j√° possui)
            const greenhouseArea = document.getElementById('greenhouse-area');
            if (greenhouseArea && gameState.hasGreenhouse) {
                if (isWinter) {
                    greenhouseArea.style.display = 'block';
                } else {
                    greenhouseArea.style.display = 'none';
                }
            }
            
            // Mostrar/esconder fogueira baseado na esta√ß√£o e se tem animais
            const bonfireArea = document.getElementById('bonfire-area');
            if (bonfireArea) {
                const hasAnimals = (gameState.hasPigPen && gameState.pigs.length > 0) || 
                                 (gameState.hasSheepPen && gameState.sheep.length > 0) ||
                                 (gameState.hasPasture && gameState.cows.length > 0) ||
                                 (gameState.hasChickenCoop && gameState.chickens.length > 0);
                if (isWinter && hasAnimals) {
                    bonfireArea.style.display = 'block';
                } else {
                    bonfireArea.style.display = 'none';
                    // Apagar fogueira se n√£o for inverno
                    if (!isWinter && gameState.bonfire.lit) {
                        extinguishBonfire();
                    }
                }
            }
            
            // Mostrar/esconder bot√£o de roupa de frio para o cavalo
            const buyHorseClothingBtn = document.getElementById('buy-horse-clothing-btn');
            if (buyHorseClothingBtn && gameState.hasHorse) {
                if (isWinter && !gameState.horse.hasWinterClothing) {
                    buyHorseClothingBtn.style.display = 'block';
                } else {
                    buyHorseClothingBtn.style.display = 'none';
                }
            }
            
            // Remover roupa de frio quando n√£o for inverno
            if (!isWinter && gameState.hasHorse && gameState.horse.hasWinterClothing) {
                gameState.horse.hasWinterClothing = false;
                updateHorseDisplay();
            }
        }

        // Acender fogueira
        function lightBonfire() {
            if (gameState.currentSeason !== 3) {
                alert('A fogueira s√≥ √© necess√°ria no inverno!');
                return;
            }
            
            if (gameState.bonfire.lit) {
                alert('A fogueira j√° est√° acesa!');
                return;
            }
            
            if (gameState.energy <= 0) {
                alert('Voc√™ est√° sem energia! Descanse ou se alimente.');
                return;
            }
            
            if (gameState.firewood < 4) {
                alert('Voc√™ precisa de 4 lenhas para acender a fogueira!');
                return;
            }
            
            if (gameState.coal < 3) {
                alert('Voc√™ precisa de 3 carv√µes para acender a fogueira!');
                return;
            }
            
            // Consumir materiais e energia
            gameState.firewood -= 4;
            gameState.coal -= 3;
            gameState.energy = Math.max(0, gameState.energy - 0.5);
            
            // Acender fogueira
            gameState.bonfire.lit = true;
            gameState.bonfire.timeLeft = 3600; // 1 hora em segundos
            
            // Iniciar timer da fogueira
            startBonfireTimer();
            
            // Atualizar visual
            updateBonfireDisplay();
            updateDisplay();
            
            alert('üî• Fogueira acesa! Os animais ficar√£o aquecidos por 1 hora e poder√£o produzir normalmente no inverno.');
        }

        // Iniciar timer da fogueira
        function startBonfireTimer() {
            if (gameState.bonfire.timer) {
                clearInterval(gameState.bonfire.timer);
            }
            
            gameState.bonfire.timer = setInterval(() => {
                gameState.bonfire.timeLeft--;
                updateBonfireDisplay();
                
                if (gameState.bonfire.timeLeft <= 0) {
                    extinguishBonfire();
                }
            }, 1000);
        }

        // Apagar fogueira
        function extinguishBonfire() {
            gameState.bonfire.lit = false;
            gameState.bonfire.timeLeft = 0;
            
            if (gameState.bonfire.timer) {
                clearInterval(gameState.bonfire.timer);
                gameState.bonfire.timer = null;
            }
            
            updateBonfireDisplay();
            
            if (gameState.currentSeason === 3) {
                alert('üî• A fogueira se apagou! Os animais ficar√£o com frio e n√£o produzir√£o at√© voc√™ acender outra fogueira.');
            }
        }

        // Atualizar display da fogueira
        function updateBonfireDisplay() {
            const bonfireDisplay = document.getElementById('bonfire-display');
            const bonfireFlames = document.getElementById('bonfire-flames');
            const bonfireStatus = document.getElementById('bonfire-status');
            const bonfireTimer = document.getElementById('bonfire-timer');
            const lightBtn = document.getElementById('light-bonfire-btn');
            
            if (gameState.bonfire.lit) {
                bonfireDisplay.textContent = 'üî•';
                bonfireFlames.style.opacity = '1';
                bonfireStatus.textContent = 'Acesa e aquecendo';
                bonfireStatus.style.color = '#FF6347';
                
                // Mostrar tempo restante
                const minutes = Math.floor(gameState.bonfire.timeLeft / 60);
                const seconds = gameState.bonfire.timeLeft % 60;
                bonfireTimer.textContent = `Tempo restante: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                lightBtn.textContent = 'üî• Fogueira Acesa';
                lightBtn.disabled = true;
                lightBtn.style.background = '#ccc';
            } else {
                bonfireDisplay.textContent = 'ü™µ';
                bonfireFlames.style.opacity = '0';
                bonfireStatus.textContent = 'Apagada';
                bonfireStatus.style.color = '#666';
                bonfireTimer.textContent = '';
                
                lightBtn.textContent = 'üî• Acender Fogueira';
                lightBtn.disabled = false;
                lightBtn.style.background = '#32CD32';
            }
        }

        // Sistema de Tutorial
        let tutorialState = {
            active: false,
            currentStep: 0,
            steps: [
                {
                    id: 'welcome',
                    title: 'üåæ Bem-vindo √† Real Farm!',
                    message: 'Ol√°! Sou seu guia nesta fazenda. Vou te ensinar tudo sobre agricultura. Primeiro, vamos comprar o po√ßo para ter √°gua!',
                    highlight: '#buy-well-btn',
                    action: 'buyWell'
                },
                {
                    id: 'collect-water',
                    title: 'üíß Coletando √Ågua',
                    message: 'Perfeito! Agora clique no po√ßo para coletar √°gua. Voc√™ precisa de √°gua para regar as plantas.',
                    highlight: '#well',
                    action: 'collectWater'
                },
                {
                    id: 'buy-compost',
                    title: 'üóëÔ∏è Comprando Composteira',
                    message: '√ìtimo! Agora vamos comprar a composteira para fazer adubo. Clique no bot√£o da composteira.',
                    highlight: '#buy-compost-btn',
                    action: 'buyCompost'
                },
                {
                    id: 'buy-grass-field',
                    title: 'üåø Campo de Grama',
                    message: 'Excelente! Agora compre o campo de grama. Voc√™ coletar√° grama para fazer flores para o adubo.',
                    highlight: '#buy-grass-btn',
                    action: 'buyGrassField'
                },
                {
                    id: 'collect-grass',
                    title: 'üåø Coletando Grama',
                    message: 'Perfeito! Agora clique nas gramas verdes para colet√°-las. A cada 4 gramas voc√™ ganha 1 flor!',
                    highlight: '#grass-grid',
                    action: 'collectGrass'
                },
                {
                    id: 'buy-bosque',
                    title: 'üå≥ Comprando Bosque',
                    message: '√ìtimo! Agora vamos comprar o bosque para coletar galhos. Clique no bot√£o do bosque.',
                    highlight: '#buy-bosque-btn',
                    action: 'buyBosque'
                },
                {
                    id: 'buy-axe',
                    title: 'ü™ì Comprando Machado',
                    message: 'Agora compre o machado para poder coletar troncos e galhos das √°rvores.',
                    highlight: '#buy-axe-btn',
                    action: 'buyAxe'
                },
                {
                    id: 'collect-logs',
                    title: 'ü™µ Coletando Troncos',
                    message: 'Perfeito! Clique na √°rvore para coletar troncos. Voc√™ tamb√©m ganhar√° galhos para a composteira!',
                    highlight: '#tree',
                    action: 'collectLogs'
                },
                {
                    id: 'buy-pasture',
                    title: 'üêÑ Comprando Pasto',
                    message: 'Excelente! Agora vamos comprar o pasto para ter vacas que produzem esterco.',
                    highlight: '#buy-pasture-btn',
                    action: 'buyPasture'
                },
                {
                    id: 'buy-cow',
                    title: 'üêÑ Comprando Vaca',
                    message: '√ìtimo! Agora compre uma vaca. Ela produzir√° esterco quando alimentada.',
                    highlight: '#buy-cow-btn',
                    action: 'buyCow'
                },
                {
                    id: 'buy-dryer',
                    title: '‚òÄÔ∏è Comprando Secador',
                    message: 'Perfeito! Compre o secador de grama para fazer feno e alimentar a vaca.',
                    highlight: '#buy-dryer-btn',
                    action: 'buyDryer'
                },
                {
                    id: 'make-hay',
                    title: 'üü® Fazendo Feno',
                    message: 'Agora vamos fazer feno! Primeiro seque a grama, depois transforme em feno.',
                    highlight: '#drying-panel',
                    action: 'startDrying'
                },
                {
                    id: 'feed-cow',
                    title: 'üêÑ Alimentando Vaca',
                    message: '√ìtimo! Agora clique na vaca para aliment√°-la com feno. Ela produzir√° esterco!',
                    highlight: '#cows-container',
                    action: 'feedCow'
                },
                {
                    id: 'make-compost',
                    title: 'üåø Fazendo Adubo',
                    message: 'Perfeito! Agora voc√™ tem todos os materiais. Fa√ßa adubo na composteira!',
                    highlight: '#compost-panel',
                    action: 'makeCompost'
                },
                {
                    id: 'select-seed',
                    title: 'üå± Selecionando Semente',
                    message: 'Excelente! Agora selecione uma semente para plantar. Clique em qualquer semente.',
                    highlight: '#seeds-grid',
                    action: 'selectSeed'
                },
                {
                    id: 'fertilize-plot',
                    title: 'üåø Adubando Solo',
                    message: '√ìtimo! Agora clique em um canteiro para adub√°-lo. Este √© o primeiro passo do plantio.',
                    highlight: '#plots-grid',
                    action: 'fertilizePlot'
                },
                {
                    id: 'plant-seed',
                    title: 'üå± Plantando Semente',
                    message: 'Perfeito! Clique no mesmo canteiro novamente para plantar a semente.',
                    highlight: '#plots-grid',
                    action: 'plantSeed'
                },
                {
                    id: 'water-plant',
                    title: 'üíß Regando Planta',
                    message: 'Excelente! Agora clique no canteiro mais uma vez para regar a planta.',
                    highlight: '#plots-grid',
                    action: 'waterPlot'
                },
                {
                    id: 'wait-growth',
                    title: '‚è∞ Aguardando Crescimento',
                    message: 'Perfeito! A planta est√° crescendo. Aguarde 1 minuto e ela estar√° pronta para colher!',
                    highlight: '#plots-grid',
                    action: 'wait'
                },
                {
                    id: 'harvest-plant',
                    title: 'üåæ Colhendo Planta',
                    message: '√ìtimo! A planta est√° pronta! Clique no canteiro para colher e adicionar ao celeiro.',
                    highlight: '#plots-grid',
                    action: 'harvestPlot'
                },
                {
                    id: 'sell-products',
                    title: 'üí∞ Vendendo na Quitanda',
                    message: 'Excelente! Agora venda seus produtos na quitanda para ganhar dinheiro!',
                    highlight: '.panel:has(h3:contains("Quitanda"))',
                    action: 'sellInventoryItem'
                },
                {
                    id: 'tutorial-complete',
                    title: 'üéâ Tutorial Completo!',
                    message: 'Parab√©ns! Voc√™ aprendeu o b√°sico da fazenda: plantar, cuidar dos animais e vender produtos. Continue explorando e comprando novos itens no mercadinho!',
                    highlight: null,
                    action: 'complete'
                }
            ]
        };

        // Mostrar tutorial
        function showTutorial(stepId = null) {
            if (!tutorialState.active) return;
            
            // Se um stepId espec√≠fico foi fornecido, encontrar o passo
            if (stepId) {
                const stepIndex = tutorialState.steps.findIndex(step => step.id === stepId);
                if (stepIndex !== -1 && stepIndex === tutorialState.currentStep) {
                    // Avan√ßar para o pr√≥ximo passo
                    tutorialState.currentStep++;
                }
            }
            
            // Verificar se o tutorial terminou
            if (tutorialState.currentStep >= tutorialState.steps.length) {
                completeTutorial();
                return;
            }
            
            const currentStep = tutorialState.steps[tutorialState.currentStep];
            
            // Remover destaque anterior
            document.querySelectorAll('.tutorial-highlight').forEach(el => {
                el.classList.remove('tutorial-highlight');
            });
            
            // Adicionar destaque ao elemento atual
            if (currentStep.highlight) {
                const element = document.querySelector(currentStep.highlight);
                if (element) {
                    element.classList.add('tutorial-highlight');
                }
            }
            
            // Mostrar mensagem do tutorial
            showTutorialMessage(currentStep.title, currentStep.message);
        }

        // Mostrar mensagem do tutorial
        function showTutorialMessage(title, message) {
            // Remover popup anterior se existir
            const existingPopup = document.getElementById('tutorial-popup');
            if (existingPopup) {
                existingPopup.remove();
            }
            
            // Criar popup do tutorial
            const popup = document.createElement('div');
            popup.id = 'tutorial-popup';
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                padding: 20px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 400px;
                text-align: center;
                font-family: Arial, sans-serif;
                border: 3px solid #FFD700;
            `;
            
            popup.innerHTML = `
                <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">${title}</h3>
                <p style="margin: 0 0 20px 0; line-height: 1.4;">${message}</p>
                <button onclick="closeTutorialMessage()" style="
                    background: #FFD700;
                    color: #2F4F4F;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 8px;
                    font-weight: bold;
                    cursor: pointer;
                    font-size: 1rem;
                ">Entendi! ‚úì</button>
            `;
            
            document.body.appendChild(popup);
        }

        // Fechar mensagem do tutorial
        function closeTutorialMessage() {
            const popup = document.getElementById('tutorial-popup');
            if (popup) {
                popup.remove();
            }
        }

        // Completar tutorial
        function completeTutorial() {
            tutorialState.active = false;
            tutorialState.currentStep = 0;
            
            // Remover todos os destaques
            document.querySelectorAll('.tutorial-highlight').forEach(el => {
                el.classList.remove('tutorial-highlight');
            });
            
            // Fechar popup se existir
            closeTutorialMessage();
            
            // Salvar que o tutorial foi completado
            localStorage.setItem('realFarmTutorialCompleted', 'true');
            
            // Mostrar mensagem de conclus√£o
            setTimeout(() => {
                alert('üéâ Tutorial completo! Agora voc√™ sabe como jogar Real Farm. Continue explorando e se divertindo!');
            }, 500);
        }

        // Iniciar tutorial para novos jogadores
        function startTutorial() {
            // Verificar se o tutorial j√° foi completado
            const tutorialCompleted = localStorage.getItem('realFarmTutorialCompleted');
            
            // Verificar se √© um novo jogador (sem save ou com valores iniciais) e n√£o completou tutorial
            if (!tutorialCompleted && gameState.money <= 200 && gameState.water === 10 && gameState.fertilizer === 50 && gameState.dayCount === 1 && !gameState.hasWell) {
                tutorialState.active = true;
                tutorialState.currentStep = 0;
                
                // Mostrar primeiro passo do tutorial
                setTimeout(() => {
                    showTutorial();
                }, 2000); // Aguardar 2 segundos para o jogo carregar
            }
        }

        // Adicionar CSS para destaque do tutorial
        const tutorialCSS = document.createElement('style');
        tutorialCSS.textContent = `
            .tutorial-highlight {
                animation: tutorialGlow 2s infinite;
                position: relative;
                z-index: 1000;
            }
            
            @keyframes tutorialGlow {
                0%, 100% { 
                    box-shadow: 0 0 20px #FFD700, 0 0 30px #FFD700, 0 0 40px #FFD700;
                    transform: scale(1);
                }
                50% { 
                    box-shadow: 0 0 30px #FFA500, 0 0 40px #FFA500, 0 0 50px #FFA500;
                    transform: scale(1.05);
                }
            }
        `;
        document.head.appendChild(tutorialCSS);

        // Inicializar o jogo quando a p√°gina carregar
        window.onload = function() {
            initGame();
            startTutorial();
            
            // Ativar cron√¥metro automaticamente
            console.log('üïê Cron√¥metro ativado! O tempo est√° correndo...');
        };
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9699537456090093',t:'MTc1NDI2MDkyMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
