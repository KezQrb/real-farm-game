<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Farm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Sans MS', cursive;
            background: linear-gradient(135deg, #87CEEB 0%, #98FB98 100%);
            min-height: 100vh;
            transition: background 0.5s ease;
        }
        
        body.raining {
            background: linear-gradient(135deg, #696969 0%, #808080 100%);
        }
        
        body.snowing {
            background: linear-gradient(135deg, #e6f3ff 0%, #b3d9ff 100%);
        }
        
        .header {
            background: rgba(139, 69, 19, 0.9);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .game-title {
            font-size: 28px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .resources {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .resource {
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .season-info {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .save-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .save-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .quitanda-center {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .farm-area {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .farm-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .plot {
            width: 80px;
            height: 80px;
            border: 3px solid #8B4513;
            border-radius: 10px;
            background: #DEB887;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .plot:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .plot.fertilized {
            background: #8B4513;
        }
        
        .plot.planted {
            background: #228B22;
        }
        
        .plot.watered {
            background: #4169E1;
        }
        
        .plot.ready {
            background: #FFD700;
            animation: glow 1s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 5px #FFD700; }
            to { box-shadow: 0 0 20px #FFD700; }
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .panel {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .panel h3 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #8B4513;
            padding-bottom: 5px;
        }
        
        .seeds-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .seed-btn {
            background: #90EE90;
            border: 2px solid #228B22;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .seed-btn:hover {
            background: #7CFC00;
            transform: scale(1.05);
        }
        
        .seed-btn.selected {
            background: #FFD700;
            border-color: #FFA500;
        }
        
        .inventory-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin: 8px 0;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .inventory-item:hover {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: translateX(8px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .quitanda-section {
            background: rgba(255,255,255,0.7);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #ddd;
        }

        .quitanda-items {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .sell-all-btn {
            background: #FF6347;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s ease;
        }
        
        .sell-all-btn:hover {
            background: #FF4500;
            transform: scale(1.02);
        }
        
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 8px 0;
            background: #E6F3FF;
            border-radius: 10px;
            border: 2px solid #4169E1;
        }
        
        .buy-btn {
            background: #4169E1;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .buy-btn:hover {
            background: #1E90FF;
            transform: scale(1.05);
        }
        
        .rain-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        .raindrop {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, transparent, #4169E1);
            animation: fall linear infinite;
        }
        
        .snowflake {
            position: absolute;
            color: white;
            font-size: 20px;
            animation: snowfall linear infinite;
        }
        
        @keyframes fall {
            from {
                transform: translateY(-100vh);
            }
            to {
                transform: translateY(100vh);
            }
        }
        
        @keyframes snowfall {
            from {
                transform: translateY(-100vh) rotate(0deg);
            }
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        
        .well {
            width: 80px;
            height: 80px;
            background: #4169E1;
            border: 3px solid #1E90FF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            margin: 20px auto;
            transition: all 0.3s ease;
        }
        
        .well:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(65, 105, 225, 0.5);
        }
        
        .pet-house {
            background: #8B4513;
            border: 3px solid #654321;
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .pet-info {
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .friendship-bar {
            width: 100%;
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px 0;
        }
        
        .friendship-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcf7f);
            transition: width 0.5s ease;
        }
        
        .feed-btn {
            background: #FF6347;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .feed-btn:hover {
            background: #FF4500;
            transform: scale(1.05);
        }
        
        .feed-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .orders-panel {
            background: #E6F3FF;
            border: 2px solid #4169E1;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .order-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .order-buttons {
            display: flex;
            gap: 5px;
        }
        
        .accept-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .reject-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .animal-structure {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .animal-structure h4 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .animals-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .flowers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .animal-slot {
            width: 60px;
            height: 60px;
            border: 2px solid #8B4513;
            border-radius: 10px;
            background: #F5DEB3;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .animal-slot:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .animal-slot.sick {
            background: #FFB6C1;
            animation: shake 0.5s ease-in-out infinite alternate;
        }

        .animal-slot.eating {
            background: #90EE90;
        }

        .animal-slot.resting {
            background: #DDA0DD;
        }

        @keyframes shake {
            from { transform: translateX(-2px); }
            to { transform: translateX(2px); }
        }

        .flower-slot {
            width: 80px;
            height: 80px;
            border: 2px solid #228B22;
            border-radius: 15px;
            background: #98FB98;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .flower-slot:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .flower-slot.empty {
            background: #DEB887;
            cursor: not-allowed;
        }

        .grass-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .grass-slot {
            width: 50px;
            height: 50px;
            border: 2px solid #228B22;
            border-radius: 10px;
            background: #90EE90;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .grass-slot:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .grass-slot.empty {
            background: #DEB887;
            cursor: not-allowed;
        }

        .trees-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .tree-slot {
            width: 80px;
            height: 80px;
            border: 2px solid #8B4513;
            border-radius: 15px;
            background: #228B22;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .tree-slot:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .tree-count {
            font-size: 12px;
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
            padding: 2px 6px;
            margin-top: 2px;
        }

        .fish-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .fish-slot {
            width: 60px;
            height: 60px;
            border: 2px solid #4169E1;
            border-radius: 50%;
            background: #87CEEB;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .fish-slot:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(65, 105, 225, 0.5);
        }

        .fish-slot.empty {
            background: #B0C4DE;
            cursor: not-allowed;
        }

        .rocks-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .rock-slot {
            width: 80px;
            height: 80px;
            border: 2px solid #696969;
            border-radius: 15px;
            background: #A9A9A9;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .rock-slot:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .rock-slot.resting {
            background: #808080;
            cursor: not-allowed;
        }

        .rock-hits {
            font-size: 10px;
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
            padding: 1px 4px;
            margin-top: 2px;
        }

        .craft-item {
            background: rgba(255,255,255,0.9);
            border: 2px solid #8B4513;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .craft-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            background: rgba(255,255,255,1);
        }

        .craft-item.working {
            background: rgba(255,215,0,0.3);
            cursor: not-allowed;
        }

        .craft-emoji {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .craft-name {
            font-weight: bold;
            color: #8B4513;
            font-size: 14px;
        }

        .craft-recipe {
            font-size: 12px;
            color: #666;
            text-align: center;
        }

        .craft-time {
            font-size: 11px;
            color: #999;
            font-style: italic;
        }

        .tool-status {
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }

        .tool-status.broken {
            background: rgba(255,0,0,0.1);
            color: #cc0000;
        }

        .mailbox {
            position: relative;
            background: #dc143c;
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s ease;
            margin-left: 20px;
        }

        .mailbox:hover {
            background: #b91c3c;
            transform: scale(1.05);
        }

        .mail-alert {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ffd700;
            color: #dc143c;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            animation: pulse 1s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.2); }
        }

        .avatar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-left: 20px;
        }

        .avatar {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 10px;
            text-align: center;
            min-width: 120px;
        }

        .avatar-emoji {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .avatar.sick .avatar-emoji {
            animation: sickPulse 1s ease-in-out infinite alternate;
        }

        @keyframes sickPulse {
            from { 
                filter: hue-rotate(0deg);
                transform: scale(1);
            }
            to { 
                filter: hue-rotate(180deg);
                transform: scale(1.1);
            }
        }

        .avatar-name {
            color: white;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .energy-bar {
            width: 100%;
            height: 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 3px;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ffaa00, #44ff44);
            transition: width 0.5s ease;
        }

        .energy-text {
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .avatar-buttons {
            display: flex;
            gap: 5px;
        }

        .avatar-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .avatar-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .avatar-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .bees-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .bee-slot {
            width: 60px;
            height: 60px;
            border: 2px solid #ffd700;
            border-radius: 50%;
            background: #fff8dc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bee-slot:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.5);
        }

        .bee-slot.ready {
            background: #ffd700;
            animation: honeyGlow 1s ease-in-out infinite alternate;
        }

        @keyframes honeyGlow {
            from { box-shadow: 0 0 5px #ffd700; }
            to { box-shadow: 0 0 20px #ffd700; }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            max-width: 500px;
            max-height: 70vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .mail-item {
            background: #f0f8ff;
            border: 1px solid #4169e1;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }

        .mail-header {
            font-weight: bold;
            color: #4169e1;
            margin-bottom: 10px;
        }

        .food-menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .food-item {
            background: #f0f8ff;
            border: 2px solid #4169e1;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .food-item:hover {
            background: #e6f3ff;
            transform: scale(1.05);
        }

        .food-item.disabled {
            background: #f5f5f5;
            border-color: #ccc;
            color: #999;
            cursor: not-allowed;
        }

        .machines-sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .machine {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            display: none;
        }

        .machine h4 {
            color: #8B4513;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .machine-status {
            background: #f0f8ff;
            border-radius: 8px;
            padding: 8px;
            margin: 8px 0;
            font-size: 14px;
        }

        .machine-status.working {
            background: #fff3cd;
            color: #856404;
        }

        .machine-status.ready {
            background: #d4edda;
            color: #155724;
            animation: pulse 1s ease-in-out infinite alternate;
        }

        .machine-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .machine-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .machine-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .recipe-info {
            background: rgba(0,0,0,0.05);
            border-radius: 6px;
            padding: 6px;
            margin: 6px 0;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            
            .farm-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .resources {
                justify-content: center;
            }
            
            .machines-sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="game-title">🚜 Real Farm</div>
        
        <!-- Mailbox -->
        <div class="mailbox" id="mailbox" onclick="openMailbox()">
            📮
            <span id="mailAlert" class="mail-alert" style="display: none;">!</span>
        </div>
        
        <div class="resources">
            <div class="resource">💰 <span id="coins">200</span></div>
            <div class="resource">🪣 <span id="water">10</span></div>
            <div class="resource">🍂 <span id="fertilizer">50</span></div>
            <div class="season-info">
                <span id="season">Primavera</span> - <span id="timer">60:00</span>
            </div>
            <button class="save-btn" onclick="saveGame()">💾 Salvar</button>
        </div>
        
        <!-- Avatar -->
        <div class="avatar-container">
            <div class="avatar" id="avatar">
                <div class="avatar-emoji" id="avatarEmoji">👨‍🌾</div>
                <div class="avatar-name">Você</div>
                <div class="energy-bar">
                    <div class="energy-fill" id="energyFill" style="width: 100%"></div>
                </div>
                <div class="energy-text"><span id="energy">200</span>/200</div>
            </div>
            <div class="avatar-buttons">
                <button class="avatar-btn" onclick="restAvatar()" id="restBtn">😴 Descansar 5min</button>
                <button class="avatar-btn" onclick="openFoodMenu()" id="eatBtn">🍽️ Comer</button>
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <div class="panel">
                <h3>🌱 Sementes</h3>
                <div class="seeds-grid" id="seedsGrid"></div>
            </div>

            <div class="panel">
                <h3>🏚️ Celeiro</h3>
                <div id="barn">
                    <div id="barnItems"></div>
                </div>
            </div>

            <div class="panel">
                <h3>🏬 Mercadinho</h3>
                <div id="shop" style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                    <!-- 1. Poço de Água -->
                    <div class="shop-item" id="wellShop" style="display: block;">
                        <span>🏗️ Poço de Água</span>
                        <button class="buy-btn" onclick="buyWell()">50💰</button>
                    </div>
                    
                    <!-- 2. Machado -->
                    <div class="shop-item" id="axeShop">
                        <span>🪓 Machado + Cortar Lenha</span>
                        <button class="buy-btn" onclick="buyAxeAndWoodCutting()">100💰</button>
                    </div>
                    <div class="shop-item" id="axeOnlyShop" style="display: none;">
                        <span>🪓 Machado</span>
                        <button class="buy-btn" onclick="buyAxe()">50💰</button>
                    </div>
                    
                    <!-- 3. Bosque -->
                    <div class="shop-item" id="forestShop">
                        <span>🌳 Bosque</span>
                        <button class="buy-btn" onclick="buyForest()">300💰</button>
                    </div>
                    
                    <!-- 4. Fogão -->
                    <div class="shop-item" id="stoveShop">
                        <span>🔥 Fogão com Forno</span>
                        <button class="buy-btn" onclick="buyStove()">250💰</button>
                    </div>
                    
                    <!-- 5. Campo de Grama -->
                    <div class="shop-item" id="grassFieldShop">
                        <span>🌱 Campo de Grama</span>
                        <button class="buy-btn" onclick="buyGrassField()">75💰</button>
                    </div>
                    
                    <!-- 6. Secador de Grama -->
                    <div class="shop-item" id="grassDryerShop">
                        <span>🌾 Secador de Grama</span>
                        <button class="buy-btn" onclick="buyGrassDryer()">150💰</button>
                    </div>
                    
                    <!-- 7. Pasto de Vacas -->
                    <div class="shop-item" id="cowPastureShop">
                        <span>🐄 Pasto de Vacas</span>
                        <button class="buy-btn" onclick="buyCowPasture()">200💰</button>
                    </div>
                    
                    <!-- 8. Vacas -->
                    <div class="shop-item" id="cowShop" style="display: none;">
                        <span>🐄 Vaca</span>
                        <button class="buy-btn" onclick="buyCow()">95💰</button>
                    </div>
                    
                    <!-- 9. Composteira -->
                    <div class="shop-item" id="composterShop">
                        <span>🗑️ Composteira</span>
                        <button class="buy-btn" onclick="buyComposter()">180💰</button>
                    </div>
                    
                    <!-- 10. Vara de Pesca -->
                    <div class="shop-item" id="fishingRodShop">
                        <span>🎣 Vara de Pesca</span>
                        <button class="buy-btn" onclick="buyFishingRod()">60💰</button>
                    </div>
                    
                    <!-- 11. Colmeia -->
                    <div class="shop-item" id="beehiveShop">
                        <span>🍯 Colmeia</span>
                        <button class="buy-btn" onclick="buyBeehive()">120💰</button>
                    </div>
                    
                    <!-- 12. Misturador -->
                    <div class="shop-item" id="mixerShop">
                        <span>🥣 Misturador</span>
                        <button class="buy-btn" onclick="buyMixer()">90💰</button>
                    </div>
                    
                    <!-- 13. Galinheiro -->
                    <div class="shop-item" id="chickenCoopShop">
                        <span>🐔 Galinheiro</span>
                        <button class="buy-btn" onclick="buyChickenCoop()">80💰</button>
                    </div>
                    
                    <!-- 14. Galinhas -->
                    <div class="shop-item" id="chickenShop" style="display: none;">
                        <span>🐔 Galinha</span>
                        <button class="buy-btn" onclick="buyChicken()">25💰</button>
                    </div>
                    
                    <!-- 15. Chiqueiro -->
                    <div class="shop-item" id="pigPenShop">
                        <span>🐷 Chiqueiro</span>
                        <button class="buy-btn" onclick="buyPigPen()">130💰</button>
                    </div>
                    
                    <!-- 16. Porcos -->
                    <div class="shop-item" id="pigShop" style="display: none;">
                        <span>🐷 Porco</span>
                        <button class="buy-btn" onclick="buyPig()">100💰</button>
                    </div>
                    
                    <!-- 17. Curral das Ovelhas -->
                    <div class="shop-item" id="sheepPenShop">
                        <span>🐑 Curral das Ovelhas</span>
                        <button class="buy-btn" onclick="buySheepPen()">150💰</button>
                    </div>
                    
                    <!-- 18. Ovelhas -->
                    <div class="shop-item" id="sheepShop" style="display: none;">
                        <span>🐑 Ovelha</span>
                        <button class="buy-btn" onclick="buySheep()">120💰</button>
                    </div>
                    <div class="shop-item" id="shearsShop" style="display: none;">
                        <span>✂️ Tesoura de Tosquiar</span>
                        <button class="buy-btn" onclick="buyShears()">35💰</button>
                    </div>
                    
                    <!-- 19. Torra de Café -->
                    <div class="shop-item" id="coffeeRoasterShop">
                        <span>☕ Torra de Café</span>
                        <button class="buy-btn" onclick="buyCoffeeRoaster()">250💰</button>
                    </div>
                    
                    <!-- 20. Máquina de Suco -->
                    <div class="shop-item" id="juiceMachineShop">
                        <span>🧃 Máquina de Suco</span>
                        <button class="buy-btn" onclick="buyJuiceMachine()">120💰</button>
                    </div>
                    
                    <!-- 21. Queijeira -->
                    <div class="shop-item" id="cheeseMakerShop">
                        <span>🧀 Queijeira</span>
                        <button class="buy-btn" onclick="buyCheeseMaker()">160💰</button>
                    </div>
                    
                    <!-- 22. Máquina de Fiar -->
                    <div class="shop-item" id="spinningMachineShop">
                        <span>🧶 Máquina de Fiar</span>
                        <button class="buy-btn" onclick="buySpinningMachine()">140💰</button>
                    </div>
                    
                    <!-- 23. Moinho -->
                    <div class="shop-item" id="millShop">
                        <span>🌾 Moinho</span>
                        <button class="buy-btn" onclick="buyMill()">200💰</button>
                    </div>
                    
                    <!-- 24. Vacina -->
                    <div class="shop-item" id="vaccineShop">
                        <span>💉 Vacina</span>
                        <button class="buy-btn" onclick="buyVaccine()">40💰</button>
                    </div>
                    
                    <!-- 25. Ração para Cachorro -->
                    <div class="shop-item" id="dogFoodShop">
                        <span>🥩 Ração para Cachorro</span>
                        <button class="buy-btn" onclick="buyDogFood()">30💰</button>
                    </div>
                    
                    <!-- 26. Casinha da Mocinha -->
                    <div class="shop-item" id="dogHouseShop">
                        <span>🏠 Casinha do Cachorro</span>
                        <button class="buy-btn" onclick="buyDogHouse()">200💰</button>
                    </div>
                    
                    <!-- 27. Picareta -->
                    <div class="shop-item" id="pickaxeShop">
                        <span>⛏️ Picareta</span>
                        <button class="buy-btn" onclick="buyPickaxe()">80💰</button>
                    </div>
                    
                    <!-- 28. Baia do Duque -->
                    <div class="shop-item" id="horseStableShop">
                        <span>🏇 Baia para Cavalos</span>
                        <button class="buy-btn" onclick="buyHorseStable()">1000💰</button>
                    </div>
                    
                    <!-- Cortador de Lenha (não estava na lista, mantendo no final) -->
                    <div class="shop-item" id="woodCutterShop">
                        <span>🪓 Cortador de Lenha</span>
                        <button class="buy-btn" onclick="buyWoodCutter()">85💰</button>
                    </div>
                    
                    <!-- Greenhouse (Winter only) -->
                    <div class="shop-item" id="greenhouseShop" style="display: none;">
                        <span>🏠 Estufa</span>
                        <button class="buy-btn" onclick="buyGreenhouse()">500💰</button>
                    </div>
                    <div id="ordersPanel" style="display: none;">
                        <div class="orders-panel">
                            <h4>📋 Pedidos de Clientes</h4>
                            <div id="ordersList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dog House -->
            <div id="dogHouse" class="pet-house" style="display: none;">
                <h4>🐕 Casinha da Mocinha</h4>
                <div class="pet-info">
                    <div>❤️ Amizade: <span id="dogFriendship">0</span>%</div>
                    <div class="friendship-bar">
                        <div class="friendship-fill" id="dogFriendshipBar" style="width: 0%"></div>
                    </div>
                    <div>🍖 Última refeição: <span id="dogLastFed">Nunca</span></div>
                    <button class="feed-btn" onclick="feedDog()" id="feedDogBtn">🥩 Dar Ração</button>
                    <button class="feed-btn" onclick="giveBone()" id="giveBoneBtn">🦴 Dar Osso</button>
                </div>
            </div>

            <!-- Horse Stable -->
            <div id="horseStable" class="pet-house" style="display: none;">
                <h4>🐎 Baia do Duque</h4>
                <div class="pet-info">
                    <div>❤️ Amizade: <span id="horseFriendship">0</span>%</div>
                    <div class="friendship-bar">
                        <div class="friendship-fill" id="horseFriendshipBar" style="width: 0%"></div>
                    </div>
                    <div>🌾 Última refeição: <span id="horseLastFed">Nunca</span></div>
                    <button class="feed-btn" onclick="feedHorse()" id="feedHorseBtn">🌾 Dar Feno</button>
                    <button class="feed-btn" onclick="giveApple()" id="giveAppleBtn">🍎 Dar Maçã</button>
                </div>
            </div>
        </div>

        <!-- Center Area -->
        <div class="farm-area">
            <h2 style="color: #8B4513; text-align: center; margin-bottom: 10px;">🌱 Sua Fazenda</h2>
            <div class="farm-grid" id="farmGrid"></div>
            
            <!-- Well -->
            <div id="wellContainer" style="display: none;">
                <div class="well" onclick="collectWater()">🏗️</div>
                <p style="text-align: center; color: #8B4513; font-weight: bold;">Poço de Água - Clique para coletar</p>
            </div>

            <!-- Chicken Coop -->
            <div id="chickenCoop" class="animal-structure" style="display: none;">
                <h4>🐔 Galinheiro</h4>
                <div class="animals-grid" id="chickensGrid"></div>
                <button class="feed-btn" onclick="feedAllChickens()">🌾 Alimentar Todas</button>
            </div>

            <!-- Pig Pen -->
            <div id="pigPen" class="animal-structure" style="display: none;">
                <h4>🐷 Chiqueiro</h4>
                <div class="animals-grid" id="pigsGrid"></div>
                <button class="feed-btn" onclick="feedAllPigs()">🌾 Alimentar Todos</button>
            </div>

            <!-- Sheep Pen -->
            <div id="sheepPen" class="animal-structure" style="display: none;">
                <h4>🐑 Curral das Ovelhas</h4>
                <div class="animals-grid" id="sheepGrid"></div>
                <button class="feed-btn" onclick="feedAllSheep()">🌾 Alimentar Todas</button>
                <button class="feed-btn" onclick="shearAllSheep()">✂️ Tosquiar Todas</button>
            </div>

            <!-- Cow Pasture -->
            <div id="cowPasture" class="animal-structure" style="display: none;">
                <h4>🐄 Pasto de Vacas</h4>
                <div class="animals-grid" id="cowsGrid"></div>
                <button class="feed-btn" onclick="feedAllCows()">🌾 Alimentar Todas</button>
            </div>

            <!-- Grass Field -->
            <div id="grassField" class="animal-structure" style="display: none;">
                <h4>🌱 Campo de Grama</h4>
                <div class="grass-grid" id="grassGrid"></div>
            </div>

            <!-- Forest -->
            <div id="forest" class="animal-structure" style="display: none;">
                <h4>🌳 Bosque</h4>
                <div class="trees-grid" id="treesGrid"></div>
                <div id="axeStatus" class="tool-status" style="display: none;">
                    🪓 Machado: <span id="axeUses">50</span> usos restantes
                </div>
            </div>

            <!-- Wood Cutting -->
            <div id="woodCutting" class="animal-structure" style="display: none;">
                <h4>🪓 Cortar Lenha</h4>
                <button class="feed-btn" onclick="cutWood()" id="cutWoodBtn">🪓 Cortar Lenha</button>
                <div id="woodCuttingStatus">Clique para transformar troncos em lenha!</div>
            </div>

            <!-- Beehive -->
            <div id="beehive" class="animal-structure" style="display: none;">
                <h4>🍯 Colmeia</h4>
                <div class="bees-grid" id="beesGrid"></div>
                <div id="honeyStatus" style="text-align: center; margin-top: 10px; font-weight: bold;">
                    Próxima coleta em: <span id="honeyTimer">5:00</span>
                </div>
            </div>

            <!-- Flower Field -->
            <div id="flowerField" class="animal-structure" style="display: none;">
                <h4>🌸 Campo de Flores</h4>
                <div class="flowers-grid" id="flowersGrid"></div>
            </div>

            <!-- Producer Fair -->
            <div id="producerFair" class="animal-structure" style="display: none;">
                <h4>🏪 Feira do Produtor</h4>
                <p style="text-align: center; margin-bottom: 15px; color: #8B4513;">
                    Exponha seus produtos! Cada item gera 50 moedas a cada 15 minutos.
                </p>
                <div class="flowers-grid" id="fairGrid"></div>
                <div style="text-align: center; margin-top: 10px; font-weight: bold;">
                    Próximo pagamento em: <span id="fairTimer">15:00</span>
                </div>
            </div>

            <!-- Craft Table -->
            <div id="craftTable" class="animal-structure" style="display: none;">
                <h4>🔨 Mesa de Graft</h4>
                <p style="text-align: center; margin-bottom: 15px; color: #8B4513;">
                    Crie joias e buquês especiais para vender na quitanda!
                </p>
                <div class="flowers-grid" id="craftGrid">
                    <div class="craft-item" onclick="craftPearlNecklace()">
                        <div class="craft-emoji">📿</div>
                        <div class="craft-name">Colar de Pérolas</div>
                        <div class="craft-recipe">6 Pérolas</div>
                        <div class="craft-time">10s</div>
                    </div>
                    <div class="craft-item" onclick="craftEmeraldRing()">
                        <div class="craft-emoji">💍</div>
                        <div class="craft-name">Anel de Esmeralda</div>
                        <div class="craft-recipe">1 Esmeralda</div>
                        <div class="craft-time">20s</div>
                    </div>
                    <div class="craft-item" onclick="craftFlowerBouquet()">
                        <div class="craft-emoji">💐</div>
                        <div class="craft-name">Buquê de Flores</div>
                        <div class="craft-recipe">1 Rosa + 1 Girassol + 1 Margarida</div>
                        <div class="craft-time">15s</div>
                    </div>
                </div>
                <div id="craftStatus" style="text-align: center; margin-top: 10px; font-weight: bold;">
                    Pronta para usar
                </div>
            </div>

            <!-- Bonfire -->
            <div id="bonfire" class="animal-structure" style="display: none;">
                <h4>🔥 Fogueira</h4>
                <p style="text-align: center; margin-bottom: 15px; color: #8B4513;">
                    Mantenha os animais aquecidos no inverno para que produzam!
                </p>
                <div style="text-align: center; margin: 20px 0;">
                    <div id="bonfireFlame" style="font-size: 64px; margin: 20px 0;">🔥</div>
                    <div id="bonfireStatus" style="font-weight: bold; margin: 10px 0;">Fogueira apagada</div>
                    <div id="bonfireTimer" style="color: #666; margin: 5px 0;"></div>
                </div>
                <button class="feed-btn" onclick="lightBonfire()" id="lightBonfireBtn">🔥 Acender Fogueira</button>
                <div style="text-align: center; margin-top: 10px; font-size: 12px; color: #666;">
                    Receita: 3 Carvões + 4 Lenhas
                </div>
            </div>

            <!-- Greenhouse -->
            <div id="greenhouse" class="animal-structure" style="display: none;">
                <h4>🏠 Estufa</h4>
                <p style="text-align: center; margin-bottom: 15px; color: #8B4513;">
                    Canteiros protegidos do frio do inverno!
                </p>
                <div class="farm-grid" id="greenhouseGrid" style="grid-template-columns: repeat(4, 1fr); gap: 10px;"></div>
            </div>

            <!-- Fish Lake -->
            <div id="fishLake" class="animal-structure">
                <h4>🎣 Lago dos Peixes</h4>
                <div class="fish-grid" id="fishGrid"></div>
                <div id="fishingRodStatus" class="tool-status" style="display: none;">
                    🎣 Vara de Pesca: <span id="rodUses">20</span> usos restantes
                </div>
            </div>

            <!-- Mine -->
            <div id="mine" class="animal-structure">
                <h4>⛏️ Mina</h4>
                <div class="rocks-grid" id="rocksGrid"></div>
                <div id="pickaxeStatus" class="tool-status" style="display: none;">
                    ⛏️ Picareta: <span id="pickaxeUses">30</span> usos restantes
                </div>
                <div id="mineAccess" style="text-align: center; color: #cc0000; font-weight: bold;">
                    🔒 Precisa de uma chave para entrar na mina!
                </div>
            </div>

            <!-- Quitanda na coluna central -->
            <div class="quitanda-center" style="margin-top: 20px;">
                <h3 style="color: #8B4513; text-align: center; margin-bottom: 20px;">🏪 Quitanda</h3>
                <div id="inventory" style="display: flex; flex-direction: column; gap: 25px;">
                    <div class="quitanda-section">
                        <h4 style="color: #8B4513; border-bottom: 2px solid #8B4513; padding-bottom: 8px; margin-bottom: 15px;">🌾 Produtos da Fazenda</h4>
                        <div id="farmProducts" class="quitanda-items"></div>
                    </div>
                    <div class="quitanda-section">
                        <h4 style="color: #8B4513; border-bottom: 2px solid #8B4513; padding-bottom: 8px; margin-bottom: 15px;">🍎 Frutas e Vegetais</h4>
                        <div id="fruitsVegetables" class="quitanda-items"></div>
                    </div>
                    <div class="quitanda-section">
                        <h4 style="color: #8B4513; border-bottom: 2px solid #8B4513; padding-bottom: 8px; margin-bottom: 15px;">💎 Outros Produtos</h4>
                        <div id="others" class="quitanda-items"></div>
                    </div>
                </div>
                <button class="sell-all-btn" onclick="sellAll()" style="margin-top: 25px;">💰 Vender Tudo</button>
            </div>
        </div>

        <!-- Right Sidebar - Machines -->
        <div class="machines-sidebar">
            <!-- Composter -->
            <div id="composter" class="machine">
                <h4>🗑️ Composteira</h4>
                <div class="recipe-info">Receita: 1 Flor + 1 Galho + 2 Estercos = 8 Adubos</div>
                <div class="machine-status">Flores: <span id="flowerStorage">0</span> | Galhos: <span id="branchStorage">0</span> | Estercos: <span id="manureStorage">0</span></div>
                <div id="composterStatus" class="machine-status">Pronta para usar</div>
                <button class="machine-btn" onclick="startComposting()" id="composterBtn">🗑️ Fazer Adubo</button>
            </div>

            <!-- Mixer -->
            <div id="mixer" class="machine">
                <h4>🥣 Misturador</h4>
                <div class="recipe-info">
                    Ração Galinha: 1 Trigo + 2 Milhos<br>
                    Ração Porco: 1 Milho + 1 Batata + 1 Cenoura + 1 Brócolis
                </div>
                <div id="mixerStatus" class="machine-status">Pronto para usar</div>
                <button class="machine-btn" onclick="makeChickenFeed()" id="chickenFeedBtn">🐔 Ração Galinha</button>
                <button class="machine-btn" onclick="makePigFeed()" id="pigFeedBtn">🐷 Ração Porco</button>
            </div>

            <!-- Coffee Roaster -->
            <div id="coffeeRoaster" class="machine">
                <h4>☕ Torra de Café</h4>
                <div class="recipe-info">Receita: 4 Cafés + 3 Lenhas = 1 Saco de Café</div>
                <div class="machine-status">Armazenado: <span id="coffeeStorage">0</span> Cafés</div>
                <div id="coffeeRoasterStatus" class="machine-status">Pronta para usar</div>
                <button class="machine-btn" onclick="roastCoffee()" id="coffeeRoasterBtn">☕ Torrar Café</button>
            </div>

            <!-- Juice Machine -->
            <div id="juiceMachine" class="machine">
                <h4>🧃 Máquina de Suco</h4>
                <div class="recipe-info">Receita: 2 Uvas = 1 Suco de Uva</div>
                <div class="machine-status">Armazenado: <span id="grapeStorage">0</span> Uvas</div>
                <div id="juiceMachineStatus" class="machine-status">Pronta para usar</div>
                <button class="machine-btn" onclick="makeJuice()" id="juiceMachineBtn">🧃 Fazer Suco</button>
            </div>

            <!-- Mill -->
            <div id="mill" class="machine">
                <h4>🌾 Moinho</h4>
                <div class="recipe-info">Receita: 4 Trigos = 1 Saco de Farinha</div>
                <div class="machine-status">Armazenado: <span id="wheatStorage">0</span> Trigos</div>
                <div id="millStatus" class="machine-status">Pronto para usar</div>
                <button class="machine-btn" onclick="makeFlour()" id="millBtn">🌾 Fazer Farinha</button>
            </div>

            <!-- Cheese Maker -->
            <div id="cheeseMaker" class="machine">
                <h4>🧀 Queijeira</h4>
                <div class="recipe-info">Receita: 2 Leites = 1 Queijo</div>
                <div id="cheeseMakerStatus" class="machine-status">Pronta para usar</div>
                <button class="machine-btn" onclick="makeCheese()" id="cheeseMakerBtn">🧀 Fazer Queijo</button>
            </div>

            <!-- Spinning Machine -->
            <div id="spinningMachine" class="machine">
                <h4>🧶 Máquina de Fiar</h4>
                <div class="recipe-info">Receita: 2 Lãs = 1 Novelo</div>
                <div class="machine-status">Armazenado: <span id="woolStorage">0</span> Lãs</div>
                <div id="spinningMachineStatus" class="machine-status">Pronta para usar</div>
                <button class="machine-btn" onclick="spinWool()" id="spinningMachineBtn">🧶 Fazer Novelo</button>
            </div>

            <!-- Grass Dryer -->
            <div id="grassDryer" class="machine">
                <h4>🌾 Secador de Grama</h4>
                <div class="recipe-info">Seca 4-8 Gramas por vez</div>
                <div class="machine-status">Grama: <span id="grassStorage">0</span> | Seca: <span id="driedGrassStorage">0</span></div>
                <div id="grassDryerStatus" class="machine-status">Pronto para usar</div>
                <button class="machine-btn" onclick="dryGrass()" id="grassDryerBtn">🌾 Secar Grama</button>
                <button class="machine-btn" onclick="makeHayFromGrass()" id="makeHayBtn">🌾 Fazer Feno</button>
            </div>

            <!-- Wood Cutter -->
            <div id="woodCutter" class="machine">
                <h4>🪓 Cortador de Lenha</h4>
                <div class="recipe-info">Receita: 1 Tronco = 4 Lenhas</div>
                <div class="machine-status">Armazenado: <span id="trunkStorage">0</span> Troncos</div>
                <div id="woodCutterStatus" class="machine-status">Pronto para usar</div>
                <button class="machine-btn" onclick="cutWoodMachine()" id="woodCutterBtn">🪓 Cortar Lenha</button>
            </div>

            <!-- Stove -->
            <div id="stove" class="machine">
                <h4>🔥 Fogão com Forno</h4>
                <div class="recipe-info">
                    Fogão (2 lenhas): Chá, Salada, Ensopado, Bife<br>
                    Forno (3 lenhas): Frango, Peixe, Pão
                </div>
                <div id="stoveStatus" class="machine-status">Pronto para usar</div>
                <button class="machine-btn" onclick="openStoveMenu()" id="stoveBtn">🔥 Cozinhar</button>
            </div>
        </div>
    </div>

    <div class="rain-effect" id="rainEffect"></div>

    <!-- Mailbox Modal -->
    <div class="modal" id="mailboxModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeMailbox()">&times;</button>
            <h3>📮 Caixa de Correios</h3>
            <div id="mailContent"></div>
        </div>
    </div>

    <!-- Food Menu Modal -->
    <div class="modal" id="foodModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeFoodMenu()">&times;</button>
            <h3 id="foodModalTitle">🍽️ Menu de Comida</h3>
            <div id="foodMenuContent" class="food-menu"></div>
        </div>
    </div>

    <!-- Stove Menu Modal -->
    <div class="modal" id="stoveModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeStoveMenu()">&times;</button>
            <h3>🔥 Fogão com Forno</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4>🔥 Fogão (2 lenhas)</h4>
                    <div id="stoveRecipes" class="food-menu"></div>
                </div>
                <div>
                    <h4>🔥 Forno (3 lenhas)</h4>
                    <div id="ovenRecipes" class="food-menu"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            coins: 200,
            water: 10,
            fertilizer: 50,
            season: 0, // 0=Primavera, 1=Verão, 2=Outono, 3=Inverno
            seasonTime: 3600, // 1 hora em segundos
            selectedSeed: null,
            hasWell: false,
            hasDogHouse: false,
            hasHorseStable: false,
            hasChickenCoop: false,
            hasPigPen: false,
            hasSheepPen: false,
            hasCowPasture: false,
            hasFlowerField: false,
            hasProducerFair: false,
            hasCraftTable: false,
            hasBonfire: false,
            hasGreenhouse: false,
            hasGrassField: false,
            hasForest: false,

            hasShears: false,
            hasAxe: false,
            hasFishingRod: false,
            hasPickaxe: false,
            hasBeehive: false,
            axeUses: 0,
            fishingRodUses: 0,
            pickaxeUses: 0,
            mineAccess: false,
            avatar: {
                energy: 200,
                maxEnergy: 200,
                sick: false,
                sickTime: 0,
                resting: false,
                restStartTime: 0,
                firstSickness: Date.now() + 900000 // 15 minutes
            },
            beehive: {
                bees: [true, true, true],
                lastHarvest: 0,
                honeyTimer: 300 // 5 minutes in seconds
            },
            mailbox: {
                hasNewMail: false,
                mails: [],
                lastNewspaper: 0
            },
            dogFriendship: 0,
            horseFriendship: 0,
            dogLastFed: 0,
            horseLastFed: 0,
            dogFoodCount: 0,
            chickens: [],
            pigs: [],
            sheep: [],
            cows: [],
            flowers: {
                rosa: 3,
                girassol: 3,
                margarida: 3,
                lastHarvest: 0
            },
            producerFair: {
                slots: [null, null, null],
                lastEarning: 0
            },
            craftTable: {
                working: false,
                startTime: 0,
                recipe: null
            },
            bonfire: {
                lit: false,
                startTime: 0,
                duration: 1500000 // 25 minutes
            },
            greenhousePlots: Array(12).fill().map(() => ({
                state: 'empty',
                seedType: null,
                plantTime: null
            })),
            grass: Array(20).fill(true),
            grassHarvested: 0,
            trees: {
                trunk: { clicks: 0, branches: 0 },
                apple: { fruits: 4, lastHarvest: 0 },
                orange: { fruits: 4, lastHarvest: 0 },
                banana: { fruits: 4, lastHarvest: 0 }
            },
            fish: Array(4).fill(true),
            fishCaught: 0,
            rocks: Array(3).fill().map(() => ({ hits: 0, resting: false, restTime: 0 })),
            plots: Array(8).fill().map(() => ({
                state: 'empty', // empty, fertilized, planted, watered, ready
                seedType: null,
                plantTime: null
            })),
            inventory: {
                farmProducts: {},
                fruitsVegetables: {},
                others: {}
            },
            barn: {
                bones: 0,
                keys: 0,
                hay: 0,
                coal: 0,
                tea: 0,
                wood: 0,
                dogFood: 0,
                vaccines: 0
            },
            machineStorage: {
                composter: {
                    flowers: 0,
                    branches: 0,
                    manure: 0
                },
                mixer: {
                    chickenFeed: 0,
                    pigFeed: 0
                },
                coffeeRoaster: {
                    coffee: 0
                },
                juiceMachine: {
                    grapes: 0
                },
                mill: {
                    wheat: 0
                },
                cheeseMaker: {
                    cheese: 0
                },
                spinningMachine: {
                    wool: 0
                },
                grassDryer: {
                    grass: 0,
                    driedGrass: 0
                },
                woodCutter: {
                    trunks: 0
                },
                stove: {
                    porkMeat: 0,
                    herbs: 0
                }
            },
            machines: {
                hasComposter: false,
                hasMixer: false,
                hasCoffeeRoaster: false,
                hasJuiceMachine: false,
                hasMill: false,
                hasCheeseMaker: false,
                hasSpinningMachine: false,
                hasGrassDryer: false,
                hasWoodCutter: false,
                hasStove: false,
                composter: { working: false, startTime: 0 },
                mixer: { working: false, startTime: 0, type: null },
                coffeeRoaster: { working: false, startTime: 0 },
                juiceMachine: { working: false, startTime: 0 },
                mill: { working: false, startTime: 0 },
                cheeseMaker: { working: false, startTime: 0 },
                spinningMachine: { working: false, startTime: 0 },
                grassDryer: { working: false, startTime: 0 },
                woodCutter: { working: false, startTime: 0 },
                stove: { working: false, startTime: 0, type: null }
            },
            orders: []
        };

        const seasons = ['Primavera', 'Verão', 'Outono', 'Inverno'];
        const seasonEmojis = ['🌸', '☀️', '🍂', '❄️'];
        
        const seeds = [
            {name: 'Trigo', emoji: '🌾', price: 10, category: 'farmProducts'},
            {name: 'Milho', emoji: '🌽', price: 10, category: 'farmProducts'},
            {name: 'Café', emoji: '🔴', price: 10, category: 'farmProducts'},
            {name: 'Batata', emoji: '🥔', price: 10, category: 'fruitsVegetables'},
            {name: 'Tomate', emoji: '🍅', price: 10, category: 'fruitsVegetables'},
            {name: 'Cenoura', emoji: '🥕', price: 10, category: 'fruitsVegetables'},
            {name: 'Abóbora', emoji: '🎃', price: 10, category: 'fruitsVegetables'},
            {name: 'Brócolis', emoji: '🥦', price: 10, category: 'fruitsVegetables'},
            {name: 'Alface', emoji: '🥬', price: 10, category: 'fruitsVegetables'},
            {name: 'Uva', emoji: '🍇', price: 10, category: 'fruitsVegetables'}
        ];

        // Initialize game
        function initGame() {
            createFarmGrid();
            createSeedsGrid();
            updateUI();
            updateBarnDisplay();
            updateInventoryDisplay();
            updatePetUI();
            
            // Initialize flower field if it's spring
            if (gameState.season === 0) {
                gameState.hasFlowerField = true;
                document.getElementById('flowerField').style.display = 'block';
                updateFlowersDisplay();
            }
            
            // Initialize fish lake and mine
            updateFishDisplay();
            updateRocksDisplay();
            
            loadGame();
            
            // Auto-save every 10 seconds
            setInterval(saveGame, 10000);
            
            // Season timer
            setInterval(updateSeasonTimer, 1000);
            
            // Rain system - every 10 minutes
            setInterval(startRain, 600000);
            
            // Check plant growth
            setInterval(checkPlantGrowth, 1000);
            
            // Update pet UI every second
            setInterval(updatePetUI, 1000);
            
            // Check animal health every 30 seconds
            setInterval(checkAnimalHealth, 30000);
            
            // Check chicken breeding every 15 minutes
            setInterval(checkChickenBreeding, 900000);
            
            // Update displays every 5 seconds
            setInterval(() => {
                if (gameState.hasChickenCoop) updateChickensDisplay();
                if (gameState.hasPigPen) updatePigsDisplay();
                if (gameState.hasSheepPen) updateSheepDisplay();
                if (gameState.hasCowPasture) updateCowsDisplay();
                if (gameState.hasGrassField) updateGrassDisplay();
                if (gameState.hasForest) updateTreesDisplay();
                if (gameState.hasBeehive) updateBeehiveDisplay();
                if (gameState.hasProducerFair) updateProducerFairDisplay();
                if (gameState.hasCraftTable) updateCraftTableDisplay();
                if (gameState.hasBonfire) updateBonfireDisplay();
                if (gameState.hasGreenhouse) updateGreenhouseDisplay();
                updateFishDisplay();
                updateRocksDisplay();
                updateAvatarUI();
                updateMachineStorageDisplay();
                
                // Update machine statuses
                if (gameState.machines) {
                    Object.keys(gameState.machines).forEach(key => {
                        if (key.startsWith('has') && gameState.machines[key]) {
                            const machineType = key.replace('has', '').toLowerCase();
                            if (machineType !== 'composter' && machineType !== 'mixer' && 
                                machineType !== 'coffeeroaster' && machineType !== 'juicemachine' &&
                                machineType !== 'mill' && machineType !== 'cheesemaker' &&
                                machineType !== 'spinningmachine' && machineType !== 'grassdryer' &&
                                machineType !== 'woodcutter' && machineType !== 'stove') return;
                            
                            const correctType = machineType === 'coffeeroaster' ? 'coffeeRoaster' :
                                              machineType === 'juicemachine' ? 'juiceMachine' :
                                              machineType === 'cheesemaker' ? 'cheeseMaker' :
                                              machineType === 'spinningmachine' ? 'spinningMachine' :
                                              machineType === 'grassdryer' ? 'grassDryer' :
                                              machineType === 'woodcutter' ? 'woodCutter' : machineType;
                            
                            updateMachineStatus(correctType);
                        }
                    });
                }
            }, 5000);
            
            // Avatar sickness check every 10 seconds
            setInterval(checkAvatarSickness, 10000);
            
            // Send random mail every 10-20 minutes
            setInterval(() => {
                if (Math.random() < 0.3) sendRandomMail();
            }, 600000);
            
            // Send newspaper every 30 minutes
            setInterval(sendNewspaper, 1800000);
            
            // Check grass regrowth every minute
            setInterval(checkGrassRegrowth, 60000);
            
            // Check tree fruit regrowth every 5 minutes
            setInterval(checkTreeRegrowth, 300000);
            
            // Check fish respawn every 3 minutes
            setInterval(checkFishRespawn, 180000);
            
            // Check rock rest time every minute
            setInterval(checkRockRest, 60000);
            
            // Producer fair earnings every 15 minutes
            setInterval(checkProducerFairEarnings, 900000);
        }

        function createFarmGrid() {
            const farmGrid = document.getElementById('farmGrid');
            farmGrid.innerHTML = '';
            
            for (let i = 0; i < 8; i++) {
                const plot = document.createElement('div');
                plot.className = 'plot';
                plot.id = `plot-${i}`;
                plot.onclick = () => handlePlotClick(i);
                farmGrid.appendChild(plot);
            }
        }

        function createSeedsGrid() {
            const seedsGrid = document.getElementById('seedsGrid');
            seedsGrid.innerHTML = '';
            
            seeds.forEach((seed, index) => {
                const seedBtn = document.createElement('div');
                seedBtn.className = 'seed-btn';
                seedBtn.innerHTML = `${seed.emoji}<br>${seed.name}<br>💰${seed.price}`;
                seedBtn.onclick = () => selectSeed(index);
                seedsGrid.appendChild(seedBtn);
            });
        }

        function selectSeed(index) {
            gameState.selectedSeed = index;
            document.querySelectorAll('.seed-btn').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
        }

        function handlePlotClick(plotIndex) {
            // Disable farming in winter unless using greenhouse
            if (gameState.season === 3) {
                alert('❄️ Muito frio para plantar! Compre uma estufa no mercadinho!');
                return;
            }
            
            const plot = gameState.plots[plotIndex];
            
            if (plot.state === 'empty') {
                // Fertilize
                if (gameState.fertilizer > 0) {
                    gameState.fertilizer--;
                    plot.state = 'fertilized';
                    updatePlotDisplay(plotIndex);
                    updateUI();
                    useEnergy(1);
                }
            } else if (plot.state === 'fertilized') {
                // Plant
                if (gameState.selectedSeed !== null && gameState.coins >= seeds[gameState.selectedSeed].price) {
                    gameState.coins -= seeds[gameState.selectedSeed].price;
                    plot.state = 'planted';
                    plot.seedType = gameState.selectedSeed;
                    plot.plantTime = Date.now();
                    updatePlotDisplay(plotIndex);
                    updateUI();
                    useEnergy(1);
                }
            } else if (plot.state === 'planted') {
                // Water
                if (gameState.water > 0) {
                    gameState.water--;
                    plot.state = 'watered';
                    updatePlotDisplay(plotIndex);
                    updateUI();
                    useEnergy(1);
                }
            } else if (plot.state === 'ready') {
                // Harvest
                const seed = seeds[plot.seedType];
                let harvestAmount = gameState.season === 1 ? 2 : 1; // Double harvest in summer
                
                // Store items in their designated locations
                if (seed.name === 'Café') {
                    gameState.machineStorage.coffeeRoaster.coffee += harvestAmount;
                } else if (seed.name === 'Uva') {
                    gameState.machineStorage.juiceMachine.grapes += harvestAmount;
                } else if (seed.name === 'Trigo') {
                    gameState.machineStorage.mill.wheat += harvestAmount;
                } else {
                    // Store in quitanda for sale
                    const category = seed.category;
                    if (!gameState.inventory[category][seed.name]) {
                        gameState.inventory[category][seed.name] = 0;
                    }
                    gameState.inventory[category][seed.name] += harvestAmount;
                }
                
                // Reset plot
                plot.state = 'empty';
                plot.seedType = null;
                plot.plantTime = null;
                updatePlotDisplay(plotIndex);
                updateInventoryDisplay();
                useEnergy(1);
                
                if (harvestAmount > 1) {
                    alert(`☀️ Bônus do Verão! Você colheu ${harvestAmount}x ${seed.name}!`);
                }
            }
        }

        function updatePlotDisplay(plotIndex) {
            const plotElement = document.getElementById(`plot-${plotIndex}`);
            const plot = gameState.plots[plotIndex];
            
            plotElement.className = `plot ${plot.state}`;
            
            switch (plot.state) {
                case 'empty':
                    plotElement.innerHTML = '';
                    break;
                case 'fertilized':
                    plotElement.innerHTML = '🍂';
                    break;
                case 'planted':
                    plotElement.innerHTML = '🌱';
                    break;
                case 'watered':
                    plotElement.innerHTML = '💧';
                    break;
                case 'ready':
                    plotElement.innerHTML = seeds[plot.seedType].emoji;
                    break;
            }
        }

        function checkPlantGrowth() {
            gameState.plots.forEach((plot, index) => {
                if (plot.state === 'watered' && plot.plantTime) {
                    const timePassed = Date.now() - plot.plantTime;
                    if (timePassed >= 30000) { // 30 seconds
                        plot.state = 'ready';
                        updatePlotDisplay(index);
                    }
                }
            });
            
            // Check greenhouse plots
            if (gameState.hasGreenhouse) {
                gameState.greenhousePlots.forEach((plot, index) => {
                    if (plot.state === 'watered' && plot.plantTime) {
                        const timePassed = Date.now() - plot.plantTime;
                        if (timePassed >= 30000) { // 30 seconds
                            plot.state = 'ready';
                            updateGreenhousePlotDisplay(index);
                        }
                    }
                });
            }
        }

        function updateSeasonTimer() {
            gameState.seasonTime--;
            
            if (gameState.seasonTime <= 0) {
                gameState.season = (gameState.season + 1) % 4;
                gameState.seasonTime = 3600; // Reset to 1 hour
                
                // Handle seasonal features
                if (gameState.season === 0) { // Spring
                    gameState.hasFlowerField = true;
                    gameState.hasProducerFair = false;
                    gameState.hasCraftTable = false;
                    gameState.hasBonfire = false;
                    gameState.flowers = {
                        rosa: 3,
                        girassol: 3,
                        margarida: 3,
                        lastHarvest: 0
                    };
                    document.getElementById('flowerField').style.display = 'block';
                    document.getElementById('producerFair').style.display = 'none';
                    document.getElementById('craftTable').style.display = 'none';
                    document.getElementById('bonfire').style.display = 'none';
                    document.getElementById('greenhouse').style.display = 'none';
                    document.getElementById('greenhouseShop').style.display = 'none';
                    updateFlowersDisplay();
                } else if (gameState.season === 1) { // Summer
                    gameState.hasFlowerField = false;
                    gameState.hasProducerFair = true;
                    gameState.hasCraftTable = false;
                    gameState.hasBonfire = false;
                    gameState.producerFair.lastEarning = Date.now();
                    document.getElementById('flowerField').style.display = 'none';
                    document.getElementById('producerFair').style.display = 'block';
                    document.getElementById('craftTable').style.display = 'none';
                    document.getElementById('bonfire').style.display = 'none';
                    document.getElementById('greenhouse').style.display = 'none';
                    document.getElementById('greenhouseShop').style.display = 'none';
                    updateProducerFairDisplay();
                } else if (gameState.season === 2) { // Autumn
                    gameState.hasFlowerField = false;
                    gameState.hasProducerFair = false;
                    gameState.hasCraftTable = true;
                    gameState.hasBonfire = false;
                    document.getElementById('flowerField').style.display = 'none';
                    document.getElementById('producerFair').style.display = 'none';
                    document.getElementById('craftTable').style.display = 'block';
                    document.getElementById('bonfire').style.display = 'none';
                    document.getElementById('greenhouse').style.display = 'none';
                    document.getElementById('greenhouseShop').style.display = 'none';
                    updateCraftTableDisplay();
                } else { // Winter
                    gameState.hasFlowerField = false;
                    gameState.hasProducerFair = false;
                    gameState.hasCraftTable = false;
                    gameState.hasBonfire = true;
                    document.getElementById('flowerField').style.display = 'none';
                    document.getElementById('producerFair').style.display = 'none';
                    document.getElementById('craftTable').style.display = 'none';
                    document.getElementById('bonfire').style.display = 'block';
                    document.getElementById('greenhouseShop').style.display = 'block';
                    if (gameState.hasGreenhouse) {
                        document.getElementById('greenhouse').style.display = 'block';
                        updateGreenhouseDisplay();
                    }
                    updateBonfireDisplay();
                }
            }
            
            const minutes = Math.floor(gameState.seasonTime / 60);
            const seconds = gameState.seasonTime % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('season').textContent = 
                `${seasonEmojis[gameState.season]} ${seasons[gameState.season]}`;
        }

        function startRain() {
            if (gameState.season === 3) { // Winter - snow instead of rain
                document.body.classList.add('snowing');
                createSnowEffect();
                
                // Snow doesn't water crops, but waters greenhouse if available
                if (gameState.hasGreenhouse) {
                    gameState.greenhousePlots.forEach((plot, index) => {
                        if (plot.state === 'planted') {
                            plot.state = 'watered';
                            updateGreenhousePlotDisplay(index);
                        }
                    });
                }
                
                setTimeout(() => {
                    document.body.classList.remove('snowing');
                    document.getElementById('rainEffect').innerHTML = '';
                }, 15000);
            } else {
                document.body.classList.add('raining');
                createRainEffect();
                
                // Auto-water all planted crops
                gameState.plots.forEach((plot, index) => {
                    if (plot.state === 'planted') {
                        plot.state = 'watered';
                        updatePlotDisplay(index);
                    }
                });
                
                setTimeout(() => {
                    document.body.classList.remove('raining');
                    document.getElementById('rainEffect').innerHTML = '';
                }, 15000);
            }
        }

        function createRainEffect() {
            const rainEffect = document.getElementById('rainEffect');
            rainEffect.innerHTML = '';
            
            for (let i = 0; i < 100; i++) {
                const drop = document.createElement('div');
                drop.className = 'raindrop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
                drop.style.animationDelay = Math.random() * 2 + 's';
                rainEffect.appendChild(drop);
            }
        }

        function createSnowEffect() {
            const rainEffect = document.getElementById('rainEffect');
            rainEffect.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.innerHTML = '❄️';
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDuration = (Math.random() * 3 + 2) + 's';
                snowflake.style.animationDelay = Math.random() * 2 + 's';
                rainEffect.appendChild(snowflake);
            }
        }

        function buyWell() {
            if (gameState.coins >= 50 && !gameState.hasWell) {
                gameState.coins -= 50;
                gameState.hasWell = true;
                document.getElementById('wellContainer').style.display = 'block';
                document.getElementById('wellShop').style.display = 'none';
                updateUI();
                alert('🏗️ Poço construído! Agora você tem água infinita!');
            }
        }

        function collectWater() {
            if (gameState.hasWell) {
                gameState.water += 4;
                updateUI();
            }
        }

        function buyDogHouse() {
            if (gameState.coins >= 200 && !gameState.hasDogHouse) {
                gameState.coins -= 200;
                gameState.hasDogHouse = true;
                document.getElementById('dogHouse').style.display = 'block';
                document.getElementById('dogHouseShop').style.display = 'none';
                updateUI();
                alert('🏠 Casinha da Mocinha construída! Ela está esperando por você!');
            }
        }

        function buyDogFood() {
            if (gameState.coins >= 30) {
                gameState.coins -= 30;
                gameState.barn.dogFood++;
                
                // Chance de ganhar osso a cada 2 rações
                if (gameState.barn.dogFood % 2 === 0) {
                    gameState.barn.bones++;
                    alert('🦴 Você ganhou um osso de surpresa!');
                }
                
                updateUI();
                updateBarnDisplay();
            }
        }

        function buyHorseStable() {
            if (gameState.coins >= 1000 && !gameState.hasHorseStable) {
                gameState.coins -= 1000;
                gameState.hasHorseStable = true;
                document.getElementById('horseStable').style.display = 'block';
                document.getElementById('horseStableShop').style.display = 'none';
                updateUI();
                alert('🏇 Baia do Duque construída! Ele está pronto para trabalhar!');
            }
        }

        function buyHay() {
            if (gameState.coins >= 20) {
                gameState.coins -= 20;
                gameState.barn.hay++;
                updateUI();
                updateBarnDisplay();
            }
        }

        function buyApple() {
            if (gameState.coins >= 15) {
                gameState.coins -= 15;
                gameState.barn.apples++;
                updateUI();
                updateBarnDisplay();
            }
        }

        function buyChickenCoop() {
            if (gameState.coins >= 80 && !gameState.hasChickenCoop) {
                gameState.coins -= 80;
                gameState.hasChickenCoop = true;
                document.getElementById('chickenCoop').style.display = 'block';
                document.getElementById('chickenShop').style.display = 'block';
                document.getElementById('chickenCoopShop').style.display = 'none';
                updateUI();
                updateChickensDisplay();
                alert('🐔 Galinheiro construído! Agora você pode comprar galinhas!');
            }
        }

        function buyChicken() {
            if (gameState.coins >= 25 && gameState.chickens.length < 4) {
                gameState.coins -= 25;
                gameState.chickens.push({
                    id: Date.now(),
                    type: 'chicken',
                    emoji: '🐔',
                    state: 'idle',
                    lastFed: 0,
                    eggs: 0,
                    sick: false,
                    sickTime: 0,
                    eating: false,
                    resting: false
                });
                updateUI();
                updateChickensDisplay();
            }
        }

        function buyPigPen() {
            if (gameState.coins >= 130 && !gameState.hasPigPen) {
                gameState.coins -= 130;
                gameState.hasPigPen = true;
                document.getElementById('pigPen').style.display = 'block';
                document.getElementById('pigShop').style.display = 'block';
                document.getElementById('pigPenShop').style.display = 'none';
                updateUI();
                updatePigsDisplay();
                alert('🐷 Chiqueiro construído! Agora você pode comprar porcos!');
            }
        }

        function buyPig() {
            if (gameState.coins >= 100 && gameState.pigs.length < 4) {
                gameState.coins -= 100;
                gameState.pigs.push({
                    id: Date.now(),
                    type: 'pig',
                    emoji: '🐷',
                    state: 'idle',
                    lastFed: 0,
                    meat: 0,
                    sick: false,
                    sickTime: 0,
                    eating: false,
                    resting: false
                });
                updateUI();
                updatePigsDisplay();
            }
        }

        function buySheepPen() {
            if (gameState.coins >= 150 && !gameState.hasSheepPen) {
                gameState.coins -= 150;
                gameState.hasSheepPen = true;
                document.getElementById('sheepPen').style.display = 'block';
                document.getElementById('sheepShop').style.display = 'block';
                document.getElementById('shearsShop').style.display = 'block';
                document.getElementById('sheepPenShop').style.display = 'none';
                updateUI();
                updateSheepDisplay();
                alert('🐑 Curral das Ovelhas construído! Agora você pode comprar ovelhas!');
            }
        }

        function buySheep() {
            if (gameState.coins >= 120 && gameState.sheep.length < 4) {
                gameState.coins -= 120;
                gameState.sheep.push({
                    id: Date.now(),
                    type: 'sheep',
                    emoji: '🐑',
                    state: 'idle',
                    lastFed: 0,
                    wool: 0,
                    sick: false,
                    sickTime: 0,
                    eating: false,
                    resting: false
                });
                updateUI();
                updateSheepDisplay();
            }
        }

        function buyShears() {
            if (gameState.coins >= 35 && !gameState.hasShears) {
                gameState.coins -= 35;
                gameState.hasShears = true;
                document.getElementById('shearsShop').style.display = 'none';
                updateUI();
                alert('✂️ Tesoura de Tosquiar comprada! Agora você pode tosquiar as ovelhas!');
            }
        }

        function buyCowPasture() {
            if (gameState.coins >= 200 && !gameState.hasCowPasture) {
                gameState.coins -= 200;
                gameState.hasCowPasture = true;
                document.getElementById('cowPasture').style.display = 'block';
                document.getElementById('cowShop').style.display = 'block';
                document.getElementById('cowPastureShop').style.display = 'none';
                updateUI();
                updateCowsDisplay();
                alert('🐄 Pasto de Vacas construído! Agora você pode comprar vacas!');
            }
        }

        function buyCow() {
            if (gameState.coins >= 95 && gameState.cows.length < 4) {
                gameState.coins -= 95;
                gameState.cows.push({
                    id: Date.now(),
                    type: 'cow',
                    emoji: '🐄',
                    state: 'idle',
                    lastFed: 0,
                    milk: 0,
                    manure: 0,
                    sick: false,
                    sickTime: 0,
                    eating: false,
                    resting: false
                });
                updateUI();
                updateCowsDisplay();
            }
        }

        function buyVaccine() {
            if (gameState.coins >= 40) {
                gameState.coins -= 40;
                gameState.barn.vaccines++;
                updateUI();
                updateBarnDisplay();
            }
        }

        function buyAnimalFeed() {
            if (gameState.coins >= 25) {
                gameState.coins -= 25;
                gameState.barn.animalFeed++;
                updateUI();
                updateBarnDisplay();
            }
        }

        function buyGrassField() {
            if (gameState.coins >= 75 && !gameState.hasGrassField) {
                gameState.coins -= 75;
                gameState.hasGrassField = true;
                document.getElementById('grassField').style.display = 'block';
                document.getElementById('grassFieldShop').style.display = 'none';
                updateUI();
                updateGrassDisplay();
                alert('🌱 Campo de Grama comprado! Colete as gramas para ganhar flores!');
            }
        }

        function buyForest() {
            if (gameState.coins >= 300 && !gameState.hasForest) {
                gameState.coins -= 300;
                gameState.hasForest = true;
                document.getElementById('forest').style.display = 'block';
                document.getElementById('forestShop').style.display = 'none';
                updateUI();
                updateTreesDisplay();
                alert('🌳 Bosque comprado! Colete frutas e troncos das árvores!');
            }
        }

        function buyAxeAndWoodCutting() {
            if (gameState.coins >= 100 && !gameState.hasAxe && !gameState.hasWoodCutting) {
                gameState.coins -= 100;
                gameState.hasAxe = true;
                gameState.hasWoodCutting = true;
                gameState.axeUses = 50;
                document.getElementById('woodCutting').style.display = 'block';
                document.getElementById('axeStatus').style.display = 'block';
                document.getElementById('axeShop').style.display = 'none';
                updateUI();
                updateAxeStatus();
                alert('🪓 Machado e Cortar Lenha comprados! Use o machado para coletar troncos e cortar lenha!');
            }
        }

        function buyAxe() {
            if (gameState.coins >= 50 && !gameState.hasAxe) {
                gameState.coins -= 50;
                gameState.hasAxe = true;
                gameState.axeUses = 50;
                document.getElementById('axeStatus').style.display = 'block';
                document.getElementById('axeOnlyShop').style.display = 'none';

                updateUI();
                updateAxeStatus();
                alert('🪓 Novo machado comprado! Agora você pode cortar lenha novamente!');
            }
        }

        function buyFishingRod() {
            if (gameState.coins >= 60) {
                gameState.coins -= 60;
                gameState.hasFishingRod = true;
                gameState.fishingRodUses = 20;
                document.getElementById('fishingRodStatus').style.display = 'block';
                updateUI();
                updateFishingRodStatus();
                alert('🎣 Vara de pesca comprada! Agora você pode pescar no lago!');
            }
        }

        function buyPickaxe() {
            if (gameState.coins >= 80) {
                gameState.coins -= 80;
                gameState.hasPickaxe = true;
                gameState.pickaxeUses = 30;
                document.getElementById('pickaxeStatus').style.display = 'block';
                updateUI();
                updatePickaxeStatus();
                alert('⛏️ Picareta comprada! Agora você pode minerar pedras preciosas!');
            }
        }

        function buyBeehive() {
            if (gameState.coins >= 120 && !gameState.hasBeehive) {
                gameState.coins -= 120;
                gameState.hasBeehive = true;
                gameState.beehive.lastHarvest = Date.now();
                document.getElementById('beehive').style.display = 'block';
                document.getElementById('beehiveShop').style.display = 'none';
                updateUI();
                updateBeehiveDisplay();
                alert('🍯 Colmeia comprada! As abelhas produzirão mel a cada 5 minutos!');
            }
        }

        function buyComposter() {
            if (gameState.coins >= 180 && !gameState.machines.hasComposter) {
                gameState.coins -= 180;
                gameState.machines.hasComposter = true;
                document.getElementById('composter').style.display = 'block';
                document.getElementById('composterShop').style.display = 'none';
                updateUI();
                alert('🗑️ Composteira comprada! Agora você pode fazer adubo!');
            }
        }

        function buyMixer() {
            if (gameState.coins >= 90 && !gameState.machines.hasMixer) {
                gameState.coins -= 90;
                gameState.machines.hasMixer = true;
                document.getElementById('mixer').style.display = 'block';
                document.getElementById('mixerShop').style.display = 'none';
                updateUI();
                alert('🥣 Misturador comprado! Agora você pode fazer rações!');
            }
        }

        function buyCoffeeRoaster() {
            if (gameState.coins >= 250 && !gameState.machines.hasCoffeeRoaster) {
                gameState.coins -= 250;
                gameState.machines.hasCoffeeRoaster = true;
                document.getElementById('coffeeRoaster').style.display = 'block';
                document.getElementById('coffeeRoasterShop').style.display = 'none';
                updateUI();
                alert('☕ Torra de Café comprada! Agora você pode torrar café!');
            }
        }

        function buyJuiceMachine() {
            if (gameState.coins >= 120 && !gameState.machines.hasJuiceMachine) {
                gameState.coins -= 120;
                gameState.machines.hasJuiceMachine = true;
                document.getElementById('juiceMachine').style.display = 'block';
                document.getElementById('juiceMachineShop').style.display = 'none';
                updateUI();
                alert('🧃 Máquina de Suco comprada! Agora você pode fazer suco de uva!');
            }
        }

        function buyMill() {
            if (gameState.coins >= 200 && !gameState.machines.hasMill) {
                gameState.coins -= 200;
                gameState.machines.hasMill = true;
                document.getElementById('mill').style.display = 'block';
                document.getElementById('millShop').style.display = 'none';
                updateUI();
                alert('🌾 Moinho comprado! Agora você pode fazer farinha!');
            }
        }

        function buyCheeseMaker() {
            if (gameState.coins >= 160 && !gameState.machines.hasCheeseMaker) {
                gameState.coins -= 160;
                gameState.machines.hasCheeseMaker = true;
                document.getElementById('cheeseMaker').style.display = 'block';
                document.getElementById('cheeseMakerShop').style.display = 'none';
                updateUI();
                alert('🧀 Queijeira comprada! Agora você pode fazer queijo!');
            }
        }

        function buySpinningMachine() {
            if (gameState.coins >= 140 && !gameState.machines.hasSpinningMachine) {
                gameState.coins -= 140;
                gameState.machines.hasSpinningMachine = true;
                document.getElementById('spinningMachine').style.display = 'block';
                document.getElementById('spinningMachineShop').style.display = 'none';
                updateUI();
                alert('🧶 Máquina de Fiar comprada! Agora você pode fazer novelos!');
            }
        }

        function buyGrassDryer() {
            if (gameState.coins >= 150 && !gameState.machines.hasGrassDryer) {
                gameState.coins -= 150;
                gameState.machines.hasGrassDryer = true;
                document.getElementById('grassDryer').style.display = 'block';
                document.getElementById('grassDryerShop').style.display = 'none';
                updateUI();
                alert('🌾 Secador de Grama comprado! Agora você pode secar grama e fazer feno!');
            }
        }

        function buyWoodCutter() {
            if (gameState.coins >= 85 && !gameState.machines.hasWoodCutter) {
                gameState.coins -= 85;
                gameState.machines.hasWoodCutter = true;
                document.getElementById('woodCutter').style.display = 'block';
                document.getElementById('woodCutterShop').style.display = 'none';
                updateUI();
                alert('🪓 Cortador de Lenha comprado! Agora você pode cortar troncos em lenha!');
            }
        }

        function buyStove() {
            if (gameState.coins >= 250 && !gameState.machines.hasStove) {
                gameState.coins -= 250;
                gameState.machines.hasStove = true;
                document.getElementById('stove').style.display = 'block';
                document.getElementById('stoveShop').style.display = 'none';
                updateUI();
                alert('🔥 Fogão com Forno comprado! Agora você pode cozinhar refeições!');
            }
        }

        function buyGreenhouse() {
            if (gameState.coins >= 500 && !gameState.hasGreenhouse && gameState.season === 3) {
                gameState.coins -= 500;
                gameState.hasGreenhouse = true;
                document.getElementById('greenhouse').style.display = 'block';
                document.getElementById('greenhouseShop').style.display = 'none';
                createGreenhouseGrid();
                updateUI();
                alert('🏠 Estufa comprada! Agora você pode plantar no inverno!');
            }
        }

        function lightBonfire() {
            if (gameState.barn.coal >= 3 && gameState.barn.wood >= 4 && !gameState.bonfire.lit) {
                gameState.barn.coal -= 3;
                gameState.barn.wood -= 4;
                gameState.bonfire.lit = true;
                gameState.bonfire.startTime = Date.now();
                
                updateBarnDisplay();
                updateBonfireDisplay();
                updateUI();
                
                // Auto-extinguish after 25 minutes
                setTimeout(() => {
                    if (gameState.bonfire.lit) {
                        gameState.bonfire.lit = false;
                        updateBonfireDisplay();
                        
                        // Alert player that bonfire went out
                        const alertDiv = document.createElement('div');
                        alertDiv.style.cssText = `
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background: #ff4444;
                            color: white;
                            padding: 20px 30px;
                            border-radius: 15px;
                            z-index: 3000;
                            font-weight: bold;
                            font-size: 18px;
                            text-align: center;
                            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                        `;
                        alertDiv.textContent = '🔥 A fogueira apagou! Os animais não produzirão até você acendê-la novamente!';
                        document.body.appendChild(alertDiv);
                        
                        setTimeout(() => {
                            document.body.removeChild(alertDiv);
                        }, 5000);
                    }
                }, gameState.bonfire.duration);
                
                alert('🔥 Fogueira acesa! Os animais ficarão aquecidos por 25 minutos!');
            } else if (gameState.bonfire.lit) {
                alert('A fogueira já está acesa!');
            } else {
                alert('Você precisa de 3 Carvões e 4 Lenhas para acender a fogueira!');
            }
        }

        function restAvatar() {
            if (!gameState.avatar.resting && !gameState.avatar.sick) {
                gameState.avatar.resting = true;
                gameState.avatar.restStartTime = Date.now();
                document.getElementById('restBtn').disabled = true;
                document.getElementById('restBtn').textContent = '😴 Descansando...';
                
                setTimeout(() => {
                    if (gameState.avatar.resting) {
                        gameState.avatar.energy = Math.min(gameState.avatar.maxEnergy, 
                            gameState.avatar.energy + Math.floor(gameState.avatar.maxEnergy * 0.5));
                        gameState.avatar.resting = false;
                        document.getElementById('restBtn').disabled = false;
                        document.getElementById('restBtn').textContent = '😴 Descansar 5min';
                        updateAvatarUI();
                    }
                }, 300000); // 5 minutes
            }
        }

        function openFoodMenu() {
            const modal = document.getElementById('foodModal');
            const content = document.getElementById('foodMenuContent');
            const title = document.getElementById('foodModalTitle');
            
            title.textContent = '🍽️ Menu de Comida';
            content.innerHTML = '';
            
            // Available cooked meals
            const meals = [
                {name: 'chá', displayName: 'Chá', emoji: '🍵', effect: 'Cura doença'},
                {name: 'salad', displayName: 'Salada', emoji: '🥗', effect: '+30% energia'},
                {name: 'stew', displayName: 'Ensopado', emoji: '🍲', effect: '+50% energia'},
                {name: 'steak', displayName: 'Bife', emoji: '🥩', effect: '+100% energia'},
                {name: 'chicken', displayName: 'Frango', emoji: '🍗', effect: '+65% energia'},
                {name: 'cookedFish', displayName: 'Peixe Cozido', emoji: '🐟', effect: '+80% energia'}
            ];
            
            let hasFood = false;
            
            meals.forEach(meal => {
                if (gameState.barn[meal.name] > 0) {
                    hasFood = true;
                    const foodItem = document.createElement('div');
                    foodItem.className = 'food-item';
                    foodItem.innerHTML = `${meal.emoji}<br>${meal.displayName}<br><small>${meal.effect}</small><br><small>Disponível: ${gameState.barn[meal.name]}</small>`;
                    foodItem.onclick = () => eatFood(meal.name, meal.displayName);
                    content.appendChild(foodItem);
                }
            });
            
            if (!hasFood) {
                content.innerHTML = '<p>Você não tem comida preparada! Use o fogão para cozinhar refeições.</p>';
            }
            
            modal.style.display = 'flex';
        }

        function closeFoodMenu() {
            document.getElementById('foodModal').style.display = 'none';
        }

        function openStoveMenu() {
            const modal = document.getElementById('stoveModal');
            const stoveRecipes = document.getElementById('stoveRecipes');
            const ovenRecipes = document.getElementById('ovenRecipes');
            
            // Stove recipes (2 wood)
            stoveRecipes.innerHTML = '';
            const stoveItems = [
                {name: 'Chá', emoji: '🍵', ingredients: ['1 Água', '2 Ervas'], effect: 'Cura doença'},
                {name: 'Salada', emoji: '🥗', ingredients: ['1 Tomate', '1 Alface', '1 Brócolis'], effect: '+30% energia'},
                {name: 'Ensopado', emoji: '🍲', ingredients: ['1 Ovo', '1 Batata', '1 Abóbora'], effect: '+50% energia'},
                {name: 'Bife', emoji: '🥩', ingredients: ['1 Carne Suína'], effect: '+100% energia'}
            ];
            
            stoveItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'food-item';
                div.innerHTML = `${item.emoji}<br>${item.name}<br><small>${item.ingredients.join(', ')}</small><br><small>${item.effect}</small>`;
                div.onclick = () => cookStove(item.name.toLowerCase());
                stoveRecipes.appendChild(div);
            });
            
            // Oven recipes (3 wood)
            ovenRecipes.innerHTML = '';
            const ovenItems = [
                {name: 'Frango', emoji: '🍗', ingredients: ['1 Frango Cru'], effect: '+65% energia'},
                {name: 'Peixe', emoji: '🐟', ingredients: ['1 Peixe'], effect: '+80% energia'},
                {name: 'Pão', emoji: '🍞', ingredients: ['1 Ovo', '1 Leite', '1 Farinha'], effect: 'Venda na Quitanda'}
            ];
            
            ovenItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'food-item';
                div.innerHTML = `${item.emoji}<br>${item.name}<br><small>${item.ingredients.join(', ')}</small><br><small>${item.effect}</small>`;
                div.onclick = () => cookOven(item.name.toLowerCase());
                ovenRecipes.appendChild(div);
            });
            
            modal.style.display = 'flex';
        }

        function closeStoveMenu() {
            document.getElementById('stoveModal').style.display = 'none';
        }

        function cookStove(recipe) {
            if (gameState.machines.stove.working) {
                alert('O fogão está ocupado!');
                return;
            }

            if (gameState.barn.wood < 2) {
                alert('Você precisa de 2 lenhas para usar o fogão!');
                return;
            }

            let canCook = false;
            let ingredients = '';

            switch(recipe) {
                case 'chá':
                    if (gameState.water >= 1 && gameState.machineStorage.stove.herbs >= 2) {
                        gameState.water--;
                        gameState.machineStorage.stove.herbs -= 2;
                        canCook = true;
                        ingredients = 'Chá';
                    } else {
                        alert('Você precisa de: 1 Água e 2 Ervas (no Fogão)!');
                    }
                    break;
                case 'salada':
                    if (gameState.inventory.fruitsVegetables['Tomate'] >= 1 && 
                        gameState.inventory.fruitsVegetables['Alface'] >= 1 && 
                        gameState.inventory.fruitsVegetables['Brócolis'] >= 1) {
                        gameState.inventory.fruitsVegetables['Tomate']--;
                        gameState.inventory.fruitsVegetables['Alface']--;
                        gameState.inventory.fruitsVegetables['Brócolis']--;
                        canCook = true;
                        ingredients = 'Salada';
                    } else {
                        alert('Você precisa de: 1 Tomate, 1 Alface e 1 Brócolis!');
                    }
                    break;
                case 'ensopado':
                    if (gameState.inventory.others['Ovos'] >= 1 && 
                        gameState.inventory.fruitsVegetables['Batata'] >= 1 && 
                        gameState.inventory.fruitsVegetables['Abóbora'] >= 1) {
                        gameState.inventory.others['Ovos']--;
                        gameState.inventory.fruitsVegetables['Batata']--;
                        gameState.inventory.fruitsVegetables['Abóbora']--;
                        canCook = true;
                        ingredients = 'Ensopado';
                    } else {
                        alert('Você precisa de: 1 Ovo, 1 Batata e 1 Abóbora!');
                    }
                    break;
                case 'bife':
                    if (gameState.machineStorage.stove.porkMeat >= 1) {
                        gameState.machineStorage.stove.porkMeat--;
                        canCook = true;
                        ingredients = 'Bife';
                    } else {
                        alert('Você precisa de: 1 Carne Suína (no Fogão)!');
                    }
                    break;
            }

            if (canCook) {
                gameState.barn.wood -= 2;
                gameState.machines.stove.working = true;
                gameState.machines.stove.startTime = Date.now();
                gameState.machines.stove.type = recipe;

                updateInventoryDisplay();
                updateBarnDisplay();
                updateMachineStatus('stove');
                closeStoveMenu();

                setTimeout(() => {
                    gameState.machines.stove.working = false;
                    gameState.barn[recipe] = (gameState.barn[recipe] || 0) + 1;
                    updateBarnDisplay();
                    updateMachineStatus('stove');
                    alert(`🔥 ${ingredients} pronto!`);
                }, 10000); // 10 seconds
            }
        }

        function cookOven(recipe) {
            if (gameState.machines.stove.working) {
                alert('O forno está ocupado!');
                return;
            }

            if (gameState.barn.wood < 3) {
                alert('Você precisa de 3 lenhas para usar o forno!');
                return;
            }

            let canCook = false;
            let ingredients = '';
            let cookTime = 10000; // Default 10 seconds

            switch(recipe) {
                case 'frango':
                    if (gameState.barn.rawChicken >= 1) {
                        gameState.barn.rawChicken--;
                        canCook = true;
                        ingredients = 'Frango';
                    } else {
                        alert('Você precisa de: 1 Frango Cru!');
                    }
                    break;
                case 'peixe':
                    if (gameState.inventory.others['Peixe'] >= 1) {
                        gameState.inventory.others['Peixe']--;
                        canCook = true;
                        ingredients = 'Peixe Cozido';
                    } else {
                        alert('Você precisa de: 1 Peixe!');
                    }
                    break;
                case 'pão':
                    if (gameState.inventory.others['Ovos'] >= 1 && 
                        gameState.inventory.others['Leite'] >= 1 && 
                        gameState.inventory.others['Saco de Farinha'] >= 1) {
                        gameState.inventory.others['Ovos']--;
                        gameState.inventory.others['Leite']--;
                        gameState.inventory.others['Saco de Farinha']--;
                        canCook = true;
                        ingredients = 'Pão';
                        cookTime = 60000; // 1 minute for bread
                    } else {
                        alert('Você precisa de: 1 Ovo, 1 Leite e 1 Saco de Farinha!');
                    }
                    break;
            }

            if (canCook) {
                gameState.barn.wood -= 3;
                gameState.machines.stove.working = true;
                gameState.machines.stove.startTime = Date.now();
                gameState.machines.stove.type = recipe;

                updateInventoryDisplay();
                updateBarnDisplay();
                updateMachineStatus('stove');
                closeStoveMenu();

                setTimeout(() => {
                    gameState.machines.stove.working = false;
                    
                    if (recipe === 'pão') {
                        // Bread goes to shop inventory
                        addToInventory('others', 'Pão', 1);
                        updateInventoryDisplay();
                    } else if (recipe === 'peixe') {
                        gameState.barn.cookedFish++;
                    } else {
                        gameState.barn[recipe]++;
                    }
                    
                    updateBarnDisplay();
                    updateMachineStatus('stove');
                    alert(`🔥 ${ingredients} pronto!`);
                }, cookTime);
            }
        }

        function drinkTea() {
            if (gameState.avatar.sick && gameState.barn.herbs > 0) {
                gameState.barn.herbs--;
                gameState.avatar.sick = false;
                gameState.avatar.sickTime = 0;
                
                // Stop resting if was resting
                if (gameState.avatar.resting) {
                    gameState.avatar.resting = false;
                    document.getElementById('restBtn').disabled = false;
                    document.getElementById('restBtn').textContent = '😴 Descansar 5min';
                }
                
                updateAvatarUI();
                updateBarnDisplay();
                closeFoodMenu();
                alert('🍵 Você se curou com o chá de ervas!');
            }
        }

        function eatFood(foodType, displayName) {
            if (gameState.barn[foodType] > 0) {
                gameState.barn[foodType]--;
                
                switch(foodType) {
                    case 'chá':
                        if (gameState.avatar.sick) {
                            gameState.avatar.sick = false;
                            gameState.avatar.sickTime = 0;
                            
                            // Stop resting if was resting
                            if (gameState.avatar.resting) {
                                gameState.avatar.resting = false;
                                document.getElementById('restBtn').disabled = false;
                                document.getElementById('restBtn').textContent = '😴 Descansar 5min';
                            }
                            alert(`🍵 Você tomou ${displayName} e se curou!`);
                        } else {
                            alert(`🍵 Você tomou ${displayName}!`);
                        }
                        break;
                    case 'salad':
                        gameState.avatar.energy = Math.min(gameState.avatar.maxEnergy, 
                            gameState.avatar.energy + Math.floor(gameState.avatar.maxEnergy * 0.3));
                        alert(`🥗 Você comeu ${displayName} e recuperou 30% da energia!`);
                        break;
                    case 'stew':
                        gameState.avatar.energy = Math.min(gameState.avatar.maxEnergy, 
                            gameState.avatar.energy + Math.floor(gameState.avatar.maxEnergy * 0.5));
                        alert(`🍲 Você comeu ${displayName} e recuperou 50% da energia!`);
                        break;
                    case 'steak':
                        gameState.avatar.energy = gameState.avatar.maxEnergy;
                        alert(`🥩 Você comeu ${displayName} e recuperou 100% da energia!`);
                        break;
                    case 'chicken':
                        gameState.avatar.energy = Math.min(gameState.avatar.maxEnergy, 
                            gameState.avatar.energy + Math.floor(gameState.avatar.maxEnergy * 0.65));
                        alert(`🍗 Você comeu ${displayName} e recuperou 65% da energia!`);
                        break;
                    case 'cookedFish':
                        gameState.avatar.energy = Math.min(gameState.avatar.maxEnergy, 
                            gameState.avatar.energy + Math.floor(gameState.avatar.maxEnergy * 0.8));
                        alert(`🐟 Você comeu ${displayName} e recuperou 80% da energia!`);
                        break;
                }
                
                updateAvatarUI();
                updateBarnDisplay();
                closeFoodMenu();
            }
        }

        function openMailbox() {
            const modal = document.getElementById('mailboxModal');
            const content = document.getElementById('mailContent');
            
            content.innerHTML = '';
            
            if (gameState.mailbox.mails.length === 0) {
                content.innerHTML = '<p>📭 Nenhuma correspondência no momento.</p>';
            } else {
                gameState.mailbox.mails.forEach((mail, index) => {
                    const mailDiv = document.createElement('div');
                    mailDiv.className = 'mail-item';
                    mailDiv.innerHTML = `
                        <div class="mail-header">${mail.subject}</div>
                        <div>${mail.content}</div>
                        <small>Recebido: ${new Date(mail.timestamp).toLocaleString()}</small>
                    `;
                    content.appendChild(mailDiv);
                });
            }
            
            gameState.mailbox.hasNewMail = false;
            document.getElementById('mailAlert').style.display = 'none';
            modal.style.display = 'flex';
        }

        function closeMailbox() {
            document.getElementById('mailboxModal').style.display = 'none';
        }

        function updateBeehiveDisplay() {
            const grid = document.getElementById('beesGrid');
            grid.innerHTML = '';
            
            const now = Date.now();
            const timeSinceHarvest = now - gameState.beehive.lastHarvest;
            const canHarvest = timeSinceHarvest >= 300000; // 5 minutes
            
            for (let i = 0; i < 3; i++) {
                const slot = document.createElement('div');
                slot.className = 'bee-slot';
                
                if (canHarvest) {
                    slot.classList.add('ready');
                    slot.innerHTML = '🍯';
                    slot.onclick = () => harvestHoney();
                } else {
                    slot.innerHTML = '🐝';
                }
                
                grid.appendChild(slot);
            }
            
            // Update timer
            if (!canHarvest) {
                const remaining = 300 - Math.floor(timeSinceHarvest / 1000);
                const minutes = Math.floor(remaining / 60);
                const seconds = remaining % 60;
                document.getElementById('honeyTimer').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
            } else {
                document.getElementById('honeyTimer').textContent = 'Pronto para coleta!';
            }
        }

        function harvestHoney() {
            const now = Date.now();
            if (now - gameState.beehive.lastHarvest >= 300000) {
                gameState.beehive.lastHarvest = now;
                addToInventory('fruitsVegetables', 'Mel', 3);
                updateBeehiveDisplay();
                updateInventoryDisplay();
                useEnergy(1);
                alert('🍯 Você coletou 3 potes de mel!');
            }
        }

        function updateAvatarUI() {
            const energyPercent = (gameState.avatar.energy / gameState.avatar.maxEnergy) * 100;
            document.getElementById('energyFill').style.width = energyPercent + '%';
            document.getElementById('energy').textContent = gameState.avatar.energy;
            
            const avatar = document.getElementById('avatar');
            const avatarEmoji = document.getElementById('avatarEmoji');
            
            if (gameState.avatar.sick) {
                avatar.classList.add('sick');
                avatarEmoji.textContent = '🤒';
            } else {
                avatar.classList.remove('sick');
                avatarEmoji.textContent = '👨‍🌾';
            }
            
            // Energy warnings
            if (gameState.avatar.energy <= 20 && !gameState.avatar.sick) {
                if (!document.getElementById('energyWarning')) {
                    alert('⚠️ Sua energia está baixa! Descanse ou coma algo!');
                    const warning = document.createElement('div');
                    warning.id = 'energyWarning';
                    warning.style.display = 'none';
                    document.body.appendChild(warning);
                }
            }
            
            if (gameState.avatar.sick && !document.getElementById('sickWarning')) {
                alert('🤒 Você está doente! Tome chá de ervas para se curar!');
                const warning = document.createElement('div');
                warning.id = 'sickWarning';
                warning.style.display = 'none';
                document.body.appendChild(warning);
            }
        }

        function useEnergy(amount) {
            if (gameState.avatar.resting) return;
            
            gameState.avatar.energy = Math.max(0, gameState.avatar.energy - amount);
            updateAvatarUI();
            
            if (gameState.avatar.energy === 0) {
                alert('💀 Você morreu de exaustão! O jogo será reiniciado.');
                localStorage.removeItem('realFarmSave');
                location.reload();
            }
        }

        function checkAvatarSickness() {
            const now = Date.now();
            
            // First sickness after 15 minutes
            if (!gameState.avatar.sick && now >= gameState.avatar.firstSickness) {
                gameState.avatar.sick = true;
                gameState.avatar.sickTime = now;
                gameState.avatar.firstSickness = 0; // Mark as triggered
                updateAvatarUI();
                
                // Schedule next random sickness (30 minutes to 2 hours)
                setTimeout(() => {
                    if (!gameState.avatar.sick) {
                        gameState.avatar.sick = true;
                        gameState.avatar.sickTime = Date.now();
                        updateAvatarUI();
                    }
                }, Math.random() * 5400000 + 1800000); // 30min to 2h
            }
            
            // Lose energy while sick
            if (gameState.avatar.sick) {
                useEnergy(1);
            }
        }

        function sendRandomMail() {
            const motivationalMessages = [
                "Continue assim, fazendeiro! Sua dedicação está dando frutos! 🌱",
                "O trabalho duro sempre compensa. Sua fazenda está florescendo! 🌻",
                "Cada semente plantada é um passo em direção ao sucesso! 🌾",
                "Você está fazendo um trabalho incrível! A comunidade está orgulhosa! 👏",
                "Lembre-se: grandes fazendeiros começaram pequenos. Continue crescendo! 🚜"
            ];
            
            const message = motivationalMessages[Math.floor(Math.random() * motivationalMessages.length)];
            
            gameState.mailbox.mails.push({
                subject: "💌 Mensagem Motivacional",
                content: message,
                timestamp: Date.now()
            });
            
            gameState.mailbox.hasNewMail = true;
            document.getElementById('mailAlert').style.display = 'flex';
        }

        function sendNewspaper() {
            const now = Date.now();
            if (now - gameState.mailbox.lastNewspaper >= 1800000) { // 30 minutes
                const crops = ['Trigo', 'Milho', 'Tomate', 'Batata', 'Cenoura'];
                const randomCrop = crops[Math.floor(Math.random() * crops.length)];
                const bonus = Math.floor(Math.random() * 20) + 10; // 10-30% bonus
                
                const newspaper = `📰 JORNAL DOS AGRICULTORES
                
Produto em alta hoje: ${randomCrop}
Bônus de venda: +${bonus}%

Dica do dia: Mantenha seus animais bem alimentados para maior produtividade!

Previsão do tempo: ${Math.random() > 0.5 ? 'Ensolarado ☀️' : 'Possibilidade de chuva 🌧️'}`;
                
                gameState.mailbox.mails.push({
                    subject: "📰 Jornal dos Agricultores",
                    content: newspaper,
                    timestamp: now
                });
                
                gameState.mailbox.lastNewspaper = now;
                gameState.mailbox.hasNewMail = true;
                document.getElementById('mailAlert').style.display = 'flex';
            }
        }

        function sellAll() {
            let totalEarnings = 0;
            let springBonus = gameState.season === 0 ? 1.1 : 1; // 10% bonus na primavera
            let itemsSold = 0;
            
            // Item prices for non-seed items
            const itemPrices = {
                'CD': 50,
                'Bola': 40,
                'Sapato': 35,
                'Pote de Mel': 60,
                'Pérola': 100,
                'Esmeralda': 200,
                'Rubi': 180,
                'Safira': 160,
                'Flor': 25,
                'Rosa': 30,
                'Girassol': 35,
                'Margarida': 25,
                'Grama': 5,
                'Maçã': 15,
                'Laranja': 18,
                'Banana': 12,
                'Peixe': 25,
                'Lenha': 8,
                'Ovos': 20,
                'Carne Suína': 45,
                'Leite': 25,
                'Esterco': 15,
                'Lã': 30,
                'Saco de Café': 120,
                'Suco de Uva': 80,
                'Saco de Farinha': 100,
                'Queijo': 90,
                'Novelo': 70,
                'Pão': 50,
                'Colar de Pérolas': 400,
                'Anel de Esmeralda': 350,
                'Buquê de Flores': 200
            };
            
            Object.keys(gameState.inventory).forEach(category => {
                Object.keys(gameState.inventory[category]).forEach(item => {
                    const quantity = gameState.inventory[category][item];
                    if (quantity > 0) {
                        let price = 0;
                        const seed = seeds.find(s => s.name === item);
                        
                        if (seed) {
                            price = seed.price * 2; // Sell for double the buy price
                        } else {
                            price = itemPrices[item] || 10;
                        }
                        
                        totalEarnings += Math.floor(quantity * price * springBonus);
                        itemsSold += quantity;
                        gameState.inventory[category][item] = 0;
                    }
                });
            });
            
            gameState.coins += totalEarnings;
            updateUI();
            updateInventoryDisplay();
            
            if (totalEarnings > 0) {
                let message = `💰 Vendeu ${itemsSold} itens por ${totalEarnings} moedas!`;
                if (springBonus > 1) message += ' (Bônus da Primavera: +10%)';
                
                // Show success message
                const alertDiv = document.createElement('div');
                alertDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #4CAF50;
                    color: white;
                    padding: 20px 30px;
                    border-radius: 15px;
                    z-index: 3000;
                    font-weight: bold;
                    font-size: 18px;
                    text-align: center;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                `;
                alertDiv.textContent = message;
                document.body.appendChild(alertDiv);
                
                setTimeout(() => {
                    document.body.removeChild(alertDiv);
                }, 3000);
            } else {
                alert('📦 Não há itens para vender na quitanda!');
            }
        }

        function feedDog() {
            const now = Date.now();
            if (gameState.hasDogHouse && gameState.barn.dogFood > 0 && 
                (now - gameState.dogLastFed) >= 300000) { // 5 minutos
                gameState.barn.dogFood--;
                gameState.dogLastFed = now;
                
                // Start treasure hunting after feeding
                if (gameState.dogFriendship >= 100) {
                    setTimeout(findTreasure, 180000); // 3 minutos
                }
                
                updatePetUI();
                updateBarnDisplay();
                updateUI();
            }
        }

        function giveBone() {
            const now = Date.now();
            if (gameState.hasDogHouse && gameState.barn.bones > 0 && 
                (now - gameState.dogLastFed) >= 1200000) { // 20 minutos
                gameState.barn.bones--;
                gameState.dogFriendship = Math.min(100, gameState.dogFriendship + 10);
                
                updatePetUI();
                updateBarnDisplay();
                updateUI();
            }
        }

        function feedHorse() {
            const now = Date.now();
            if (gameState.hasHorseStable && gameState.barn.hay >= 2 && 
                (now - gameState.horseLastFed) >= 300000) { // 5 minutos
                gameState.barn.hay -= 2;
                gameState.horseLastFed = now;
                gameState.horseFriendship = Math.min(100, gameState.horseFriendship + 5);
                
                // Enable orders panel when friendship reaches 100%
                if (gameState.horseFriendship >= 100) {
                    document.getElementById('ordersPanel').style.display = 'block';
                    generateOrders();
                }
                
                updatePetUI();
                updateBarnDisplay();
                updateUI();
            }
        }

        function giveApple() {
            if (gameState.hasHorseStable && gameState.inventory.fruitsVegetables['Maçã'] > 0) {
                gameState.inventory.fruitsVegetables['Maçã']--;
                gameState.horseFriendship = Math.min(100, gameState.horseFriendship + 15);
                
                updatePetUI();
                updateInventoryDisplay();
                updateUI();
            }
        }

        function findTreasure() {
            const treasures = ['💿', '⚽', '👟'];
            const randomTreasure = treasures[Math.floor(Math.random() * treasures.length)];
            const treasureNames = {
                '💿': 'CD',
                '⚽': 'Bola', 
                '👟': 'Sapato'
            };
            
            // Higher chance for key if friendship with bone
            const keyChance = gameState.dogFriendship >= 100 ? 0.3 : 0.1;
            
            if (Math.random() < keyChance) {
                gameState.barn.keys++;
                alert('🗝️ Mocinha encontrou uma Chave!');
                updateBarnDisplay();
            } else {
                const treasureName = treasureNames[randomTreasure];
                if (!gameState.inventory.others[treasureName]) {
                    gameState.inventory.others[treasureName] = 0;
                }
                gameState.inventory.others[treasureName]++;
                alert(`${randomTreasure} Mocinha encontrou: ${treasureName}!`);
                updateInventoryDisplay();
            }
        }

        function sellItem(category, item) {
            if (gameState.inventory[category][item] > 0) {
                let price = 0;
                let springBonus = gameState.season === 0 ? 1.1 : 1;
                
                // Find seed price
                const seed = seeds.find(s => s.name === item);
                if (seed) {
                    price = seed.price * 2; // Sell for double the buy price
                } else {
                    // Prices for non-seed items
                    const itemPrices = {
                        'CD': 50,
                        'Bola': 40,
                        'Sapato': 35,
                        'Pote de Mel': 60,
                        'Pérola': 100,
                        'Esmeralda': 200,
                        'Rubi': 180,
                        'Safira': 160,
                        'Flor': 25,
                        'Rosa': 30,
                        'Girassol': 35,
                        'Margarida': 25,
                        'Grama': 5,
                        'Maçã': 15,
                        'Laranja': 18,
                        'Banana': 12,
                        'Peixe': 25,
                        'Lenha': 8,
                        'Ovos': 20,
                        'Carne Suína': 45,
                        'Leite': 25,
                        'Esterco': 15,
                        'Lã': 30,
                        'Saco de Café': 120,
                        'Suco de Uva': 80,
                        'Saco de Farinha': 100,
                        'Queijo': 90,
                        'Novelo': 70,
                        'Pão': 50
                    };
                    price = itemPrices[item] || 10;
                }
                
                const finalPrice = Math.floor(price * springBonus);
                gameState.coins += finalPrice;
                gameState.inventory[category][item]--;
                
                updateUI();
                updateInventoryDisplay();
                
                let message = `💰 Vendeu ${item} por ${finalPrice} moedas!`;
                if (springBonus > 1) message += ' (Bônus Primavera: +10%)';
                
                // Show brief alert
                const alertDiv = document.createElement('div');
                alertDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #4CAF50;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 10px;
                    z-index: 3000;
                    font-weight: bold;
                `;
                alertDiv.textContent = message;
                document.body.appendChild(alertDiv);
                
                setTimeout(() => {
                    document.body.removeChild(alertDiv);
                }, 2000);
            }
        }

        function generateOrders() {
            if (gameState.orders.length < 3) {
                const orderTypes = [
                    {item: 'Trigo', quantity: 5, reward: 100, emoji: '🌾'},
                    {item: 'Milho', quantity: 3, reward: 80, emoji: '🌽'},
                    {item: 'Tomate', quantity: 4, reward: 90, emoji: '🍅'},
                    {item: 'Batata', quantity: 6, reward: 120, emoji: '🥔'},
                    {item: 'Cenoura', quantity: 4, reward: 85, emoji: '🥕'}
                ];
                
                while (gameState.orders.length < 3) {
                    const randomOrder = orderTypes[Math.floor(Math.random() * orderTypes.length)];
                    gameState.orders.push({
                        id: Date.now() + Math.random(),
                        ...randomOrder,
                        client: `Cliente ${Math.floor(Math.random() * 100) + 1}`
                    });
                }
                updateOrdersDisplay();
            }
        }

        function acceptOrder(orderId) {
            const order = gameState.orders.find(o => o.id === orderId);
            if (order) {
                const seed = seeds.find(s => s.name === order.item);
                const category = seed.category;
                
                if (gameState.inventory[category][order.item] >= order.quantity) {
                    gameState.inventory[category][order.item] -= order.quantity;
                    gameState.coins += order.reward;
                    gameState.orders = gameState.orders.filter(o => o.id !== orderId);
                    
                    // Horse delivery time
                    setTimeout(() => {
                        alert(`🐎 Duque entregou o pedido! +${order.reward} moedas!`);
                        generateOrders(); // Generate new order
                    }, 60000); // 1 minuto
                    
                    updateInventoryDisplay();
                    updateOrdersDisplay();
                    updateUI();
                } else {
                    alert(`Você precisa de ${order.quantity}x ${order.item} para este pedido!`);
                }
            }
        }

        function rejectOrder(orderId) {
            gameState.orders = gameState.orders.filter(o => o.id !== orderId);
            updateOrdersDisplay();
            generateOrders();
        }

        function updateOrdersDisplay() {
            const ordersList = document.getElementById('ordersList');
            ordersList.innerHTML = '';
            
            gameState.orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = 'order-item';
                orderDiv.innerHTML = `
                    <div>
                        <strong>${order.client}</strong><br>
                        ${order.emoji} ${order.quantity}x ${order.item}<br>
                        💰 ${order.reward} moedas
                    </div>
                    <div class="order-buttons">
                        <button class="accept-btn" onclick="acceptOrder(${order.id})">✅</button>
                        <button class="reject-btn" onclick="rejectOrder(${order.id})">❌</button>
                    </div>
                `;
                ordersList.appendChild(orderDiv);
            });
        }

        function updateInventoryDisplay() {
            const categories = ['farmProducts', 'fruitsVegetables', 'others'];
            const containers = ['farmProducts', 'fruitsVegetables', 'others'];
            
            // Item prices for display
            const itemPrices = {
                'CD': 50,
                'Bola': 40,
                'Sapato': 35,
                'Pote de Mel': 60,
                'Pérola': 100,
                'Esmeralda': 200,
                'Rubi': 180,
                'Safira': 160,
                'Flor': 25,
                'Rosa': 30,
                'Girassol': 35,
                'Margarida': 25,
                'Grama': 5,
                'Maçã': 15,
                'Laranja': 18,
                'Banana': 12,
                'Peixe': 25,
                'Lenha': 8,
                'Ovos': 20,
                'Carne Suína': 45,
                'Leite': 25,
                'Esterco': 15,
                'Lã': 30,
                'Saco de Café': 120,
                'Suco de Uva': 80,
                'Saco de Farinha': 100,
                'Queijo': 90,
                'Novelo': 70,
                'Pão': 50,
                'Colar de Pérolas': 400,
                'Anel de Esmeralda': 350,
                'Buquê de Flores': 200
            };
            
            categories.forEach((category, index) => {
                const container = document.getElementById(containers[index]);
                container.innerHTML = '';
                
                Object.keys(gameState.inventory[category]).forEach(item => {
                    const quantity = gameState.inventory[category][item];
                    if (quantity > 0) {
                        const seed = seeds.find(s => s.name === item);
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'inventory-item';
                        itemDiv.style.cursor = 'pointer';
                        itemDiv.title = 'Clique para vender';
                        
                        let emoji = seed ? seed.emoji : '';
                        let price = 0;
                        
                        // Set emoji for special items
                        const specialEmojis = {
                            'CD': '💿',
                            'Bola': '⚽',
                            'Sapato': '👟',
                            'Pote de Mel': '🍯',
                            'Pérola': '💎',
                            'Esmeralda': '💚',
                            'Rubi': '❤️',
                            'Safira': '💙',
                            'Flor': '🌸',
                            'Rosa': '🌹',
                            'Girassol': '🌻',
                            'Margarida': '🌼',
                            'Grama': '🌱',
                            'Maçã': '🍎',
                            'Laranja': '🍊',
                            'Banana': '🍌',
                            'Peixe': '🐟',
                            'Lenha': '🪵',
                            'Ovos': '🥚',
                            'Carne Suína': '🥩',
                            'Leite': '🥛',
                            'Esterco': '💩',
                            'Lã': '🐑',
                            'Saco de Café': '☕',
                            'Suco de Uva': '🧃',
                            'Saco de Farinha': '🌾',
                            'Queijo': '🧀',
                            'Novelo': '🧶',
                            'Pão': '🍞',
                            'Colar de Pérolas': '📿',
                            'Anel de Esmeralda': '💍',
                            'Buquê de Flores': '💐'
                        };
                        
                        if (specialEmojis[item]) {
                            emoji = specialEmojis[item];
                        }
                        
                        // Calculate price
                        if (seed) {
                            price = seed.price * 2;
                        } else {
                            price = itemPrices[item] || 10;
                        }
                        
                        let springBonus = gameState.season === 0 ? 1.1 : 1;
                        let finalPrice = Math.floor(price * springBonus);
                        
                        itemDiv.innerHTML = `
                            <div style="display: flex; flex-direction: column; align-items: flex-start;">
                                <span>${emoji} ${item}</span>
                                <small style="color: #666;">💰 ${finalPrice} cada</small>
                            </div>
                            <span style="font-weight: bold;">${quantity}x</span>
                        `;
                        itemDiv.onclick = () => sellItem(category, item);
                        container.appendChild(itemDiv);
                    }
                });
            });
        }

        // Machine Functions
        function startComposting() {
            if (gameState.machines.composter.working) return;
            
            if (gameState.machineStorage.composter.flowers >= 1 && 
                gameState.machineStorage.composter.branches >= 1 && 
                gameState.machineStorage.composter.manure >= 2) {
                
                gameState.machineStorage.composter.flowers--;
                gameState.machineStorage.composter.branches--;
                gameState.machineStorage.composter.manure -= 2;
                
                gameState.machines.composter.working = true;
                gameState.machines.composter.startTime = Date.now();
                
                updateMachineStorageDisplay();
                updateMachineStatus('composter');
                
                setTimeout(() => {
                    gameState.machines.composter.working = false;
                    gameState.fertilizer += 8;
                    updateUI();
                    updateMachineStatus('composter');
                    alert('🗑️ Compostagem concluída! +8 Adubos!');
                }, 60000); // 1 minute
            } else {
                alert('Você precisa de: 1 Flor, 1 Galho e 2 Estercos (na Composteira)!');
            }
        }

        function makeChickenFeed() {
            if (gameState.machines.mixer.working) return;
            
            if (gameState.inventory.farmProducts['Trigo'] >= 1 && 
                gameState.inventory.farmProducts['Milho'] >= 2) {
                
                gameState.inventory.farmProducts['Trigo']--;
                gameState.inventory.farmProducts['Milho'] -= 2;
                
                gameState.machines.mixer.working = true;
                gameState.machines.mixer.startTime = Date.now();
                gameState.machines.mixer.type = 'chicken';
                
                updateInventoryDisplay();
                updateMachineStatus('mixer');
                
                setTimeout(() => {
                    gameState.machines.mixer.working = false;
                    gameState.barn.chickenFeed++;
                    updateBarnDisplay();
                    updateMachineStatus('mixer');
                    alert('🐔 Ração para galinhas pronta!');
                }, 10000); // 10 seconds
            } else {
                alert('Você precisa de: 1 Trigo e 2 Milhos!');
            }
        }

        function makePigFeed() {
            if (gameState.machines.mixer.working) return;
            
            if (gameState.inventory.farmProducts['Milho'] >= 1 && 
                gameState.inventory.fruitsVegetables['Batata'] >= 1 &&
                gameState.inventory.fruitsVegetables['Cenoura'] >= 1 &&
                gameState.inventory.fruitsVegetables['Brócolis'] >= 1) {
                
                gameState.inventory.farmProducts['Milho']--;
                gameState.inventory.fruitsVegetables['Batata']--;
                gameState.inventory.fruitsVegetables['Cenoura']--;
                gameState.inventory.fruitsVegetables['Brócolis']--;
                
                gameState.machines.mixer.working = true;
                gameState.machines.mixer.startTime = Date.now();
                gameState.machines.mixer.type = 'pig';
                
                updateInventoryDisplay();
                updateMachineStatus('mixer');
                
                setTimeout(() => {
                    gameState.machines.mixer.working = false;
                    gameState.barn.pigFeed++;
                    updateBarnDisplay();
                    updateMachineStatus('mixer');
                    alert('🐷 Ração para porcos pronta!');
                }, 15000); // 15 seconds
            } else {
                alert('Você precisa de: 1 Milho, 1 Batata, 1 Cenoura e 1 Brócolis!');
            }
        }

        function roastCoffee() {
            if (gameState.machines.coffeeRoaster.working) return;
            
            if (gameState.machineStorage.coffeeRoaster.coffee >= 4 && 
                gameState.barn.wood >= 3) {
                
                gameState.machineStorage.coffeeRoaster.coffee -= 4;
                gameState.barn.wood -= 3;
                
                gameState.machines.coffeeRoaster.working = true;
                gameState.machines.coffeeRoaster.startTime = Date.now();
                
                updateBarnDisplay();
                updateMachineStatus('coffeeRoaster');
                
                setTimeout(() => {
                    gameState.machines.coffeeRoaster.working = false;
                    addToInventory('others', 'Saco de Café', 1);
                    updateInventoryDisplay();
                    updateMachineStatus('coffeeRoaster');
                    alert('☕ Saco de Café pronto!');
                }, 30000); // 30 seconds
            } else {
                alert('Você precisa de: 4 Cafés (na Torra) e 3 Lenhas!');
            }
        }

        function makeJuice() {
            if (gameState.machines.juiceMachine.working) return;
            
            if (gameState.machineStorage.juiceMachine.grapes >= 2) {
                gameState.machineStorage.juiceMachine.grapes -= 2;
                
                gameState.machines.juiceMachine.working = true;
                gameState.machines.juiceMachine.startTime = Date.now();
                
                updateMachineStatus('juiceMachine');
                
                setTimeout(() => {
                    gameState.machines.juiceMachine.working = false;
                    addToInventory('others', 'Suco de Uva', 1);
                    updateInventoryDisplay();
                    updateMachineStatus('juiceMachine');
                    alert('🧃 Suco de Uva pronto!');
                }, 10000); // 10 seconds
            } else {
                alert('Você precisa de: 2 Uvas (na Máquina de Suco)!');
            }
        }

        function makeFlour() {
            if (gameState.machines.mill.working) return;
            
            if (gameState.machineStorage.mill.wheat >= 4) {
                gameState.machineStorage.mill.wheat -= 4;
                
                gameState.machines.mill.working = true;
                gameState.machines.mill.startTime = Date.now();
                
                updateMachineStatus('mill');
                
                setTimeout(() => {
                    gameState.machines.mill.working = false;
                    addToInventory('others', 'Saco de Farinha', 1);
                    updateInventoryDisplay();
                    updateMachineStatus('mill');
                    alert('🌾 Saco de Farinha pronto!');
                }, 60000); // 1 minute
            } else {
                alert('Você precisa de: 4 Trigos (no Moinho)!');
            }
        }

        function makeCheese() {
            if (gameState.machines.cheeseMaker.working) return;
            
            if (gameState.inventory.others['Leite'] >= 2) {
                gameState.inventory.others['Leite'] -= 2;
                
                gameState.machines.cheeseMaker.working = true;
                gameState.machines.cheeseMaker.startTime = Date.now();
                
                updateInventoryDisplay();
                updateMachineStatus('cheeseMaker');
                
                setTimeout(() => {
                    gameState.machines.cheeseMaker.working = false;
                    addToInventory('others', 'Queijo', 1);
                    updateInventoryDisplay();
                    updateMachineStatus('cheeseMaker');
                    alert('🧀 Queijo pronto!');
                }, 60000); // 1 minute
            } else {
                alert('Você precisa de: 2 Leites!');
            }
        }

        function spinWool() {
            if (gameState.machines.spinningMachine.working) return;
            
            if (gameState.machineStorage.spinningMachine.wool >= 2) {
                gameState.machineStorage.spinningMachine.wool -= 2;
                
                gameState.machines.spinningMachine.working = true;
                gameState.machines.spinningMachine.startTime = Date.now();
                
                updateMachineStatus('spinningMachine');
                
                setTimeout(() => {
                    gameState.machines.spinningMachine.working = false;
                    addToInventory('others', 'Novelo', 1);
                    updateInventoryDisplay();
                    updateMachineStatus('spinningMachine');
                    alert('🧶 Novelo pronto!');
                }, 60000); // 1 minute
            } else {
                alert('Você precisa de: 2 Lãs (na Máquina de Fiar)!');
            }
        }

        function dryGrass() {
            if (gameState.machines.grassDryer.working) return;
            
            const grassAmount = Math.floor(Math.random() * 5) + 4; // 4-8 gramas
            if (gameState.machineStorage.grassDryer.grass >= grassAmount) {
                gameState.machineStorage.grassDryer.grass -= grassAmount;
                
                gameState.machines.grassDryer.working = true;
                gameState.machines.grassDryer.startTime = Date.now();
                
                updateMachineStatus('grassDryer');
                
                setTimeout(() => {
                    gameState.machines.grassDryer.working = false;
                    gameState.machineStorage.grassDryer.driedGrass += grassAmount;
                    updateMachineStatus('grassDryer');
                    alert(`🌾 ${grassAmount} gramas secas prontas!`);
                }, 30000); // 30 seconds
            } else {
                alert('Você precisa de pelo menos 4 Gramas (no Secador)!');
            }
        }

        function makeHayFromGrass() {
            if (gameState.machineStorage.grassDryer.driedGrass >= 4) {
                gameState.machineStorage.grassDryer.driedGrass -= 4;
                
                setTimeout(() => {
                    gameState.barn.hay++;
                    updateBarnDisplay();
                    alert('🌾 Feno pronto!');
                }, 10000); // 10 seconds
                
                updateMachineStatus('grassDryer');
            } else {
                alert('Você precisa de: 4 Gramas Secas (no Secador)!');
            }
        }

        function cutWoodMachine() {
            if (gameState.machines.woodCutter.working) return;
            
            if (gameState.machineStorage.woodCutter.trunks >= 1) {
                gameState.machineStorage.woodCutter.trunks--;
                
                gameState.machines.woodCutter.working = true;
                gameState.machines.woodCutter.startTime = Date.now();
                
                updateMachineStatus('woodCutter');
                
                setTimeout(() => {
                    gameState.machines.woodCutter.working = false;
                    gameState.barn.wood += 4;
                    updateBarnDisplay();
                    updateMachineStatus('woodCutter');
                    alert('🪓 4 Lenhas prontas!');
                }, 5000); // 5 seconds
            } else {
                alert('Você precisa de: 1 Tronco (no Cortador)!');
            }
        }

        function updateMachineStatus(machineType) {
            const machine = gameState.machines[machineType];
            const statusElement = document.getElementById(machineType + 'Status');
            const btnElement = document.getElementById(machineType + 'Btn');
            
            if (machine.working) {
                const elapsed = Date.now() - machine.startTime;
                let duration;
                
                switch(machineType) {
                    case 'composter': duration = 60000; break;
                    case 'mixer': duration = machine.type === 'chicken' ? 10000 : 15000; break;
                    case 'coffeeRoaster': duration = 30000; break;
                    case 'juiceMachine': duration = 10000; break;
                    case 'mill': duration = 60000; break;
                    case 'cheeseMaker': duration = 60000; break;
                    case 'spinningMachine': duration = 60000; break;
                    case 'grassDryer': duration = 30000; break;
                    case 'woodCutter': duration = 5000; break;
                    case 'stove': duration = machine.type === 'pão' ? 60000 : 10000; break;
                }
                
                const remaining = Math.max(0, duration - elapsed);
                const seconds = Math.ceil(remaining / 1000);
                
                statusElement.textContent = `Trabalhando... ${seconds}s`;
                statusElement.className = 'machine-status working';
                if (btnElement) btnElement.disabled = true;
            } else {
                statusElement.textContent = 'Pronto para usar';
                statusElement.className = 'machine-status';
                if (btnElement) btnElement.disabled = false;
            }
        }

        function updateBarnDisplay() {
            const barnItems = document.getElementById('barnItems');
            barnItems.innerHTML = '';
            
            const barnContents = [
                {name: 'Ossos', emoji: '🦴', quantity: gameState.barn.bones},
                {name: 'Chaves', emoji: '🗝️', quantity: gameState.barn.keys},
                {name: 'Feno', emoji: '🌾', quantity: gameState.barn.hay},
                {name: 'Carvão', emoji: '⚫', quantity: gameState.barn.coal},
                {name: 'Chá', emoji: '🍵', quantity: gameState.barn.tea},
                {name: 'Lenha', emoji: '🪵', quantity: gameState.barn.wood},
                {name: 'Ração Cachorro', emoji: '🥩', quantity: gameState.barn.dogFood},
                {name: 'Vacinas', emoji: '💉', quantity: gameState.barn.vaccines}
            ];
            
            barnContents.forEach(item => {
                if (item.quantity > 0) {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'inventory-item';
                    itemDiv.innerHTML = `
                        <span>${item.emoji} ${item.name}</span>
                        <span>${item.quantity}x</span>
                    `;
                    barnItems.appendChild(itemDiv);
                }
            });
            
            // Update mine access
            if (gameState.barn.keys > 0 && !gameState.mineAccess) {
                gameState.mineAccess = true;
                document.getElementById('mineAccess').innerHTML = '🔓 Mina liberada! Use uma chave para 9 batidas nas rochas.';
                document.getElementById('mineAccess').style.color = '#228B22';
            }
        }

        function updateGrassDisplay() {
            const grid = document.getElementById('grassGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 20; i++) {
                const slot = document.createElement('div');
                slot.className = 'grass-slot';
                
                if (gameState.grass[i]) {
                    slot.innerHTML = '🌱';
                    slot.onclick = () => harvestGrass(i);
                } else {
                    slot.classList.add('empty');
                    slot.innerHTML = '';
                }
                
                grid.appendChild(slot);
            }
        }

        function updateTreesDisplay() {
            const grid = document.getElementById('treesGrid');
            grid.innerHTML = '';
            
            const trees = [
                {type: 'trunk', emoji: '🌳', name: 'Troncos'},
                {type: 'apple', emoji: '🍎', name: 'Maçãs'},
                {type: 'orange', emoji: '🍊', name: 'Laranjas'},
                {type: 'banana', emoji: '🍌', name: 'Bananas'}
            ];
            
            trees.forEach(tree => {
                const slot = document.createElement('div');
                slot.className = 'tree-slot';
                slot.innerHTML = tree.emoji;
                
                if (tree.type === 'trunk') {
                    const count = document.createElement('div');
                    count.className = 'tree-count';
                    count.textContent = `${gameState.trees.trunk.clicks} cliques`;
                    slot.appendChild(count);
                    slot.onclick = () => harvestTrunk();
                } else {
                    const count = document.createElement('div');
                    count.className = 'tree-count';
                    count.textContent = `${gameState.trees[tree.type].fruits}/4`;
                    slot.appendChild(count);
                    slot.onclick = () => harvestFruit(tree.type);
                }
                
                grid.appendChild(slot);
            });
        }

        function updateFishDisplay() {
            const grid = document.getElementById('fishGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const slot = document.createElement('div');
                slot.className = 'fish-slot';
                
                if (gameState.fish[i]) {
                    slot.innerHTML = '🐟';
                    slot.onclick = () => catchFish(i);
                } else {
                    slot.classList.add('empty');
                    slot.innerHTML = '';
                }
                
                grid.appendChild(slot);
            }
        }

        function updateRocksDisplay() {
            const grid = document.getElementById('rocksGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 3; i++) {
                const slot = document.createElement('div');
                slot.className = 'rock-slot';
                
                if (gameState.rocks[i].resting) {
                    slot.classList.add('resting');
                    slot.innerHTML = '💤';
                } else {
                    slot.innerHTML = '🪨';
                    const hits = document.createElement('div');
                    hits.className = 'rock-hits';
                    hits.textContent = `${gameState.rocks[i].hits}/3`;
                    slot.appendChild(hits);
                }
                
                slot.onclick = () => mineRock(i);
                grid.appendChild(slot);
            }
        }

        function updateAxeStatus() {
            document.getElementById('axeUses').textContent = gameState.axeUses;
            if (gameState.axeUses <= 0) {
                document.getElementById('axeStatus').classList.add('broken');
                document.getElementById('axeStatus').innerHTML = '🪓 Machado quebrado! Compre outro no mercadinho.';

                document.getElementById('axeOnlyShop').style.display = 'block';
                gameState.hasAxe = false;
            }
        }

        function updateFishingRodStatus() {
            document.getElementById('rodUses').textContent = gameState.fishingRodUses;
            if (gameState.fishingRodUses <= 0) {
                document.getElementById('fishingRodStatus').classList.add('broken');
                document.getElementById('fishingRodStatus').innerHTML = '🎣 Vara quebrada! Compre outra no mercadinho.';
                gameState.hasFishingRod = false;
            }
        }

        function updatePickaxeStatus() {
            document.getElementById('pickaxeUses').textContent = gameState.pickaxeUses;
            if (gameState.pickaxeUses <= 0) {
                document.getElementById('pickaxeStatus').classList.add('broken');
                document.getElementById('pickaxeStatus').innerHTML = '⛏️ Picareta quebrada! Compre outra no mercadinho.';
                gameState.hasPickaxe = false;
            }
        }

        function updateChickensDisplay() {
            const grid = document.getElementById('chickensGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const slot = document.createElement('div');
                slot.className = 'animal-slot';
                
                if (gameState.chickens[i]) {
                    const chicken = gameState.chickens[i];
                    slot.innerHTML = chicken.eating ? '🍽️' : chicken.emoji;
                    
                    if (chicken.sick) slot.classList.add('sick');
                    if (chicken.eating) slot.classList.add('eating');
                    if (chicken.resting) slot.classList.add('resting');
                    
                    slot.onclick = () => handleAnimalClick('chicken', i);
                } else {
                    slot.innerHTML = '';
                }
                
                grid.appendChild(slot);
            }
        }

        function updatePigsDisplay() {
            const grid = document.getElementById('pigsGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const slot = document.createElement('div');
                slot.className = 'animal-slot';
                
                if (gameState.pigs[i]) {
                    const pig = gameState.pigs[i];
                    slot.innerHTML = pig.eating ? '🍽️' : pig.emoji;
                    
                    if (pig.sick) slot.classList.add('sick');
                    if (pig.eating) slot.classList.add('eating');
                    if (pig.resting) slot.classList.add('resting');
                    
                    slot.onclick = () => handleAnimalClick('pig', i);
                } else {
                    slot.innerHTML = '';
                }
                
                grid.appendChild(slot);
            }
        }

        function updateSheepDisplay() {
            const grid = document.getElementById('sheepGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const slot = document.createElement('div');
                slot.className = 'animal-slot';
                
                if (gameState.sheep[i]) {
                    const sheep = gameState.sheep[i];
                    slot.innerHTML = sheep.eating ? '🍽️' : sheep.emoji;
                    
                    if (sheep.sick) slot.classList.add('sick');
                    if (sheep.eating) slot.classList.add('eating');
                    if (sheep.resting) slot.classList.add('resting');
                    
                    slot.onclick = () => handleAnimalClick('sheep', i);
                } else {
                    slot.innerHTML = '';
                }
                
                grid.appendChild(slot);
            }
        }

        function updateCowsDisplay() {
            const grid = document.getElementById('cowsGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const slot = document.createElement('div');
                slot.className = 'animal-slot';
                
                if (gameState.cows[i]) {
                    const cow = gameState.cows[i];
                    slot.innerHTML = cow.eating ? '🍽️' : cow.emoji;
                    
                    if (cow.sick) slot.classList.add('sick');
                    if (cow.eating) slot.classList.add('eating');
                    if (cow.resting) slot.classList.add('resting');
                    
                    slot.onclick = () => handleAnimalClick('cow', i);
                } else {
                    slot.innerHTML = '';
                }
                
                grid.appendChild(slot);
            }
        }

        function updateFlowersDisplay() {
            const grid = document.getElementById('flowersGrid');
            grid.innerHTML = '';
            
            const flowerTypes = [
                {type: 'rosa', emoji: '🌹', name: 'Rosa'},
                {type: 'girassol', emoji: '🌻', name: 'Girassol'},
                {type: 'margarida', emoji: '🌼', name: 'Margarida'}
            ];
            
            flowerTypes.forEach(flower => {
                const slot = document.createElement('div');
                slot.className = 'flower-slot';
                
                if (gameState.flowers[flower.type] > 0) {
                    slot.innerHTML = `${flower.emoji}<br>${gameState.flowers[flower.type]}x`;
                    slot.onclick = () => harvestFlower(flower.type);
                } else {
                    slot.classList.add('empty');
                    slot.innerHTML = '🌱<br>Crescendo...';
                }
                
                grid.appendChild(slot);
            });
        }

        function updateProducerFairDisplay() {
            const grid = document.getElementById('fairGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 3; i++) {
                const slot = document.createElement('div');
                slot.className = 'flower-slot';
                
                if (gameState.producerFair.slots[i]) {
                    const item = gameState.producerFair.slots[i];
                    slot.innerHTML = `${item.emoji}<br>${item.name}`;
                    slot.onclick = () => removeFromFair(i);
                    slot.title = 'Clique para remover';
                } else {
                    slot.classList.add('empty');
                    slot.innerHTML = '📦<br>Vazio';
                    slot.onclick = () => openFairItemSelector(i);
                    slot.title = 'Clique para adicionar item';
                }
                
                grid.appendChild(slot);
            }
            
            // Update timer
            const now = Date.now();
            const timeSinceEarning = now - gameState.producerFair.lastEarning;
            const remaining = 900000 - timeSinceEarning; // 15 minutes
            
            if (remaining > 0) {
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                document.getElementById('fairTimer').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
            } else {
                document.getElementById('fairTimer').textContent = 'Pronto para pagamento!';
            }
        }

        function openFairItemSelector(slotIndex) {
            const modal = document.getElementById('foodModal');
            const content = document.getElementById('foodMenuContent');
            const title = document.getElementById('foodModalTitle');
            
            title.textContent = '🏪 Escolha um produto para expor';
            content.innerHTML = '';
            
            let hasItems = false;
            
            // Check all inventory categories
            Object.keys(gameState.inventory).forEach(category => {
                Object.keys(gameState.inventory[category]).forEach(item => {
                    const quantity = gameState.inventory[category][item];
                    if (quantity > 0) {
                        hasItems = true;
                        const seed = seeds.find(s => s.name === item);
                        let emoji = seed ? seed.emoji : '';
                        
                        // Set emoji for special items
                        const specialEmojis = {
                            'CD': '💿', 'Bola': '⚽', 'Sapato': '👟', 'Pote de Mel': '🍯',
                            'Pérola': '💎', 'Esmeralda': '💚', 'Rubi': '❤️', 'Safira': '💙',
                            'Flor': '🌸', 'Rosa': '🌹', 'Girassol': '🌻', 'Margarida': '🌼',
                            'Grama': '🌱', 'Maçã': '🍎', 'Laranja': '🍊', 'Banana': '🍌',
                            'Peixe': '🐟', 'Lenha': '🪵', 'Ovos': '🥚', 'Carne Suína': '🥩',
                            'Leite': '🥛', 'Esterco': '💩', 'Lã': '🐑', 'Saco de Café': '☕',
                            'Suco de Uva': '🧃', 'Saco de Farinha': '🌾', 'Queijo': '🧀',
                            'Novelo': '🧶', 'Pão': '🍞'
                        };
                        
                        if (specialEmojis[item]) {
                            emoji = specialEmojis[item];
                        }
                        
                        const foodItem = document.createElement('div');
                        foodItem.className = 'food-item';
                        foodItem.innerHTML = `${emoji}<br>${item}<br><small>Disponível: ${quantity}</small>`;
                        foodItem.onclick = () => addToFair(slotIndex, category, item, emoji);
                        content.appendChild(foodItem);
                    }
                });
            });
            
            if (!hasItems) {
                content.innerHTML = '<p>Você não tem produtos para expor!</p>';
            }
            
            modal.style.display = 'flex';
        }

        function addToFair(slotIndex, category, itemName, emoji) {
            if (gameState.inventory[category][itemName] > 0) {
                gameState.inventory[category][itemName]--;
                gameState.producerFair.slots[slotIndex] = {
                    name: itemName,
                    emoji: emoji,
                    category: category
                };
                
                updateInventoryDisplay();
                updateProducerFairDisplay();
                closeFoodMenu();
                alert(`🏪 ${itemName} foi exposto na feira!`);
            }
        }

        function removeFromFair(slotIndex) {
            const item = gameState.producerFair.slots[slotIndex];
            if (item) {
                // Return item to inventory
                if (!gameState.inventory[item.category][item.name]) {
                    gameState.inventory[item.category][item.name] = 0;
                }
                gameState.inventory[item.category][item.name]++;
                
                gameState.producerFair.slots[slotIndex] = null;
                
                updateInventoryDisplay();
                updateProducerFairDisplay();
                alert(`📦 ${item.name} foi removido da feira!`);
            }
        }

        function checkProducerFairEarnings() {
            if (!gameState.hasProducerFair) return;
            
            const now = Date.now();
            if (now - gameState.producerFair.lastEarning >= 900000) { // 15 minutes
                let earnings = 0;
                let itemCount = 0;
                
                gameState.producerFair.slots.forEach(slot => {
                    if (slot) {
                        earnings += 50;
                        itemCount++;
                    }
                });
                
                if (earnings > 0) {
                    gameState.coins += earnings;
                    gameState.producerFair.lastEarning = now;
                    updateUI();
                    
                    const alertDiv = document.createElement('div');
                    alertDiv.style.cssText = `
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        background: #4CAF50;
                        color: white;
                        padding: 20px 30px;
                        border-radius: 15px;
                        z-index: 3000;
                        font-weight: bold;
                        font-size: 18px;
                        text-align: center;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                    `;
                    alertDiv.textContent = `🏪 Feira do Produtor: +${earnings} moedas por ${itemCount} produtos!`;
                    document.body.appendChild(alertDiv);
                    
                    setTimeout(() => {
                        document.body.removeChild(alertDiv);
                    }, 4000);
                }
            }
        }

        function updateCraftTableDisplay() {
            const status = document.getElementById('craftStatus');
            const craftItems = document.querySelectorAll('.craft-item');
            
            if (gameState.craftTable.working) {
                const elapsed = Date.now() - gameState.craftTable.startTime;
                let duration;
                
                switch(gameState.craftTable.recipe) {
                    case 'pearl': duration = 10000; break; // 10 seconds
                    case 'emerald': duration = 20000; break; // 20 seconds
                    case 'bouquet': duration = 15000; break; // 15 seconds
                }
                
                const remaining = Math.max(0, duration - elapsed);
                const seconds = Math.ceil(remaining / 1000);
                
                status.textContent = `Trabalhando... ${seconds}s`;
                status.style.color = '#ff6b00';
                
                craftItems.forEach(item => {
                    item.classList.add('working');
                });
            } else {
                status.textContent = 'Pronta para usar';
                status.style.color = '#8B4513';
                
                craftItems.forEach(item => {
                    item.classList.remove('working');
                });
            }
        }

        function updateBonfireDisplay() {
            const flame = document.getElementById('bonfireFlame');
            const status = document.getElementById('bonfireStatus');
            const timer = document.getElementById('bonfireTimer');
            const button = document.getElementById('lightBonfireBtn');
            
            if (gameState.bonfire.lit) {
                const elapsed = Date.now() - gameState.bonfire.startTime;
                const remaining = Math.max(0, gameState.bonfire.duration - elapsed);
                
                if (remaining > 0) {
                    flame.innerHTML = '🔥';
                    flame.style.animation = 'pulse 1s ease-in-out infinite alternate';
                    status.textContent = 'Fogueira acesa - Animais aquecidos';
                    status.style.color = '#ff6b00';
                    
                    const minutes = Math.floor(remaining / 60000);
                    const seconds = Math.floor((remaining % 60000) / 1000);
                    timer.textContent = `Tempo restante: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                    
                    button.disabled = true;
                    button.textContent = '🔥 Fogueira Acesa';
                } else {
                    gameState.bonfire.lit = false;
                    updateBonfireDisplay();
                }
            } else {
                flame.innerHTML = '🌫️';
                flame.style.animation = 'none';
                status.textContent = 'Fogueira apagada - Animais com frio';
                status.style.color = '#666';
                timer.textContent = '';
                
                button.disabled = false;
                button.textContent = '🔥 Acender Fogueira';
            }
        }

        function createGreenhouseGrid() {
            const grid = document.getElementById('greenhouseGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 12; i++) {
                const plot = document.createElement('div');
                plot.className = 'plot';
                plot.id = `greenhouse-plot-${i}`;
                plot.onclick = () => handleGreenhousePlotClick(i);
                grid.appendChild(plot);
            }
            updateGreenhouseDisplay();
        }

        function updateGreenhouseDisplay() {
            if (!gameState.hasGreenhouse) return;
            
            gameState.greenhousePlots.forEach((plot, index) => {
                updateGreenhousePlotDisplay(index);
            });
        }

        function updateGreenhousePlotDisplay(plotIndex) {
            const plotElement = document.getElementById(`greenhouse-plot-${plotIndex}`);
            if (!plotElement) return;
            
            const plot = gameState.greenhousePlots[plotIndex];
            
            plotElement.className = `plot ${plot.state}`;
            
            switch (plot.state) {
                case 'empty':
                    plotElement.innerHTML = '';
                    break;
                case 'fertilized':
                    plotElement.innerHTML = '🍂';
                    break;
                case 'planted':
                    plotElement.innerHTML = '🌱';
                    break;
                case 'watered':
                    plotElement.innerHTML = '💧';
                    break;
                case 'ready':
                    plotElement.innerHTML = seeds[plot.seedType].emoji;
                    break;
            }
        }

        function handleGreenhousePlotClick(plotIndex) {
            const plot = gameState.greenhousePlots[plotIndex];
            
            if (plot.state === 'empty') {
                // Fertilize
                if (gameState.fertilizer > 0) {
                    gameState.fertilizer--;
                    plot.state = 'fertilized';
                    updateGreenhousePlotDisplay(plotIndex);
                    updateUI();
                    useEnergy(1);
                }
            } else if (plot.state === 'fertilized') {
                // Plant
                if (gameState.selectedSeed !== null && gameState.coins >= seeds[gameState.selectedSeed].price) {
                    gameState.coins -= seeds[gameState.selectedSeed].price;
                    plot.state = 'planted';
                    plot.seedType = gameState.selectedSeed;
                    plot.plantTime = Date.now();
                    updateGreenhousePlotDisplay(plotIndex);
                    updateUI();
                    useEnergy(1);
                }
            } else if (plot.state === 'planted') {
                // Water
                if (gameState.water > 0) {
                    gameState.water--;
                    plot.state = 'watered';
                    updateGreenhousePlotDisplay(plotIndex);
                    updateUI();
                    useEnergy(1);
                }
            } else if (plot.state === 'ready') {
                // Harvest
                const seed = seeds[plot.seedType];
                let harvestAmount = 1; // No season bonus in greenhouse
                
                // Store items in their designated locations
                if (seed.name === 'Café') {
                    gameState.machineStorage.coffeeRoaster.coffee += harvestAmount;
                } else if (seed.name === 'Uva') {
                    gameState.machineStorage.juiceMachine.grapes += harvestAmount;
                } else if (seed.name === 'Trigo') {
                    gameState.machineStorage.mill.wheat += harvestAmount;
                } else {
                    // Store in quitanda for sale
                    const category = seed.category;
                    if (!gameState.inventory[category][seed.name]) {
                        gameState.inventory[category][seed.name] = 0;
                    }
                    gameState.inventory[category][seed.name] += harvestAmount;
                }
                
                // Reset plot
                plot.state = 'empty';
                plot.seedType = null;
                plot.plantTime = null;
                updateGreenhousePlotDisplay(plotIndex);
                updateInventoryDisplay();
                useEnergy(1);
            }
        }

        function craftPearlNecklace() {
            if (gameState.craftTable.working) {
                alert('A mesa está ocupada!');
                return;
            }
            
            if (gameState.inventory.others['Pérola'] >= 6) {
                gameState.inventory.others['Pérola'] -= 6;
                gameState.craftTable.working = true;
                gameState.craftTable.startTime = Date.now();
                gameState.craftTable.recipe = 'pearl';
                
                updateInventoryDisplay();
                updateCraftTableDisplay();
                
                setTimeout(() => {
                    gameState.craftTable.working = false;
                    addToInventory('others', 'Colar de Pérolas', 1);
                    updateInventoryDisplay();
                    updateCraftTableDisplay();
                    alert('📿 Colar de Pérolas criado!');
                }, 10000); // 10 seconds
            } else {
                alert('Você precisa de 6 Pérolas!');
            }
        }

        function craftEmeraldRing() {
            if (gameState.craftTable.working) {
                alert('A mesa está ocupada!');
                return;
            }
            
            if (gameState.inventory.others['Esmeralda'] >= 1) {
                gameState.inventory.others['Esmeralda']--;
                gameState.craftTable.working = true;
                gameState.craftTable.startTime = Date.now();
                gameState.craftTable.recipe = 'emerald';
                
                updateInventoryDisplay();
                updateCraftTableDisplay();
                
                setTimeout(() => {
                    gameState.craftTable.working = false;
                    addToInventory('others', 'Anel de Esmeralda', 1);
                    updateInventoryDisplay();
                    updateCraftTableDisplay();
                    alert('💍 Anel de Esmeralda criado!');
                }, 20000); // 20 seconds
            } else {
                alert('Você precisa de 1 Esmeralda!');
            }
        }

        function craftFlowerBouquet() {
            if (gameState.craftTable.working) {
                alert('A mesa está ocupada!');
                return;
            }
            
            if (gameState.inventory.others['Rosa'] >= 1 && 
                gameState.inventory.others['Girassol'] >= 1 && 
                gameState.inventory.others['Margarida'] >= 1) {
                
                gameState.inventory.others['Rosa']--;
                gameState.inventory.others['Girassol']--;
                gameState.inventory.others['Margarida']--;
                gameState.craftTable.working = true;
                gameState.craftTable.startTime = Date.now();
                gameState.craftTable.recipe = 'bouquet';
                
                updateInventoryDisplay();
                updateCraftTableDisplay();
                
                setTimeout(() => {
                    gameState.craftTable.working = false;
                    addToInventory('others', 'Buquê de Flores', 1);
                    updateInventoryDisplay();
                    updateCraftTableDisplay();
                    alert('💐 Buquê de Flores criado!');
                }, 15000); // 15 seconds
            } else {
                alert('Você precisa de: 1 Rosa, 1 Girassol e 1 Margarida!');
            }
        }

        function harvestFlower(type) {
            if (gameState.flowers[type] > 0) {
                gameState.flowers[type]--;
                
                // Store flowers in composter
                gameState.machineStorage.composter.flowers++;
                
                // Check if should drop herb (every 3 flowers)
                const totalHarvested = Object.values(gameState.flowers).reduce((sum, count) => sum + (3 - count), 0);
                if (totalHarvested % 3 === 0) {
                    gameState.machineStorage.stove.herbs++;
                    alert('🌿 Uma erva apareceu no fogão!');
                }
                
                updateFlowersDisplay();
                updateMachineStorageDisplay();
                useEnergy(1);
                
                // Regrow after 3 minutes
                setTimeout(() => {
                    gameState.flowers[type] = Math.min(3, gameState.flowers[type] + 1);
                    updateFlowersDisplay();
                }, 180000);
            }
        }

        function updatePetUI() {
            // Update dog UI
            if (gameState.hasDogHouse) {
                document.getElementById('dogFriendship').textContent = gameState.dogFriendship;
                document.getElementById('dogFriendshipBar').style.width = gameState.dogFriendship + '%';
                
                const dogLastFedTime = gameState.dogLastFed > 0 ? 
                    new Date(gameState.dogLastFed).toLocaleTimeString() : 'Nunca';
                document.getElementById('dogLastFed').textContent = dogLastFedTime;
                
                const now = Date.now();
                const canFeed = (now - gameState.dogLastFed) >= 300000;
                const canGiveBone = (now - gameState.dogLastFed) >= 1200000;
                
                document.getElementById('feedDogBtn').disabled = !canFeed || gameState.barn.dogFood === 0;
                document.getElementById('giveBoneBtn').disabled = !canGiveBone || gameState.barn.bones === 0;
            }
            
            // Update horse UI
            if (gameState.hasHorseStable) {
                document.getElementById('horseFriendship').textContent = gameState.horseFriendship;
                document.getElementById('horseFriendshipBar').style.width = gameState.horseFriendship + '%';
                
                const horseLastFedTime = gameState.horseLastFed > 0 ? 
                    new Date(gameState.horseLastFed).toLocaleTimeString() : 'Nunca';
                document.getElementById('horseLastFed').textContent = horseLastFedTime;
                
                const now = Date.now();
                const canFeedHorse = (now - gameState.horseLastFed) >= 300000;
                
                document.getElementById('feedHorseBtn').disabled = !canFeedHorse || gameState.barn.hay < 2;
                document.getElementById('giveAppleBtn').disabled = !gameState.inventory.fruitsVegetables['Maçã'] || gameState.inventory.fruitsVegetables['Maçã'] === 0;
            }
        }

        function updateMachineStorageDisplay() {
            // Update Composter storage
            if (document.getElementById('flowerStorage')) {
                document.getElementById('flowerStorage').textContent = gameState.machineStorage.composter.flowers;
            }
            if (document.getElementById('branchStorage')) {
                document.getElementById('branchStorage').textContent = gameState.machineStorage.composter.branches;
            }
            if (document.getElementById('manureStorage')) {
                document.getElementById('manureStorage').textContent = gameState.machineStorage.composter.manure;
            }
            
            // Update Coffee Roaster storage
            if (document.getElementById('coffeeStorage')) {
                document.getElementById('coffeeStorage').textContent = gameState.machineStorage.coffeeRoaster.coffee;
            }
            
            // Update Juice Machine storage
            if (document.getElementById('grapeStorage')) {
                document.getElementById('grapeStorage').textContent = gameState.machineStorage.juiceMachine.grapes;
            }
            
            // Update Mill storage
            if (document.getElementById('wheatStorage')) {
                document.getElementById('wheatStorage').textContent = gameState.machineStorage.mill.wheat;
            }
            
            // Update Spinning Machine storage
            if (document.getElementById('woolStorage')) {
                document.getElementById('woolStorage').textContent = gameState.machineStorage.spinningMachine.wool;
            }
            
            // Update Grass Dryer storage
            if (document.getElementById('grassStorage')) {
                document.getElementById('grassStorage').textContent = gameState.machineStorage.grassDryer.grass;
            }
            if (document.getElementById('driedGrassStorage')) {
                document.getElementById('driedGrassStorage').textContent = gameState.machineStorage.grassDryer.driedGrass;
            }
            
            // Update Wood Cutter storage
            if (document.getElementById('trunkStorage')) {
                document.getElementById('trunkStorage').textContent = gameState.machineStorage.woodCutter.trunks;
            }
        }

        function updateUI() {
            document.getElementById('coins').textContent = gameState.coins;
            document.getElementById('water').textContent = gameState.water;
            document.getElementById('fertilizer').textContent = gameState.fertilizer;
            
            // Update all plots
            gameState.plots.forEach((plot, index) => {
                updatePlotDisplay(index);
            });
            
            // Update machine storage displays
            updateMachineStorageDisplay();
        }

        function saveGame() {
            localStorage.setItem('realFarmSave', JSON.stringify(gameState));
            console.log('Jogo salvo automaticamente!');
        }

        function handleAnimalClick(type, index) {
            const animals = gameState[type + 's'];
            const animal = animals[index];
            
            if (!animal) return;
            
            if (animal.sick && gameState.barn.vaccines > 0) {
                gameState.barn.vaccines--;
                animal.sick = false;
                animal.sickTime = 0;
                updateBarnDisplay();
                alert(`💉 ${animal.emoji} foi curado!`);
            }
        }

        function feedAllChickens() {
            if (gameState.barn.animalFeed === 0) {
                alert('Você precisa de ração animal!');
                return;
            }
            
            gameState.chickens.forEach(chicken => {
                if (!chicken.sick && !chicken.resting && !chicken.eating) {
                    feedAnimal(chicken, 'chicken');
                }
            });
        }

        function feedAllPigs() {
            if (gameState.barn.animalFeed === 0) {
                alert('Você precisa de ração animal!');
                return;
            }
            
            gameState.pigs.forEach(pig => {
                if (!pig.sick && !pig.resting && !pig.eating) {
                    feedAnimal(pig, 'pig');
                }
            });
        }

        function feedAllSheep() {
            if (gameState.barn.hay === 0) {
                alert('Você precisa de feno!');
                return;
            }
            
            gameState.sheep.forEach(sheep => {
                if (!sheep.sick && !sheep.resting && !sheep.eating) {
                    feedAnimal(sheep, 'sheep');
                }
            });
        }

        function feedAllCows() {
            if (gameState.barn.hay === 0) {
                alert('Você precisa de feno!');
                return;
            }
            
            gameState.cows.forEach(cow => {
                if (!cow.sick && !cow.resting && !cow.eating) {
                    feedAnimal(cow, 'cow');
                }
            });
        }

        function shearAllSheep() {
            if (!gameState.hasShears) {
                alert('Você precisa de uma tesoura de tosquiar!');
                return;
            }
            
            gameState.sheep.forEach(sheep => {
                if (sheep.wool > 0) {
                    if (!gameState.inventory.others['Lã']) {
                        gameState.inventory.others['Lã'] = 0;
                    }
                    gameState.inventory.others['Lã'] += sheep.wool;
                    sheep.wool = 0;
                }
            });
            
            updateInventoryDisplay();
        }

        function feedAnimal(animal, type) {
            const now = Date.now();
            
            if (animal.resting || animal.eating || animal.sick) return;
            
            if (type === 'chicken' || type === 'pig') {
                if (gameState.barn.animalFeed > 0) {
                    gameState.barn.animalFeed--;
                    startEating(animal, type);
                }
            } else if (type === 'sheep' || type === 'cow') {
                if (gameState.barn.hay > 0) {
                    gameState.barn.hay--;
                    startEating(animal, type);
                }
            }
            
            updateBarnDisplay();
        }

        function startEating(animal, type) {
            animal.eating = true;
            animal.lastFed = Date.now();
            
            // Show eating animation for 10 seconds
            setTimeout(() => {
                animal.eating = false;
                animal.resting = true;
                
                // Check if bonfire is lit in winter for production
                const canProduce = gameState.season !== 3 || gameState.bonfire.lit;
                
                if (canProduce) {
                    // Produce items after eating
                    if (type === 'chicken') {
                        animal.eggs = 3;
                        addToInventory('others', 'Ovos', 3);
                    } else if (type === 'pig') {
                        animal.meat = 1;
                        gameState.machineStorage.stove.porkMeat++;
                    } else if (type === 'sheep') {
                        animal.wool = 2;
                        gameState.machineStorage.spinningMachine.wool += 2;
                    } else if (type === 'cow') {
                        animal.milk = 3;
                        animal.manure = 1;
                        addToInventory('others', 'Leite', 3);
                        gameState.machineStorage.composter.manure++;
                    }
                } else {
                    // Show message that animals are too cold to produce
                    const alertDiv = document.createElement('div');
                    alertDiv.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #4169e1;
                        color: white;
                        padding: 15px 20px;
                        border-radius: 10px;
                        z-index: 3000;
                        font-weight: bold;
                        max-width: 300px;
                    `;
                    alertDiv.textContent = '❄️ Os animais estão com muito frio para produzir! Acenda a fogueira!';
                    document.body.appendChild(alertDiv);
                    
                    setTimeout(() => {
                        document.body.removeChild(alertDiv);
                    }, 4000);
                }
                
                // Rest for 3 minutes
                setTimeout(() => {
                    animal.resting = false;
                }, 180000);
                
                updateInventoryDisplay();
            }, 10000);
        }

        function addToInventory(category, item, quantity) {
            if (!gameState.inventory[category][item]) {
                gameState.inventory[category][item] = 0;
            }
            gameState.inventory[category][item] += quantity;
        }

        // Animal sickness system
        function checkAnimalHealth() {
            const allAnimals = [
                ...gameState.chickens,
                ...gameState.pigs,
                ...gameState.sheep,
                ...gameState.cows
            ];
            
            allAnimals.forEach(animal => {
                if (animal.sick) {
                    // Check if animal dies after 20 minutes
                    if (Date.now() - animal.sickTime > 1200000) {
                        removeAnimal(animal);
                        alert(`💀 ${animal.emoji} morreu por falta de tratamento!`);
                    }
                } else {
                    // Random chance to get sick
                    if (Math.random() < 0.001) { // 0.1% chance per check
                        animal.sick = true;
                        animal.sickTime = Date.now();
                    }
                }
            });
        }

        function removeAnimal(deadAnimal) {
            ['chickens', 'pigs', 'sheep', 'cows'].forEach(type => {
                gameState[type] = gameState[type].filter(animal => animal.id !== deadAnimal.id);
            });
            
            updateChickensDisplay();
            updatePigsDisplay();
            updateSheepDisplay();
            updateCowsDisplay();
        }

        // Chicken breeding system
        function checkChickenBreeding() {
            if (gameState.chickens.length >= 2 && gameState.chickens.length <= 3) {
                if (Math.random() < 0.5 && gameState.chickens.length < 4) { // 50% chance
                    // Add baby chicken that grows in 30 minutes
                    const baby = {
                        id: Date.now(),
                        type: 'chicken',
                        emoji: '🐣',
                        state: 'baby',
                        lastFed: 0,
                        eggs: 0,
                        sick: false,
                        sickTime: 0,
                        eating: false,
                        resting: false
                    };
                    
                    gameState.chickens.push(baby);
                    
                    setTimeout(() => {
                        baby.emoji = '🐔';
                        baby.state = 'adult';
                        updateChickensDisplay();
                    }, 1800000); // 30 minutes
                    
                    updateChickensDisplay();
                }
            }
        }

        function harvestGrass(index) {
            if (gameState.grass[index]) {
                gameState.grass[index] = false;
                gameState.grassHarvested++;
                
                // Store grass in grass dryer
                gameState.machineStorage.grassDryer.grass++;
                
                // Drop flower every 8 grasses for composter
                if (gameState.grassHarvested % 8 === 0) {
                    gameState.machineStorage.composter.flowers++;
                    alert('🌸 Uma flor apareceu na composteira!');
                }
                
                updateGrassDisplay();
                useEnergy(1);
            }
        }

        function harvestTrunk() {
            if (gameState.hasAxe && gameState.axeUses > 0) {
                gameState.axeUses--;
                gameState.trees.trunk.clicks++;
                gameState.machineStorage.woodCutter.trunks++;
                
                // Drop branches every 3 clicks for composter
                if (gameState.trees.trunk.clicks % 3 === 0) {
                    gameState.machineStorage.composter.branches += 2;
                    alert('🌿 2 galhos apareceram na composteira!');
                }
                
                updateAxeStatus();
                updateTreesDisplay();
                useEnergy(1);
            } else if (!gameState.hasAxe) {
                alert('Você precisa de um machado para cortar troncos!');
            }
        }

        function harvestFruit(type) {
            if (gameState.trees[type].fruits > 0) {
                gameState.trees[type].fruits--;
                
                const fruitNames = {
                    apple: 'Maçã',
                    orange: 'Laranja', 
                    banana: 'Banana'
                };
                
                addToInventory('fruitsVegetables', fruitNames[type], 1);
                updateTreesDisplay();
                updateInventoryDisplay();
                useEnergy(1);
            }
        }

        function cutWood() {
            if (gameState.hasAxe && gameState.axeUses > 0 && gameState.barn.trunks > 0) {
                gameState.axeUses--;
                gameState.barn.trunks--;
                
                addToInventory('others', 'Lenha', 2);
                
                updateAxeStatus();
                updateBarnDisplay();
                updateInventoryDisplay();
                alert('🪓 Você cortou 1 tronco e ganhou 2 lenhas!');
            } else if (!gameState.hasAxe) {
                alert('Você precisa de um machado!');
            } else if (gameState.barn.trunks === 0) {
                alert('Você precisa de troncos para cortar!');
            }
        }

        function catchFish(index) {
            if (gameState.hasFishingRod && gameState.fishingRodUses > 0 && gameState.fish[index]) {
                gameState.fishingRodUses--;
                gameState.fish[index] = false;
                gameState.fishCaught++;
                
                addToInventory('others', 'Peixe', 1);
                
                // Drop pearl every 5 fish
                if (gameState.fishCaught % 5 === 0) {
                    addToInventory('others', 'Pérola', 1);
                    alert('💎 Uma pérola apareceu!');
                }
                
                updateFishingRodStatus();
                updateFishDisplay();
                updateInventoryDisplay();
                useEnergy(1);
            } else if (!gameState.hasFishingRod) {
                alert('Você precisa de uma vara de pesca!');
            }
        }

        function mineRock(index) {
            if (!gameState.mineAccess || gameState.barn.keys === 0) {
                alert('Você precisa de uma chave para entrar na mina!');
                return;
            }
            
            if (!gameState.hasPickaxe || gameState.pickaxeUses === 0) {
                alert('Você precisa de uma picareta para minerar!');
                return;
            }
            
            const rock = gameState.rocks[index];
            if (rock.resting) {
                alert('Esta rocha está descansando!');
                return;
            }
            
            gameState.pickaxeUses--;
            rock.hits++;
            
            // Random gem drop
            const gems = ['Esmeralda', 'Rubi', 'Safira', 'Carvão'];
            const randomGem = gems[Math.floor(Math.random() * gems.length)];
            
            if (randomGem === 'Carvão') {
                gameState.barn.coal++;
                updateBarnDisplay();
            } else {
                addToInventory('others', randomGem, 1);
                updateInventoryDisplay();
            }
            
            // Check if rock needs rest
            if (rock.hits >= 3) {
                rock.resting = true;
                rock.restTime = Date.now();
                rock.hits = 0;
            }
            
            // Use key after 9 total hits across all rocks
            const totalHits = gameState.rocks.reduce((sum, r) => sum + r.hits, 0);
            if (totalHits === 0 && gameState.rocks.every(r => r.resting)) {
                gameState.barn.keys--;
                updateBarnDisplay();
            }
            
            updatePickaxeStatus();
            updateRocksDisplay();
        }

        function checkGrassRegrowth() {
            for (let i = 0; i < gameState.grass.length; i++) {
                if (!gameState.grass[i]) {
                    gameState.grass[i] = true;
                }
            }
            if (gameState.hasGrassField) updateGrassDisplay();
        }

        function checkTreeRegrowth() {
            ['apple', 'orange', 'banana'].forEach(type => {
                if (gameState.trees[type].fruits < 4) {
                    gameState.trees[type].fruits = 4;
                }
            });
            if (gameState.hasForest) updateTreesDisplay();
        }

        function checkFishRespawn() {
            for (let i = 0; i < gameState.fish.length; i++) {
                if (!gameState.fish[i]) {
                    gameState.fish[i] = true;
                }
            }
            updateFishDisplay();
        }

        function checkRockRest() {
            gameState.rocks.forEach(rock => {
                if (rock.resting && Date.now() - rock.restTime >= 180000) { // 3 minutes
                    rock.resting = false;
                    rock.restTime = 0;
                }
            });
            updateRocksDisplay();
        }

        function loadGame() {
            const saved = localStorage.getItem('realFarmSave');
            if (saved) {
                gameState = {...gameState, ...JSON.parse(saved)};
                
                // Update UI elements based on loaded state
                if (gameState.hasWell) {
                    document.getElementById('wellContainer').style.display = 'block';
                    document.getElementById('wellShop').style.display = 'none';
                }
                
                if (gameState.hasDogHouse) {
                    document.getElementById('dogHouse').style.display = 'block';
                    document.getElementById('dogHouseShop').style.display = 'none';
                }
                
                if (gameState.hasHorseStable) {
                    document.getElementById('horseStable').style.display = 'block';
                    document.getElementById('horseStableShop').style.display = 'none';
                }
                
                if (gameState.hasChickenCoop) {
                    document.getElementById('chickenCoop').style.display = 'block';
                    document.getElementById('chickenShop').style.display = 'block';
                    document.getElementById('chickenCoopShop').style.display = 'none';
                }
                
                if (gameState.hasPigPen) {
                    document.getElementById('pigPen').style.display = 'block';
                    document.getElementById('pigShop').style.display = 'block';
                    document.getElementById('pigPenShop').style.display = 'none';
                }
                
                if (gameState.hasSheepPen) {
                    document.getElementById('sheepPen').style.display = 'block';
                    document.getElementById('sheepShop').style.display = 'block';
                    if (!gameState.hasShears) {
                        document.getElementById('shearsShop').style.display = 'block';
                    } else {
                        document.getElementById('shearsShop').style.display = 'none';
                    }
                    document.getElementById('sheepPenShop').style.display = 'none';
                }
                
                if (gameState.hasCowPasture) {
                    document.getElementById('cowPasture').style.display = 'block';
                    document.getElementById('cowShop').style.display = 'block';
                    document.getElementById('cowPastureShop').style.display = 'none';
                }
                
                if (gameState.hasGrassField) {
                    document.getElementById('grassField').style.display = 'block';
                    document.getElementById('grassFieldShop').style.display = 'none';
                }
                
                if (gameState.hasForest) {
                    document.getElementById('forest').style.display = 'block';
                    document.getElementById('forestShop').style.display = 'none';
                }
                
                if (gameState.hasBeehive) {
                    document.getElementById('beehive').style.display = 'block';
                    document.getElementById('beehiveShop').style.display = 'none';
                }
                

                
                if (gameState.hasAxe) {
                    document.getElementById('axeStatus').style.display = 'block';
                    document.getElementById('axeShop').style.display = 'none';
                }
                
                if (gameState.hasFishingRod) {
                    document.getElementById('fishingRodStatus').style.display = 'block';
                }
                
                if (gameState.hasPickaxe) {
                    document.getElementById('pickaxeStatus').style.display = 'block';
                }
                
                if (gameState.hasBeehive) {
                    document.getElementById('beehive').style.display = 'block';
                }
                
                if (gameState.hasFlowerField) {
                    document.getElementById('flowerField').style.display = 'block';
                }
                
                if (gameState.hasProducerFair) {
                    document.getElementById('producerFair').style.display = 'block';
                }
                
                if (gameState.horseFriendship >= 100) {
                    document.getElementById('ordersPanel').style.display = 'block';
                    generateOrders();
                }
                
                updateUI();
                updateInventoryDisplay();
                updateBarnDisplay();
                updatePetUI();
                updateOrdersDisplay();
                updateChickensDisplay();
                updatePigsDisplay();
                updateSheepDisplay();
                updateCowsDisplay();
                updateFlowersDisplay();
                updateGrassDisplay();
                updateTreesDisplay();
                updateFishDisplay();
                updateRocksDisplay();
                
                if (gameState.hasProducerFair) {
                    updateProducerFairDisplay();
                }
                
                if (gameState.hasCraftTable) {
                    document.getElementById('craftTable').style.display = 'block';
                    updateCraftTableDisplay();
                }
                
                if (gameState.hasBonfire) {
                    document.getElementById('bonfire').style.display = 'block';
                    updateBonfireDisplay();
                }
                
                if (gameState.hasGreenhouse) {
                    document.getElementById('greenhouse').style.display = 'block';
                    document.getElementById('greenhouseShop').style.display = 'none';
                    createGreenhouseGrid();
                }
                updateAxeStatus();
                updateFishingRodStatus();
                updatePickaxeStatus();
                
                if (gameState.hasBeehive) {
                    updateBeehiveDisplay();
                }
                
                // Load machines
                if (gameState.machines) {
                    if (gameState.machines.hasComposter) {
                        document.getElementById('composter').style.display = 'block';
                        document.getElementById('composterShop').style.display = 'none';
                    }
                    if (gameState.machines.hasMixer) {
                        document.getElementById('mixer').style.display = 'block';
                        document.getElementById('mixerShop').style.display = 'none';
                    }
                    if (gameState.machines.hasCoffeeRoaster) {
                        document.getElementById('coffeeRoaster').style.display = 'block';
                        document.getElementById('coffeeRoasterShop').style.display = 'none';
                    }
                    if (gameState.machines.hasJuiceMachine) {
                        document.getElementById('juiceMachine').style.display = 'block';
                        document.getElementById('juiceMachineShop').style.display = 'none';
                    }
                    if (gameState.machines.hasMill) {
                        document.getElementById('mill').style.display = 'block';
                        document.getElementById('millShop').style.display = 'none';
                    }
                    if (gameState.machines.hasCheeseMaker) {
                        document.getElementById('cheeseMaker').style.display = 'block';
                        document.getElementById('cheeseMakerShop').style.display = 'none';
                    }
                    if (gameState.machines.hasSpinningMachine) {
                        document.getElementById('spinningMachine').style.display = 'block';
                        document.getElementById('spinningMachineShop').style.display = 'none';
                    }
                    if (gameState.machines.hasGrassDryer) {
                        document.getElementById('grassDryer').style.display = 'block';
                        document.getElementById('grassDryerShop').style.display = 'none';
                    }
                    if (gameState.machines.hasWoodCutter) {
                        document.getElementById('woodCutter').style.display = 'block';
                        document.getElementById('woodCutterShop').style.display = 'none';
                    }
                    if (gameState.machines.hasStove) {
                        document.getElementById('stove').style.display = 'block';
                        document.getElementById('stoveShop').style.display = 'none';
                    }
                }
                
                updateAvatarUI();
                
                if (gameState.mailbox.hasNewMail) {
                    document.getElementById('mailAlert').style.display = 'flex';
                }
            }
        }

        // Initialize game when page loads
        window.onload = initGame;
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b53cf611d90093',t:'MTc1NDU1MzYwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
